cscope 15 /mnt/d/ubuntu/LA3HPC               0000213721
	@dev/proc2tile.cpp

1 
	~<io¡»am
>

2 
	~<mpi.h
>

3 
	~<¡ršg.h
>

5 
usšg
 
Çme¥aû
 
	g¡d
;

8 
	$g‘CouÁ
(cÚ¡ *
desütiÚ
, 
¥l™_ty³
) {

9 
¿nk
, 
is_¿nk0
, 
nodes
;

10 
MPI_Comm
 
shmcomm
;

12 
	`MPI_Comm_¥l™_ty³
(
MPI_COMM_WORLD
, 
¥l™_ty³
, 0, 
MPI_INFO_NULL
, &
shmcomm
);

14 
	`MPI_Comm_¿nk
(
shmcomm
, &
¿nk
);

15 
cout
 << "Rªk=" << 
¿nk
 << "," << 
desütiÚ
 << 
’dl
;

16 if(!
	`¡rcmp
(
desütiÚ
, "OMPI_COMM_TYPE_CORE")) {

17 
is_¿nk0
 = 1;

19 
is_¿nk0
 = (
¿nk
 == 0) ? 1 : 0;

22 
	`MPI_AÎ»duû
(&
is_¿nk0
, &
nodes
, 1, 
MPI_INT
, 
MPI_SUM
, 
MPI_COMM_WORLD
);

23 
	`MPI_Comm_ä“
(&
shmcomm
);

24 if(
¿nk
 == 0) {

25 
cout
 << 
desütiÚ
 << ": " << 
nodes
 << 
’dl
;

27  
nodes
;

28 
	}
}

32 
	$maš
(
¬gc
, **
¬gv
) {

34 
	`MPI_In™
(
NULL
, NULL);

36 
wÜld_size
;

37 
	`MPI_Comm_size
(
MPI_COMM_WORLD
, &
wÜld_size
);

39 
wÜld_¿nk
;

40 
	`MPI_Comm_¿nk
(
MPI_COMM_WORLD
, &
wÜld_¿nk
);

42 
´oûssÜ_Çme
[
wÜld_size
];

43 
Çme_Ën
;

44 
	`MPI_G‘_´oûssÜ_Çme
(
´oûssÜ_Çme
, &
Çme_Ën
);

45 
	`MPI_B¬r›r
(
MPI_COMM_WORLD
);

50 
node_couÁ
 = 
	`g‘CouÁ
("OMPI_COMM_TYPE_NODE", 
OMPI_COMM_TYPE_NODE
);

53 
cÜe_couÁ
 = 
	`g‘CouÁ
("OMPI_COMM_TYPE_CORE", 
OMPI_COMM_TYPE_CORE
);

57 
sock‘_couÁ
 = 
	`g‘CouÁ
("OMPI_COMM_TYPE_SOCKET", 
OMPI_COMM_TYPE_SOCKET
);

64 
¿nk
;

65 
	`MPI_Comm_¿nk
(
MPI_COMM_WORLD
, &
¿nk
);

66 
´oc_couÁ
 = 
wÜld_size
;

67 
sock‘s_³r_node
;

68 
cÜes_³r_sock‘
;

69 if(
¿nk
 == 0) {

70 
sock‘s_³r_node
 = 
sock‘_couÁ
 / 
node_couÁ
;

71 
cÜes_³r_sock‘
 = (
cÜe_couÁ
 / 
node_couÁ
è/ 
sock‘s_³r_node
;

72 
cout
 << "node_couÁ=" << 
node_couÁ
 << ",cÜe_couÁ=" << 
cÜe_couÁ
 << ",sock‘_couÁ=" << 
sock‘_couÁ
 << 
’dl
;

73 
cout
 << "node_couÁ=" << 
node_couÁ
 << ",sock‘s_³r_node=" << 
sock‘s_³r_node
 << ",cÜes_³r_sock‘=" << 
cÜes_³r_sock‘
 << 
’dl
;

75 
grid
 = 
´oc_couÁ
 *…roc_count;

76 
tes_³r_node
 = 
grid
 / 
node_couÁ
;

77 
tes_³r_sock‘
 = 
tes_³r_node
 / 
sock‘s_³r_node
;

78 
tes_³r_cÜe
 = 
tes_³r_sock‘
 / 
cÜes_³r_sock‘
;

81 
cout
 << "´oc_couÁ=" << 
´oc_couÁ
 << 
’dl
;

82 
cout
 << "grid=" << 
grid
 << ",tes_³r_node=" << 
tes_³r_node
 << ",tes_³r_sock‘=" << 
tes_³r_sock‘
 << ",tes_³r_cÜe=" << 
tes_³r_cÜe
 << 
’dl
;

84 
i
, 
j
, 
k
, 
l
 = 0, 
te
;

85 
i
 = 0; i < 
´oc_couÁ
; i++) {

86 
cout
 << "|";

87 
j
 = 0; j < 
´oc_couÁ
; j++) {

88 
te
 = (
i
 * 
´oc_couÁ
è+ 
j
;

89 if(
te
 <= 9) {

90 
cout
 << "0" << 
te
 << "|";

92 
cout
 << 
te
 << "|";

95 
cout
 << 
’dl
;

98 
i
 = 0; i < 
node_couÁ
; i++) {

99 
cout
 << "node=" << 
i
 << 
’dl
;

100 
j
 = 0; j < 
sock‘s_³r_node
; j++) {

101 
cout
 << " sock‘=" << 
j
 << 
’dl
;

102 
k
 = 0; k < 
cÜes_³r_sock‘
; k++) {

103 
cout
 << " cÜe=" << 
k
 << 
’dl
;

111 
cout
 << 
´oc_couÁ
 / 
node_couÁ
 << 
’dl
;

139 
	`MPI_Fš®ize
();

142 
	}
}

	@src/apps/graph_analytics/bfs.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"bfs.h
"

11 
	$run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
nv”tiûs
, vid_ˆ
roÙ
)

13 
G¿ph
<
ew_t
> 
G
;

14 
G
.
	`lßd_undœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
);

16 
BfsV”‹x
 
	`vp
(&
G
);

17 
vp
.
roÙ
 =„oot;

18 
vp
.
	`š™Ÿlize
();

20 
Env
::
	`b¬r›r
();

21 
Di¡Tim”
 
	`tim”
("BFS Execution");

22 
vp
.
	`execu‹
();

23 
tim”
.
	`¡İ
();

25 
vp
.
	`di¥Ïy
();

26 
tim”
.
	`»pÜt
();

28 
Ä—chabË
 = 
vp
.
»duû
<>(

29 [&](
ušt32_t
 
vid
, cÚ¡ 
BfsS‹
& 
s
è-> {  s.
hİs
 !ğ
INF
; },

30 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

31 
LOG
.
	`šfo
("R—chabË V”tiû ğ%lu \n", 
Ä—chabË
);

34 
checksum
 = 
vp
.
»duû
<>(

35 [&](
ušt32_t
 
idx
, cÚ¡ 
BfsS‹
& 
s
è-> {  s.
hİs
 * s.
·»Á
; },

36 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

37 
LOG
.
	`šfo
("Checksum = %lu \n", 
checksum
);

38 
	}
}

41 
	$maš
(
¬gc
, * 
¬gv
[])

43 
Env
::
	`š™
();

46 ià(
¬gc
 < 4)

48 
LOG
.
	`šfo
("U§ge: % <f•©h> <num_v”tiûs: 0 iàh—d”…»£Á> <roÙ> \n", 
¬gv
[0]);

49 
Env
::
	`ex™
(1);

53 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

54 
vid_t
 
nv”tiûs
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[2]);

55 
vid_t
 
roÙ
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[3]);

57 
	`run
(
f•©h
, 
nv”tiûs
, 
roÙ
);

59 
Env
::
	`fš®ize
();

61 
	}
}

	@src/apps/graph_analytics/bfs.h

1 #iâdeà
BFS_H


2 
	#BFS_H


	)

4 
	~<ÿs£¹
>

5 
	~"v´og¿m/v”‹x_´og¿m.h
"

11 
usšg
 
	gvid_t
 = 
ušt32_t
;

12 
usšg
 
	gew_t
 = 
Em±y
;

13 
usšg
 
	gdi¡_t
 = 
ušt8_t
;

15 
cÚ¡ex´
 
di¡_t
 
	gINF
 = (di¡_tè
UINT8_MAX
;

18 
	gBfsS‹
 : 
S‹


20 
vid_t
 
·»Á
 = 0;

21 
di¡_t
 
	ghİs
 = 
INF
;

22 
	g¡d
::
¡ršg
 
to_¡ršg
() const

23 {  "{·»Á: " + 
¡d
::
to_¡ršg
(
·»Á
è+ ", hİs: " + std::to_¡ršg(
hİs
) + "}"; }

27 
şass
 
	gBfsV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, 
	gvid_t
, 
	gBfsS‹
>

29 
	gpublic
:

30 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = 
vid_t
; usšg 
	gS
 = 
BfsS‹
;

31 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

33 
ušt32_t
 
	groÙ
 = 0;

35 
boŞ
 
š™
(
ušt32_t
 
vid
, 
BfsS‹
& 
s
)

36 { ià(
	gvid
 =ğ
roÙ
è{ 
s
.
hİs
 = 0;  
	gŒue
; }  
	gçl£
; }

38 
M
 
sÿ‰”
(cÚ¡ 
BfsS‹
& 
s
) {  M(); }

39 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
	gedge
.
	g¤c
; }

40 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 = y1; }

41 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
BfsS‹
& 
s
, 
ušt32_t
 
™”
)

43 ià(
	gs
.
	ghİs
 !ğ
INF
)

44  
çl£
;

45 
	gs
.
	ghİs
 = (
di¡_t
è(
™”
 + 1);

46 
	gs
.
	g·»Á
 = 
y
;

47  
	gŒue
;

	@src/apps/graph_analytics/cc.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"cc.h
"

11 
	$run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
nv”tiûs
)

13 
G¿ph
<
ew_t
> 
G
;

14 
G
.
	`lßd_undœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
);

16 
CcV”‹x
 
	`vp
(&
G
);

17 
vp
.
	`š™Ÿlize
();

19 
Env
::
	`b¬r›r
();

20 
Di¡Tim”
 
	`tim”
("CC Execution");

21 
vp
.
	`execu‹
();

22 
tim”
.
	`¡İ
();

24 
vp
.
	`di¥Ïy
();

25 
tim”
.
	`»pÜt
();

28 
checksum
 = 
vp
.
»duû
<>(

29 [&](
ušt32_t
 
idx
, cÚ¡ 
CcS‹
& 
s
è-> {  s.
Ïb–
; },

30 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

31 
LOG
.
	`šfo
("Checksum = %lu \n", 
checksum
);

32 
	}
}

35 
	$maš
(
¬gc
, * 
¬gv
[])

37 
Env
::
	`š™
();

40 ià(
¬gc
 < 3)

42 
LOG
.
	`šfo
("U§ge: % <f•©h> <num_v”tiûs: 0 iàh—d”…»£Á> \n", 
¬gv
[0]);

43 
Env
::
	`ex™
(1);

47 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

48 
vid_t
 
nv”tiûs
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[2]);

50 
	`run
(
f•©h
, 
nv”tiûs
);

52 
Env
::
	`fš®ize
();

54 
	}
}

	@src/apps/graph_analytics/cc.h

1 #iâdeà
CC_H


2 
	#CC_H


	)

4 
	~<ÿs£¹
>

5 
	~"v´og¿m/v”‹x_´og¿m.h
"

11 
usšg
 
	gvid_t
 = 
ušt32_t
;

12 
usšg
 
	gew_t
 = 
Em±y
;

15 
	gCcS‹
 : 
S‹


17 
vid_t
 
Ïb–
 = 0;

18 
	g¡d
::
¡ršg
 
to_¡ršg
(ècÚ¡ {  "{Ïb–: " + 
¡d
::to_¡ršg(
Ïb–
) + "}"; }

22 
şass
 
	gCcV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gvid_t
, vid_t, 
	gCcS‹
>

24 
	gpublic
:

25 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
vid_t
; usšg 
	gA
 = vid_t; usšg 
	gS
 = 
CcS‹
;

26 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

28 
boŞ
 
š™
(
ušt32_t
 
vid
, 
CcS‹
& 
s
è{ 
	gs
.
	gÏb–
 = vid;  
	gŒue
; }

29 
M
 
sÿ‰”
(cÚ¡ 
CcS‹
& 
s
è{  
	gs
.
	gÏb–
; }

30 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
	gmsg
; }

31 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 = y2 =ğ0 ? y1 : 
¡d
::
mš
(y1, y2); }

32 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
CcS‹
& 
s
)

34 
A
 
	gtmp
 = 
s
.
Ïb–
;

35 
	gs
.
	gÏb–
 = 
¡d
::
mš
(
s
.
Ïb–
, 
y
);

36  
	gtmp
 !ğ
s
.
Ïb–
;

	@src/apps/graph_analytics/degree.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/’v.h
"

5 
	~"uts/di¡_tim”.h
"

6 
	~"deg»e.h
"

12 
usšg
 
	gvid_t
 = 
ušt32_t
;

13 
usšg
 
	gew_t
 = 
Em±y
;

16 
	$run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
nv”tiûs
, 
boŞ
 
out_deg»e
 = 
çl£
)

18 
G¿ph
<
ew_t
> 
G
;

19 
G
.
	`lßd_dœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
, 
out_deg»e
);

21 
DegV”‹x
<
ew_t
> 
	`vp
(&
G
, 
Œue
);

23 
Env
::
	`b¬r›r
();

24 
Di¡Tim”
 
	`tim”
("Degree Execution");

25 
vp
.
	`execu‹
(1);

26 
tim”
.
	`¡İ
();

28 ià(
out_deg»e
)

29 
LOG
.
	`šfo
("Out-Degrees: \n");

31 
LOG
.
	`šfo
("In-Degrees: \n");

32 
vp
.
	`di¥Ïy
();

33 
tim”
.
	`»pÜt
();

34 
	}
}

37 
	$maš
(
¬gc
, * 
¬gv
[])

39 
Env
::
	`š™
();

42 ià(
¬gc
 < 3)

44 
LOG
.
	`”rÜ
("Usage: %s <filepath> <num_vertices: 0 if header…resent> "

45 "[-Ø(out-deg»e)] \n", 
¬gv
[0]);

46 
Env
::
	`ex™
(1);

50 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

51 
vid_t
 
nv”tiûs
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[2]);

52 
boŞ
 
out_deg»e
 = (
¬gc
 > 3 && 
¡d
::
	`¡ršg
(
¬gv
[3]) == "-o");

54 
	`run
(
f•©h
, 
nv”tiûs
, 
out_deg»e
);

56 
Env
::
	`fš®ize
();

58 
	}
}

	@src/apps/graph_analytics/degree.h

1 #iâdeà
DEGREE_H


2 
	#DEGREE_H


	)

4 
	~<ÿs£¹
>

5 
	~"v´og¿m/v”‹x_´og¿m.h
"

14 
usšg
 
	gdeg_t
 = 
ušt32_t
;

17 
	gDegS‹
 : 
S‹


19 
deg_t
 
deg»e
 = 0;

20 
	g¡d
::
¡ršg
 
to_¡ršg
(ècÚ¡ {  "{deg»e: " + 
¡d
::to_¡ršg(
deg»e
) + "}"; }

24 
	g‹m¶©e
 <
şass
 
	gew_t
 = 
Em±y
>

25 
şass
 
DegV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, 
	gdeg_t
, 
	gDegS‹
>

27 
	gpublic
:

28 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = 
deg_t
; usšg 
	gS
 = 
DegS‹
;

29 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

31 
M
 
sÿ‰”
(cÚ¡ 
DegS‹
& 
s
) {  M(); }

32 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
) {  1; }

33 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

34 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DegS‹
& 
s
è{ 
	gs
.
	gdeg»e
 = y;  
	gŒue
; }

	@src/apps/graph_analytics/pr.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"´.h
"

11 
	$run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
nv”tiûs
, 
ušt32_t
 
n™”s
)

14 
G¿ph
<
ew_t
> 
GR
;

15 
GR
.
	`lßd_dœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
,rue);

17 
DegV”‹x
<
ew_t
> 
	`vp_deg»e
(&
GR
, 
Œue
);

19 
Di¡Tim”
 
	`deg»e_tim”
("Degree Execution");

20 
vp_deg»e
.
	`execu‹
(1);

21 
deg»e_tim”
.
	`¡İ
();

24 
GR
.
	`ä“
();

27 
G¿ph
<
ew_t
> 
G
;

28 
G
.
	`lßd_dœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
);

31 
PrV”‹x
 
	`vp
(&
G
, 
Œue
);

33 
vp
.
	`š™Ÿlize
(
vp_deg»e
);

35 
vp_deg»e
.
	`ä“
();

37 
Env
::
	`b¬r›r
();

38 
Di¡Tim”
 
	`´_tim”
("Pagerank Execution");

39 
vp
.
	`execu‹
(
n™”s
);

40 
´_tim”
.
	`¡İ
();

42 
vp
.
	`di¥Ïy
();

43 
deg»e_tim”
.
	`»pÜt
();

44 
´_tim”
.
	`»pÜt
();

47 
deg_checksum
 = 
vp
.
»duû
<>(

48 [&](
ušt32_t
 
idx
, cÚ¡ 
PrS‹
& 
s
è-> {  s.
deg»e
; },

49 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

50 
LOG
.
	`šfo
("Deg»Checksum = %lu \n", 
deg_checksum
);

53 
å_t
 
´_checksum
 = 
vp
.
»duû
<fp_t>(

54 [&](
ušt32_t
 
idx
, cÚ¡ 
PrS‹
& 
s
è-> 
å_t
 {  s.
¿nk
; },

55 [&](
å_t
& 
a
, cÚ¡ fp_t& 
b
) {‡ += b; });

56 
LOG
.
	`šfo
("Pag”ªk Checksum = %là\n", 
´_checksum
);

57 
	}
}

60 
	$maš
(
¬gc
, * 
¬gv
[])

62 
Env
::
	`š™
();

65 ià(
¬gc
 < 3)

67 
LOG
.
	`šfo
("Usage: %s <filepath> <num_vertices: 0 if header…resent> "

68 "[<™”©iÚs> (deçuÉ: uÁ cÚv”g’û)] \n", 
¬gv
[0]);

69 
Env
::
	`ex™
(1);

73 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

74 
vid_t
 
nv”tiûs
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[2]);

75 
ušt32_t
 
n™”s
 = (
¬gc
 > 3è? (ušt32_tè
	`©oi
(
¬gv
[3]) : 0;

77 
	`run
(
f•©h
, 
nv”tiûs
, 
n™”s
);

79 
Env
::
	`fš®ize
();

81 
	}
}

	@src/apps/graph_analytics/pr.h

1 #iâdeà
PR_H


2 
	#PR_H


	)

4 
	~<ÿs£¹
>

5 
	~<cm©h
>

6 
	~"deg»e.h
"

12 
usšg
 
	gvid_t
 = 
ušt32_t
;

13 
usšg
 
	gew_t
 = 
Em±y
;

14 
usšg
 
	gå_t
 = ;

16 
cÚ¡ex´
 
å_t
 
	g®pha
 = 0.15;

17 
cÚ¡ex´
 
å_t
 
	gtŞ
 = 1e-5;

20 
	gPrS‹
 : 
DegS‹


22 
å_t
 
¿nk
 = 
®pha
;

23 
	g¡d
::
¡ršg
 
to_¡ršg
() const

24 {  "{¿nk: " + 
¡d
::
to_¡ršg
(
¿nk
è+ ", deg»e: " + std::to_¡ršg(
deg»e
) + "}"; }

28 
şass
 
	gPrV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gå_t
, fp_t, 
	gPrS‹
>

30 
	gpublic
:

31 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
å_t
; usšg 
	gA
 = fp_t; usšg 
	gS
 = 
PrS‹
;

32 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

34 
boŞ
 
š™
(
ušt32_t
 
vid
, cÚ¡ 
S‹
& 
Ùh”
, 
PrS‹
& 
s
)

35 { 
	gs
.
	gdeg»e
 = ((cÚ¡ 
DegS‹
&è
Ùh”
).
deg»e
;  
	gŒue
; }

37 
M
 
sÿ‰”
(cÚ¡ 
PrS‹
& 
s
è{  
	gs
.
	g¿nk
 / s.
	gdeg»e
; }

38 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
	gmsg
; }

39 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

40 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
PrS‹
& 
s
)

42 
A
 
	gtmp
 = 
s
.
¿nk
;

43 
	gs
.
	g¿nk
 = 
®pha
 + (1.0 -‡Íhaè* 
y
;

44  
çbs
(
s
.
¿nk
 - 
tmp
è> 
	gtŞ
;

	@src/apps/graph_analytics/sssp.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"ss¥.h
"

11 
	$run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
nv”tiûs
, vid_ˆ
roÙ
)

13 
G¿ph
<
ew_t
> 
G
;

14 
G
.
	`lßd_dœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
);

16 
SpV”‹x
 
	`vp
(&
G
);

17 
vp
.
roÙ
 =„oot;

18 
vp
.
	`š™Ÿlize
();

20 
Env
::
	`b¬r›r
();

21 
Di¡Tim”
 
	`tim”
("SSSP Execution");

22 
vp
.
	`execu‹
();

23 
tim”
.
	`¡İ
();

25 
vp
.
	`di¥Ïy
();

26 
tim”
.
	`»pÜt
();

28 
Ä—chabË
 = 
vp
.
»duû
<>(

29 [&](
ušt32_t
 
vid
, cÚ¡ 
SpS‹
& 
s
è-> {  s.
di¡ªû
 !ğ
INF
; },

30 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

31 
LOG
.
	`šfo
("R—chabË V”tiû ğ%lu \n", 
Ä—chabË
);

34 
checksum
 = 
vp
.
»duû
<>(

35 [&](
ušt32_t
 
vid
, cÚ¡ 
SpS‹
& 
s
è-> {  s.
di¡ªû
.
v®ue
; },

36 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

37 
LOG
.
	`šfo
("Checksum = %lu \n", 
checksum
);

38 
	}
}

41 
	$maš
(
¬gc
, * 
¬gv
[])

43 
Env
::
	`š™
();

46 ià(
¬gc
 < 4)

48 
LOG
.
	`šfo
("U§ge: % <f•©h> <num_v”tiûs: 0 iàh—d”…»£Á> <roÙ> \n", 
¬gv
[0]);

49 
Env
::
	`ex™
(1);

53 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

54 
vid_t
 
nv”tiûs
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[2]);

55 
vid_t
 
roÙ
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[3]);

57 
	`run
(
f•©h
, 
nv”tiûs
, 
roÙ
);

59 
Env
::
	`fš®ize
();

61 
	}
}

	@src/apps/graph_analytics/sssp.h

1 #iâdeà
SSSP_H


2 
	#SSSP_H


	)

4 
	~<ÿs£¹
>

5 
	~"v´og¿m/v”‹x_´og¿m.h
"

11 
usšg
 
	gvid_t
 = 
ušt32_t
;

12 
usšg
 
	gew_t
 = 
ušt32_t
;

14 
cÚ¡ex´
 
ušt32_t
 
	gINF
 = (ušt32_tè
UINT32_MAX
/2;

15 
usšg
 
	gdi¡_t
 = 
IÁeg”W¿µ”
<
INF
>;

18 
	gSpS‹
 : 
S‹


20 
di¡_t
 
di¡ªû
 = 
INF
;

21 
	g¡d
::
¡ršg
 
to_¡ršg
() const

22 {  "{di¡ªû: " + 
¡d
::
to_¡ršg
(
di¡ªû
.
v®ue
) + "}"; }

26 
şass
 
	gSpV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gdi¡_t
, di¡_t, 
	gSpS‹
>

28 
	gpublic
:

29 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
di¡_t
; usšg 
	gA
 = di¡_t; usšg 
	gS
 = 
SpS‹
;

30 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

32 
ušt32_t
 
	groÙ
 = 0;

34 
boŞ
 
š™
(
ušt32_t
 
vid
, 
SpS‹
& 
s
)

35 { ià(
	gvid
 =ğ
roÙ
è{ 
s
.
di¡ªû
 = 0;  
	gŒue
; }  
	gçl£
; }

37 
M
 
sÿ‰”
(cÚ¡ 
SpS‹
& 
s
è{  
	gs
.
	gdi¡ªû
; }

38 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
	gmsg
.
	gv®ue
 + 
	gedge
.
	gweight
; }

39 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 = 
¡d
::
mš
(y1, y2); }

40 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
SpS‹
& 
s
)

42 
A
 
	gtmp
 = 
s
.
di¡ªû
;

43 
	gs
.
	gdi¡ªû
 = 
¡d
::
mš
(
s
.
di¡ªû
, 
y
);

44  
	gtmp
 !ğ
s
.
di¡ªû
;

	@src/apps/graph_analytics/tc.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"tc.h
"

11 
	$run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
nv”tiûs
)

15 
G¿ph
<
ew_t
>* 
G
 = 
Ãw
 Graph<ew_t>();

16 
G
->
	`lßd_dœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
, 
çl£
,rue);

18 
G¿ph
<
ew_t
> 
GR
;

19 
GR
.
	`lßd_dœeùed
(
Œue
, 
f•©h
, 
nv”tiûs
,rue,rue);

22 
GnV”‹x
* 
vp_gn
 = 
Ãw
 
	`GnV”‹x
(
G
, 
Œue
);

23 
vp_gn
->
	`š™Ÿlize
();

25 
Env
::
	`b¬r›r
();

26 
Di¡Tim”
 
	`tc_tim”
("Triangle Counting");

27 
Di¡Tim”
 
	`gn_tim”
("P1: Get Neighbors");

28 
vp_gn
->
	`execu‹
(1);

29 
gn_tim”
.
	`¡İ
();

31 
d–‘e
 
G
;

34 
CtV”‹x
 
	`vp_ù
(&
GR
, 
Œue
);

35 
vp_ù
.
	`š™Ÿlize
(*
vp_gn
);

36 
d–‘e
 
vp_gn
;

38 
Di¡Tim”
 
	`ù_tim”
("P2: Count Triangles");

39 
vp_ù
.
	`execu‹
(1);

40 
ù_tim”
.
	`¡İ
();

41 
tc_tim”
.
	`¡İ
();

44 
gn_tim”
.
	`»pÜt
();

45 
ù_tim”
.
	`»pÜt
();

46 
tc_tim”
.
	`»pÜt
();

48 
ÁrŸngËs
 = 
vp_ù
.
»duû
<>(

49 [&](
ušt32_t
 
idx
, cÚ¡ 
CtS‹
& 
s
è-> {  s.
ÁrŸngËs
; },

50 [&](& 
a
, cÚ¡ & 
b
) {‡ += b; });

51 
LOG
.
	`šfo
("TrŸngË ğ%lu \n", 
ÁrŸngËs
);

52 
	}
}

55 
	$maš
(
¬gc
, * 
¬gv
[])

57 
Env
::
	`š™
();

60 ià(
¬gc
 < 3)

62 
LOG
.
	`šfo
("U§ge: % <f•©h> <num_v”tiûs: 0 iàh—d”…»£Á> \n", 
¬gv
[0]);

63 
Env
::
	`ex™
(1);

67 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

68 
vid_t
 
nv”tiûs
 = (vid_tè
¡d
::
	`©Ş
(
¬gv
[2]);

70 
	`run
(
f•©h
, 
nv”tiûs
);

72 
Env
::
	`fš®ize
();

74 
	}
}

	@src/apps/graph_analytics/tc.h

1 #iâdeà
TC_H


2 
	#TC_H


	)

4 
	~<ÿs£¹
>

5 
	~"uts/commÚ.h
"

6 
	~"v´og¿m/v”‹x_´og¿m.h
"

12 
usšg
 
	gvid_t
 = 
ušt32_t
;

13 
usšg
 
	gew_t
 = 
Em±y
;

16 
	gGnS‹
 : 
S‹


18 
¡d
::
veùÜ
<
vid_t
> 
ÃighbÜs
;

20 
	g¡d
::
¡ršg
 
to_¡ršg
() const

22 
¡d
::
¡ršg
 
¡r
 = "{neighbors: [";

23 autØ
	gvid
 : 
ÃighbÜs
è{ 
¡r
 +ğ
¡d
::
to_¡ršg
(
vid
è+ ", "; } 
	g¡r
 += "]";

24  
	g¡r
 + "}";

29 
	gCtS‹
 : 
S‹
, 
	gS”ŸlizabËVeùÜ
<
	gvid_t
>

31 
ušt32_t
 
	gÁrŸngËs
 = 0;

33 
CtS‹
() {}

34 
CtS‹
(cÚ¡ 
¡d
::
veùÜ
<
vid_t
>&& 
Ùh”
è: 
S”ŸlizabËVeùÜ
<vid_t>(other) {}

36 
usšg
 
S”ŸlizabËVeùÜ
::
£rŸlize
;

38 
	g¡d
::
¡ršg
 
to_¡ršg
() const

40 
¡d
::
¡ršg
 
¡r
 = "{ÁrŸngËs: " + std::
to_¡ršg
(
ÁrŸngËs
) + ",‚eighbors: [";

41 autØ
	gvid
 : *
this
è{ 
¡r
 +ğ
¡d
::
to_¡ršg
(
vid
è+ ", "; } 
	g¡r
 += "]";

42  
	g¡r
 + "}";

47 
şass
 
	gGnV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, 
	gS”ŸlizabËVeùÜ
<
	gvid_t
>, 
	gGnS‹
>

49 
	gpublic
:

50 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = 
S”ŸlizabËVeùÜ
<
vid_t
>; usšg 
	gS
 = 
GnS‹
;

51 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

53 
M
 
sÿ‰”
(cÚ¡ 
GnS‹
& 
s
) {  M(); }

54 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{ A 
	gtmp
;mp.
push_back
Ódge.
¤c
); mp; }

55 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
.
š£¹
(y2.
’d
(), y1.
cbegš
(), y1.
ûnd
()); }

56 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
GnS‹
& 
s
)

58 ià(
nÙ
 
	gy
.
em±y
())

60 
	gs
.
	gÃighbÜs
 = 
¡d
::
move
(
y
);

61 
	g¡d
::
sÜt
(
s
.
ÃighbÜs
.
begš
(), s.ÃighbÜs.
’d
());

63  
	gçl£
;

68 
şass
 
	gCtV”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gS”ŸlizabËVeùÜ
<
	gvid_t
>, 
	gušt32_t
, 
	gCtS‹
>

70 
	gpublic
:

71 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
S”ŸlizabËVeùÜ
<
vid_t
>; usšg 
	gA
 = 
ušt32_t
; usšg 
	gS
 = 
CtS‹
;

72 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

74 
boŞ
 
š™
(
ušt32_t
 
vid
, cÚ¡ 
S‹
& 
Ùh”
, 
CtS‹
& 
s
)

76 auto& 
	ggs
 = (cÚ¡ 
GnS‹
&è
Ùh”
;

77 ià(
	ggs
.
	gÃighbÜs
.
em±y
())

78  
	gçl£
;

79 
	gs
 = 
¡d
::
move
(
gs
.
ÃighbÜs
);

80  
	gŒue
;

83 
M
 
sÿ‰”
(cÚ¡ 
CtS‹
& 
s
) {  M(s); }

84 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
, cÚ¡ 
CtS‹
& 
s
)

86 
A
 
	g‹mp
 = 0;

88 autØ
	g™1_’d
 = 
s
.
size
();

89 autØ
	g™2_’d
 = 
msg
.
size
();

90 autØ
	g™1
 = 0, 
	g™2
 = 0;

91 
	g™1
 !ğ
™1_’d
 && 
™2
 !ğ
™2_’d
)

92 ià(
s
[
™1
] =ğ
msg
[
™2
]è{ 
‹mp
++; ++
	g™1
; ++
	g™2
; }

93 ià(
	gs
[
™1
] < 
	gmsg
[
™2
]è++
	g™1
;

94 ++
	g™2
;

95  
	g‹mp
;

97 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

98 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
CtS‹
& 
s
è{ 
	gs
.
	gÁrŸngËs
 = y;  
	gçl£
; }

	@src/apps/graph_simulation/graphsim.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<funùiÚ®
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"g¿phsim.h
"

14 
»ad_Ïb–s_jsÚ
(
¡ršg
& 
f•©h
, 
veùÜ
<¡ršg>& 
Ïb–s
)

16 
if¡»am
 
fš
(
f•©h
);

18 ià(
nÙ
 
	gfš
.
good
())

19 
	gLOG
.
çl
("Could‚Ù„—d f% \n", 
f•©h
.
c_¡r
());

21 
cÚ¡ex´
 
size_t
 
	gBUFF_SIZE
 = 2048;

22 
	gbufãr
[
BUFF_SIZE
];

24 
	gfš
.
g‘lše
(
bufãr
, 
BUFF_SIZE
);

26 autØ
	gi
 = 0; i < 
	gÏb–s
.
size
(); i++)

29 
	gfš
.
g‘lše
(
bufãr
, 
BUFF_SIZE
);

31 ià(
	gi
 =ğ0 
ªd
 
¡rcmp
(
bufãr
, "null,") == 0)

34 * 
	gtok’
 = 
¡¹ok
(
bufãr
, ":");

35 
	gtok’
 = 
¡¹ok
(
nuÎ±r
, ":");

36 
	gtok’
 = 
¡¹ok
(
tok’
 + 1, "\"");

37 
	gÏb–s
[
i
] = 
¡ršg
(
tok’
);

40 
	gfš
.
şo£
();

44 
	$run
(
¡ršg
& 
dgl_f•©h
, sŒšg& 
dgm_f•©h
, 
vid_t
 
nv”tiûs
,

45 
¡ršg
& 
qgl_f•©h
, sŒšg& 
qgm_f•©h
)

48 
G¿ph
<
ew_t
> 
GR
;

49 
GR
.
	`lßd_dœeùed
(
Œue
, 
dgm_f•©h
, 
nv”tiûs
,rue);

52 
GsV”‹x
 
	`vp
(&
GR
);

53 
In™V”‹x
 
	`vp_š™
(
vp
, 
Œue
);

56 
¡d
::
veùÜ
<
¡ršg
> 
	`dg_Ïb–s
(
nv”tiûs
);

57 
	`»ad_Ïb–s_jsÚ
(
dgl_f•©h
, 
dg_Ïb–s
);

58 
vp_š™
.
Ïb–s
 = &
dg_Ïb–s
;

60 
Di¡Tim”
 
	`š™_tim”
("Init Execution");

61 
vp_š™
.
	`execu‹
(1);

62 
š™_tim”
.
	`¡İ
();

66 
Env
::
	`b¬r›r
();

67 
Qu”y
 
	`qu”y
(
qgl_f•©h
, 
qgm_f•©h
);

68 
vp
.
q
 = &
qu”y
;

70 
Di¡Tim”
 
	`gs_tim”
("GraphSim Execution");

71 
vp
.
	`execu‹
();

72 
gs_tim”
.
	`¡İ
();

76 
vid_t
 
nm©ches
 = 
vp
.
»duû
<vid_t>(

77 [&](
ušt32_t
 
idx
, cÚ¡ 
GsS‹
& 
s
è-> 
vid_t


81 autØ
r
 : 
s
.
»s
)

82 ià(
r
 != '0')  1;

85 [&](
vid_t
& 
a
, cÚ¡ vid_t& 
b
) {‡ += b; });

86 
LOG
.
	`šfo
("M©che ğ%u \n", 
nm©ches
);

88 
š™_tim”
.
	`»pÜt
();

89 
gs_tim”
.
	`»pÜt
();

90 
	}
}

93 
	$maš
(
¬gc
, * 
¬gv
[])

95 
Env
::
	`š™
();

97 
LOG
.
	`£t_log_Ëv–
(
LogLev–
::
DEBUG
);

100 ià(
¬gc
 < 6)

102 
LOG
.
	`šfo
("Usage: %s <data_graph_labels_filepath> <data_graph_matrix_filepath> <nvertices> "

104 
¬gv
[0]);

105 
Env
::
	`ex™
(1);

109 
¡ršg
 
dgl_f•©h
 = 
¬gv
[1];

110 
¡ršg
 
dgm_f•©h
 = 
¬gv
[2];

111 
vid_t
 
nv”tiûs
 = (vid_tè
	`©oi
(
¬gv
[3]);

112 
¡ršg
 
qgl_f•©h
 = 
¬gv
[4];

113 
¡ršg
 
qgm_f•©h
 = 
¬gv
[5];

115 
	`run
(
dgl_f•©h
, 
dgm_f•©h
, 
nv”tiûs
, 
qgl_f•©h
, 
qgm_f•©h
);

117 
Env
::
	`fš®ize
();

119 
	}
}

	@src/apps/graph_simulation/graphsim.h

1 #iâdeà
GRAPHSIM_H


2 
	#GRAPHSIM_H


	)

4 
	~<ÿs£¹
>

5 
	~"v´og¿m/v”‹x_´og¿m.h
"

6 
	~"g¿phsim_qu”y.h
"

8 
usšg
 
Çme¥aû
 
	g¡d
;

17 
usšg
 
	gvid_t
 = 
ušt32_t
;

18 
usšg
 
	gew_t
 = 
Em±y
;

20 
usšg
 
	gsveùÜ_št
 = 
S”ŸlizabËVeùÜ
<>;

21 
usšg
 
	gsveùÜ_boŞ
 = 
S”ŸlizabËVeùÜ
<
boŞ
>;

24 
	gGsS‹
 : 
S‹


26 
vid
;

27 
¡ršg
 
	gÏb–
;

28 
	gveùÜ
<> 
	g»s
;

29 
sveùÜ_št
 
	gpm
;

30 
sveùÜ_boŞ
 
	gmm
;

31 
	gdeg»e
 = 0;

32 
	gd•s
 = 0;

34 
¡ršg
 
to_¡ršg
() const

36 
¡ršg
 
	gs
 = "{ ";

37 
	gs
 = 
s
 + 
Ïb–
 + ": " + 
¡d
::
to_¡ršg
(
vid
);

38 
	gs
 = 
s
 + ",„es: ";

39 autØ
	gi
 : 
»s
è
s
 +ğ
i
;

40 
	gs
 = 
s
 + ",…m: [";

41 autØ
	gi
 : 
pm
è
s
 +ğ
¡d
::
to_¡ršg
(
i
) + ",";

42 
	gs
 = 
s
 + "], mm: ";

43 autØ
	gi
 : 
mm
è
s
 +ğ
i
 ? "1" : "0";

44 
	gs
 = 
s
 + ", deg»e: " + 
¡d
::
to_¡ršg
(
deg»e
);

45 
	gs
 = 
s
 + ", d•s: " + 
¡d
::
to_¡ršg
(
d•s
);

46 
	gs
 = 
s
 + " }";

47  
	gs
;

55 
şass
 
	gIn™V”‹x
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, , 
	gGsS‹
>

57 
	gpublic
:

58 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = ; usšg 
	gS
 = 
GsS‹
;

59 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

61 
	gveùÜ
<
	g¡ršg
>* 
	gÏb–s
 = 
nuÎ±r
;

63 
boŞ
 
š™
(
ušt32_t
 
vid
, 
GsS‹
& 
s
)

65 
	gs
.
	gvid
 = 
vid
;

66 ià(
	gvid
 < 
	gÏb–s
->
size
())

67 
	gs
.
	gÏb–
 = 
move
((*
Ïb–s
)[
vid
]);

68  
	gŒue
;

71 
M
 
sÿ‰”
(cÚ¡ 
GsS‹
& 
s
) {  M(); }

72 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
) {  1; }

73 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

74 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
GsS‹
& 
s
è{ 
	gs
.
	gdeg»e
 = y;  
	gŒue
; }

78 
usšg
 
	gW
 = 
ew_t
;

79 
usšg
 
	gM
 = 
sveùÜ_boŞ
;

80 
usšg
 
	gA
 = 
sveùÜ_št
;

81 
usšg
 
	gS
 = 
GsS‹
;

83 
şass
 
	gGsV”‹x
 : 
public
 
V”‹xProg¿m
<
W
, 
	gM
, 
	gA
, 
	gS
>

85 
	gpublic
:

86 
usšg
 
V”‹xProg¿m
<
W
, 
	gM
, 
	gA
, 
	gS
>::VertexProgram;

88 
Qu”y
* 
	gq
 = 
nuÎ±r
;

90 
boŞ
 
š™
(
ušt32_t
 
vid
, 
GsS‹
& 
s
)

92 
	gs
.
	g»s
.
»size
(
q
->
size
);

93 
	gs
.
	gmm
.
»size
(
q
->
size
);

94 
	gs
.
	gpm
.
»size
(
q
->
size
);

96 
	g¡d
::
fl
(
s
.
»s
.
begš
(), s.»s.
’d
(), 'U');

97 
	g¡d
::
fl
(
s
.
pm
.
begš
(), s.pm.
’d
(), -1);

99 
	gi
 = 0; i < 
	gq
->
	gsize
; i++)

101 ià(
	gs
.
	gÏb–
 =ğ
q
->
Ïb–s
[
i
] 
ªd
 q->
chd»n
[i].
em±y
())

102 
s
.
»s
[
i
] = '1';

103 ià(
	gs
.
	gÏb–
 =ğ
q
->
Ïb–s
[
i
] 
ªd
 
s
.
deg»e
 > 0)

105 
s
.
d•s
++;

106 
	gj
 : 
q
->
chd»n
[
i
])

107 
s
.
pm
[
j
] = s.
deg»e
;

111 
	gs
.
	g»s
[
i
] = '0';

112 
	gs
.
	gmm
[
i
] = 
Œue
;

115  
couÁ
(
s
.
mm
.
begš
(), s.mm.
’d
(), 
Œue
) > 0;

118 
M
 
sÿ‰”
(cÚ¡ 
GsS‹
& 
s
)

121  
	gs
.
	gmm
;

124 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
)

127 
A
 
y
(
q
->
size
);

128 
	gi
 = 0; i < 
	gq
->
	gsize
; i++)

129 
	gy
[
i
] = 
msg
[i];

130  
	gy
;

133 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
)

135 
	gy2
.
»size
(
q
->
size
);

136 
	gi
 = 0; i < 
	gq
->
	gsize
; i++)

137 
	gy2
[
i
] +ğ
y1
[i];

140 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
GsS‹
& 
s
, 
ušt32_t
 
™”
)

142 ià(
	gs
.
	gÏb–
.
em±y
()è 
	gçl£
;

147 
fl
(
s
.
mm
.
begš
(), s.mm.
’d
(), 
çl£
);

148 
	gi
 = 0; i < 
	gq
->
	gsize
; i++)

150 ià(
	gs
.
	g»s
[
i
] == 'U')

152 
j
 : 
q
->
chd»n
[
i
])

154 ià(
s
.
pm
[
j
] > 0)

156 
s
.
pm
[
j
] -ğ
y
[j];

157 ià(
	gs
.
	gpm
[
j
] == 0)

159 
s
.
»s
[
i
] = '0';

160 
	gs
.
	gmm
[
i
] = 
Œue
;

161 
	gs
.
	gd•s
--;

169  
couÁ
(
s
.
mm
.
begš
(), s.mm.
’d
(), 
Œue
) > 0;

	@src/apps/graph_simulation/graphsim_query.h

1 #iâdeà
GRAPHSIM_QUERY_H


2 
	#GRAPHSIM_QUERY_H


	)

4 
	~<ÿs£¹
>

5 
	~<f¡»am
>

6 
	~<veùÜ
>

7 
	~<io¡»am
>

8 
	~<uts/log.h
>

11 
usšg
 
Çme¥aû
 
	g¡d
;

14 
»ad_Ïb–s
(
¡ršg
& 
f•©h
, 
veùÜ
<¡ršg>& 
Ïb–s
)

16 
if¡»am
 
fš
(
f•©h
);

17 
nÙ
 
	gfš
.
eof
())

19 
¡ršg
 
	gÏb–
;

20 
	gfš
 >> 
	gÏb–
;

21 
	gÏb–s
.
push_back
(
Ïb–
);

23 
	gfš
.
şo£
();

27 
	sQu”y


29 
	msize
 = 0;

30 
	mveùÜ
<
	m¡ršg
> 
	mÏb–s
;

31 
	mveùÜ
<veùÜ<>> 
	mchd»n
;

33 
Qu”y
(
¡ršg
& 
qgl_f•©h
, sŒšg& 
qgm_f•©h
)

35 
»ad_Ïb–s
(
qgl_f•©h
, 
Ïb–s
);

37 
	msize
 = 
Ïb–s
.
size
();

38 
	mchd»n
.
»size
(
size
);

40 
if¡»am
 
fš_mtx
(
qgm_f•©h
);

41 
nÙ
 
	mfš_mtx
.
eof
())

43 
	mi
, 
	mj
;

44 
	mfš_mtx
 >> 
	mi
;

45 ià(
	mfš_mtx
.
eof
()) ;

46 
	mfš_mtx
 >> 
	mj
;

47 
	mchd»n
[
i
].
push_back
(
j
);

49 
	mfš_mtx
.
şo£
();

	@src/apps/information_retrieval/tfidf.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<£t
>

4 
	~<unÜd”ed_m­
>

5 
	~<f¡»am
>

6 
	~"uts/di¡_tim”.h
"

7 
	~"tfidf.h
"

9 
usšg
 
Çme¥aû
 
	g¡d
;

12 
size_t
 
	$couÁ_lšes
(
¡ršg
& 
f•©h
)

14 
size_t
 
num_lšes
 = 0;

15 
if¡»am
 
	`fš
(
f•©h
);

16 ià(
nÙ
 
fš
.
	`good
())

17 
LOG
.
	`çl
("Could‚Ù„—d f% \n", 
f•©h
.
	`c_¡r
());

18 
nÙ
 
fš
.
	`eof
())

20 
cÚ¡ex´
 
size_t
 
BUFF_SIZE
 = 2048;

21 
bufãr
[
BUFF_SIZE
];

22 
fš
.
	`g‘lše
(
bufãr
, 
BUFF_SIZE
);

23 ià(
	`¡¾’
(
bufãr
è=ğ0 
Ü
 
fš
.
	`eof
())

25 
num_lšes
++;

27 
fš
.
	`şo£
();

28  
num_lšes
;

29 
	}
}

32 
lßd_Ïb–s
(
¡ršg
& 
f•©h
, 
size_t
 
nv”tiûs
,

33 
¡ršg
& 
Ïb–_d©a
, 
veùÜ
<
size_t
>& 
Ïb–_±rs
)

35 
if¡»am
 
fš
(
f•©h
);

36 
¡ršg
 
	gÏb–
;

37 autØ
	gi
 = 0; i < 
	gnv”tiûs
; i++)

39 
	gÏb–_±rs
[
i
] = 
Ïb–_d©a
.
size
();

40 
	gÏb–
.
ş—r
();

41 
	gfš
 >> 
	gÏb–
;

42 
	gÏb–_d©a
 +ğ
Ïb–
 + " ";

43 
	gÏb–_d©a
[
Ïb–_d©a
.
size
() - 1] = '\0';

45 
	gfš
.
şo£
();

46 
	gÏb–_d©a
.
shršk_to_f™
();

50 
lßd_qu”›s
(
¡ršg
& 
f•©h
, 
veùÜ
<
unÜd”ed_£t
<¡ršg>>& 
qu”›s
)

52 
size_t
 
	gnum_lšes
 = 
couÁ_lšes
(
f•©h
);

53 
	gqu”›s
.
»size
(
num_lšes
);

54 
if¡»am
 
fš
(
f•©h
);

55 autØ
	gi
 = 0; i < 
	gnum_lšes
; i++)

57 
cÚ¡ex´
 
size_t
 
	gBUFF_SIZE
 = 2048;

58 
	gbufãr
[
BUFF_SIZE
];

59 
	gfš
.
g‘lše
(
bufãr
, 
BUFF_SIZE
);

60 ià(
	gfš
.
eof
())

62 * 
	gtok’
 = 
¡¹ok
(
bufãr
, " ");

63 
	gtok’
)

65 
	gqu”›s
[
i
].
š£¹
(
¡ršg
(
tok’
));

66 
	gtok’
 = 
¡¹ok
(
nuÎ±r
, " ");

69 
	gfš
.
şo£
();

73 
	$run
(
¡ršg
& 
f•©h_g¿ph
, sŒšg& 
f•©h_Ïb–s
, sŒšg& 
f•©h_qu”›s
,

74 
ušt32_t
 
k
, ušt32_ˆ
r
)

76 
LOG
.
	`šfo
("Loading†abels ... \n");

77 
¡ršg
 
Ïb–_d©a
;

78 
size_t
 
nv”tiûs
 = 
BP
::
nd
 + BP::
Á
;

79 
veùÜ
<
size_t
> 
	`Ïb–_±rs
(
nv”tiûs
);

80 
	`lßd_Ïb–s
(
f•©h_Ïb–s
, 
nv”tiûs
, 
Ïb–_d©a
, 
Ïb–_±rs
);

81 
LOG
.
šfo
<
çl£
>("Lab–s: %lu (%lu by‹sè\n", 
Ïb–_±rs
.
	`size
(), 
Ïb–_d©a
.size());

83 
Env
::
	`b¬r›r
();

84 
	`¦“p
(10);

86 
LOG
.
	`šfo
("Loading queries ... \n");

87 
veùÜ
<
unÜd”ed_£t
<
¡ršg
>> 
qu”›s
;

88 
	`lßd_qu”›s
(
f•©h_qu”›s
, 
qu”›s
);

89 
LOG
.
	`šfo
("Qu”›s: %lu \n", 
qu”›s
.
	`size
());

91 
Env
::
	`b¬r›r
();

92 
	`¦“p
(10);

95 
G¿ph
<
ew_t
> 
G
;

96 
G
.
	`lßd_b¬t™e
(
Œue
, 
f•©h_g¿ph
, 
BP
::
nd
, BP::
Á
, 
çl£
);

99 
VP
 
	`bf0
(&
G
);

100 
bf0
.
Ïb–_d©a
 = &label_data;

101 
bf0
.
Ïb–_±rs
 = &label_ptrs;

102 
Di¡Tim”
 
	`bf0_tim”
("BF Step 0: initialize†abels");

103 
bf0
.
	`š™Ÿlize
();

104 
bf0_tim”
.
	`¡İ
();

105 
Ïb–_d©a
.
	`»size
(0);

106 
Ïb–_±rs
.
	`»size
(0);

107 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

108 
bf0
.
	`di¥Ïy
();

111 
IDF
 
	`bf1
(
bf0
);

112 
Di¡Tim”
 
	`bf1_tim”
("BF Step 1: idf(t) for‡ll in C");

113 
bf1
.
	`execu‹
(1);

114 
bf1_tim”
.
	`¡İ
();

115 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

116 
bf1
.
	`di¥Ïy
();

119 
DL
 
	`bf2
(
bf0
);

120 
Di¡Tim”
 
	`bf2_tim”
("BF Step 2:†ength(D) (for‡ll in D) for‡ll D");

121 
bf2
.
	`»£t_aùiv™y
();

122 
bf2
.
	`execu‹
(1);

123 
bf2_tim”
.
	`¡İ
();

124 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

125 
bf2
.
	`di¥Ïy
();

127 
TFIDF
 
	`bf3
(
bf0
);

129 
tfidf_time
 = 0, 
bf_time
 = 0;

131 autØ
qu”y
 : 
qu”›s
)

134 
Di¡Tim”
 
	`tfidf_tim”
("TFIDF");

135 
Di¡Tim”
 
	`bf_tim”
("TFIDF with Blind Feedback");

139 
bf3
.
qu”y_‹rms
 = &
qu”y
;

140 
Di¡Tim”
 
	`bf3_tim”
("BF Step 3: score(D) (for‡ll in Q) for‡ll D where in D");

141 
bf3
.
	`»£t
();

142 
bf3
.
	`»£t_aùiv™y
();

152 
bf3
.
	`execu‹
(1);

153 
bf3_tim”
.
	`¡İ
();

154 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

155 
bf3
.
	`di¥Ïy
();

158 
usšg
 
iv_t
 = 
·œ
<
vid_t
, 
å_t
>;

159 
veùÜ
<
iv_t
> 
tİk
;

160 
Di¡Tim”
 
	`bf4_tim”
("BF Step 4:op-k docs for Q");

161 
bf3
.
tİk
<
vid_t
, 
å_t
>(
k
,opk,

162 [&](
vid_t
 
vid
, cÚ¡ 
DtS‹
& 
s
è{  vid <ğ
BP
::
nd
 ? s.
scÜe
 / s.
Ëngth
 : 0; },

163 [&](cÚ¡ 
iv_t
& 
a
, cÚ¡ iv_t& 
b
è{ ‡.
£cÚd
 > b.second; },

164 
Œue
);

165 
bf4_tim”
.
	`¡İ
();

166 
tfidf_tim”
.
	`¡İ
();

167 ià(
qu”›s
.
	`size
(è=ğ1 
ªd
 
r
 == 0)

169 
LOG
.
	`šfo
("tİ-%d docs: \n", 
k
);

170 autØ
iv
 : 
tİk
)

171 
LOG
.
	`šfo
("idx %d: scÜ%là\n", 
iv
.
fœ¡
, iv.
£cÚd
);

174 ià(
r
 > 0)

177 
QE
 
	`bf5
(
bf0
);

178 
£t
<
vid_t
> 
docs
;

179 autØ
iv
 : 
tİk
)

180 
docs
.
	`š£¹
(
iv
.
fœ¡
);

181 
bf5
.
docs
 = &docs;

182 
Di¡Tim”
 
	`bf5_tim”
("BF Step 5:‡ctivate‡ll in D for‡ll D inop-k");

183 
bf5
.
	`»£t_aùiv™y
();

184 
bf5
.
	`execu‹
(1);

185 
bf5_tim”
.
	`¡İ
();

186 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

187 
bf5
.
	`di¥Ïy
();

190 
veùÜ
<
iv_t
> 
tİr
;

191 
Di¡Tim”
 
	`bf6_tim”
("BF Step 6: Q' =op-rerms in QE");

192 
bf5
.
tİk
<
vid_t
, 
å_t
>(
r
, 
tİr
,

193 [&](
vid_t
 
vid
, cÚ¡ 
DtS‹
& 
s
è{  vid > 
BP
::
nd
 ? s.
idf
 : 0; },

194 [&](cÚ¡ 
iv_t
& 
a
, cÚ¡ iv_t& 
b
è{ ‡.
£cÚd
 > b.second; },

195 
Œue
);

196 
bf6_tim”
.
	`¡İ
();

202 
TFIDF
 
	`bf7
(
bf0
);

203 
unÜd”ed_£t
<
¡ršg
> 
	`equ”y
(
qu”y
);

207 
bf7
.
qu”y_‹rms
 = &
equ”y
;

208 
Di¡Tim”
 
	`bf7_tim”
("BF Step 7:f-idf(D) for‡ll in Q' for‡ll D where in D");

209 
bf7
.
	`»£t_aùiv™y
();

219 
bf7
.
	`execu‹
(1);

220 
bf7_tim”
.
	`¡İ
();

221 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

222 
bf7
.
	`di¥Ïy
();

225 
Di¡Tim”
 
	`bf8_tim”
("BF Step 8:op-k docs for Q'");

226 
bf7
.
tİk
<
vid_t
, 
å_t
>(
k
,opk,

227 [&](
vid_t
 
vid
, cÚ¡ 
DtS‹
& 
s
è{  vid <ğ
BP
::
nd
 ? s.
scÜe
 / s.
Ëngth
 : 0; },

228 [&](cÚ¡ 
iv_t
& 
a
, cÚ¡ iv_t& 
b
è{ ‡.
£cÚd
 > b.second; },

229 
Œue
);

230 
bf8_tim”
.
	`¡İ
();

231 ià(
qu”›s
.
	`size
() == 1)

233 
LOG
.
	`šfo
("tİ-%d docs: \n", 
k
);

234 autØ
iv
 : 
tİk
)

235 
LOG
.
	`šfo
("idx %d: scÜ%là\n", 
iv
.
fœ¡
, iv.
£cÚd
);

238 
bf_tim”
.
	`¡İ
();

241 ià(
LOG
.
	`g‘_log_Ëv–
(è=ğ
LogLev–
::
DEBUG
)

243 
bf0_tim”
.
	`»pÜt
();

244 
bf1_tim”
.
	`»pÜt
();

245 
bf2_tim”
.
	`»pÜt
();

246 
bf3_tim”
.
	`»pÜt
();

248 
bf4_tim”
.
	`»pÜt
();

255 
tfidf_time
 +ğ
tfidf_tim”
.
	`»pÜt
(
çl£
);

256 
bf_time
 +ğ
bf_tim”
.
	`»pÜt
(
çl£
);

259 
LOG
.
	`šfo
("TFIDFime: %là\n", 
tfidf_time
 / 
qu”›s
.
	`size
());

260 
LOG
.
	`šfo
("TFIDF w™h Blšd F“dbackime: %là\n", 
bf_time
 / 
qu”›s
.
	`size
());

261 
	}
}

264 
	$maš
(
¬gc
, ** 
¬gv
)

266 
Env
::
	`š™
();

271 ià(
¬gc
 < 8)

273 
LOG
.
	`”rÜ
("Usage: %s <graph_filepath> <labels_filepath> <num_docs> <num_terms> "

274 "<qu”›s_f•©h> <k> <¸(0:‚Øblšd f“dback)> \n", 
¬gv
[0]);

275 
Env
::
	`ex™
(1);

279 
¡ršg
 
f•©h_g¿ph
 = 
¬gv
[1];

280 
¡ršg
 
f•©h_Ïb–s
 = 
¬gv
[2];

281 
BP
::
nd
 = (
vid_t
è
	`©oi
(
¬gv
[3]);

282 
BP
::
Á
 = (
vid_t
è
	`©oi
(
¬gv
[4]);

283 
¡ršg
 
f•©h_qu”›s
 = 
¬gv
[5];

284 
ušt32_t
 
k
 = 
	`©oi
(
¬gv
[6]);

285 
ušt32_t
 
r
 = 
	`©oi
(
¬gv
[7]);

287 
	`run
(
f•©h_g¿ph
, 
f•©h_Ïb–s
, 
f•©h_qu”›s
, 
k
, 
r
);

289 
Env
::
	`fš®ize
();

291 
	}
}

	@src/apps/information_retrieval/tfidf.h

1 #iâdeà
TFIDF_H


2 
	#TFIDF_H


	)

4 
	~<ÿs£¹
>

5 
	~<c¡dšt
>

6 
	~<¡ršg
>

7 
	~<cm©h
>

8 
	~"v´og¿m/v”‹x_´og¿m.h
"

11 
usšg
 
	gvid_t
 = 
ušt32_t
;

12 
usšg
 
	gew_t
 = 
ušt32_t
;

13 
usšg
 
	gå_t
 = ;

16 
	sBP
 { 
vid_t
 
	mnd
, 
	mÁ
; };

17 
vid_t
 
	gBP
::
nd
 = 0, BP::
Á
 = 0;

19 
	sDS‹
 { 
å_t
 
	mscÜe
 = 0.0, 
	mËngth
 = 1.0; };

20 
	sTS‹
 { 
å_t
 
	midf
 = 0.0; };

22 
	gDtS‹
 : 
DS‹
, 
	gTS‹
, 
	gS‹


24 
	g¡d
::
¡ršg
 
Ïb–
;

26 
	g¡d
::
¡ršg
 
to_¡ršg
() const

27 {  "{Ïb–: " + 
Ïb–
 + ", "

28 + "doc: (" + 
¡d
::
to_¡ršg
(
scÜe
è+ ", " + std::to_¡ršg(
Ëngth
) + "), "

29 + "‹rm: (" + 
¡d
::
to_¡ršg
(
idf
) + ")}"; }

34 
şass
 
	gVP
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, Em±y, 
	gDtS‹
>

36 
	gpublic
:

37 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = Em±y; usšg 
	gS
 = 
DtS‹
;

38 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

40 cÚ¡ 
	g¡d
::
¡ršg
* 
Ïb–_d©a
 = 
nuÎ±r
;

41 cÚ¡ 
	g¡d
::
veùÜ
<
size_t
>* 
Ïb–_±rs
 = 
nuÎ±r
;

43 
boŞ
 
š™
(
vid_t
 
vid
, 
DtS‹
& 
s
)

45 ià(
	gvid
 > 0)

46 
	gs
.
	gÏb–
 = 
¡d
::
¡ršg
((*è
Ïb–_d©a
->
d©a
(è+ (*
Ïb–_±rs
)[
vid
 - 1]);

47  
	gçl£
;

52 
şass
 
	gIDF
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, 
	gå_t
, 
	gDtS‹
>

54 
	gpublic
:

55 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = 
å_t
; usšg 
	gS
 = 
DtS‹
;

56 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

58 
boŞ
 
š™
(
vid_t
 
vid
, 
DtS‹
& 
s
)

59 {  
	gvid
 <ğ
BP
::
nd
; }

61 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
) {  M(); }

62 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
) {  1.0; }

63 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

64 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{ 
	gs
.
	gidf
 = 
log10
(
BP
::
nd
 / y);  
	gŒue
; }

69 
şass
 
	gTFIDF
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gå_t
, fp_t, 
	gDtS‹
>

71 
	gpublic
:

72 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
å_t
; usšg 
	gA
 = fp_t; usšg 
	gS
 = 
DtS‹
;

73 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

75 cÚ¡ 
	g¡d
::
unÜd”ed_£t
<
¡d
::
¡ršg
>* 
qu”y_‹rms
 = 
nuÎ±r
;

77 
boŞ
 
š™
(
vid_t
 
vid
, 
DtS‹
& 
s
)

79 
as£¹
(
qu”y_‹rms
);

80  
	gvid
 > 
	gBP
::
nd
 && 
qu”y_‹rms
->
couÁ
(
s
.
Ïb–
) > 0;

83 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
è{  
	gs
.
	gidf
; }

84 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
log10
(1 +ƒdge.
weight
è* 
	gmsg
; }

85 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

86 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{ 
	gs
.
	gscÜe
 = y;  
	gŒue
; }

91 
şass
 
	gDL
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gå_t
, fp_t, 
	gDtS‹
>

93 
	gpublic
:

94 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
å_t
; usšg 
	gA
 = fp_t; usšg 
	gS
 = 
DtS‹
;

95 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

97 
boŞ
 
š™
(
vid_t
 
vid
, 
DtS‹
& 
s
)

98 {  
	gvid
 > 
	gBP
::
nd
; }

100 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
è{  
	gs
.
	gidf
; }

101 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
log10
(1 +ƒdge.
weight
è* 
	gmsg
; }

102 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

103 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{ 
	gs
.
	gËngth
 = 
sq¹
(y);  
	gŒue
; }

108 
şass
 
	gQE
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, Em±y, 
	gDtS‹
>

110 
	gpublic
:

111 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = Em±y; usšg 
	gS
 = 
DtS‹
;

112 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

114 cÚ¡ 
	g¡d
::
£t
<
vid_t
>* 
docs
 = 
nuÎ±r
;

116 
boŞ
 
š™
(
vid_t
 
vid
, 
DtS‹
& 
s
)

118 
as£¹
(
docs
);

119  
	gvid
 <ğ
BP
::
nd
 && 
docs
->
couÁ
(
vid
) == 1;

122 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
) {  M(); }

123 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
) {  A(); }

124 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
) {}

125 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{  
	gŒue
; }

	@src/apps/information_retrieval/tfidf_batch.cpp

1 
	~<c¡dio
>

2 
	~<c¡dlib
>

3 
	~<£t
>

4 
	~"uts/di¡_tim”.h
"

5 
	~"tfidf_b©ch.h
"

8 
	g‹m¶©e
 <
boŞ
 
	g¿ndom_qu”y
>

9 
run
(
¡d
::
¡ršg
 
f•©h
, 
vid_t
 
num_docs
, vid_ˆ
num_‹rms
, 
ušt32_t
 
k
, ušt32_ˆ
r
,

10 
ušt32_t
 
num_qu”›s
, ušt32_ˆ
num_qu”y_‹rms
, 
¡d
::
£t
<
vid_t
> 
qu”y_‹rms
)

13 
G¿ph
<
ew_t
> 
G
;

14 
	gG
.
lßd_b¬t™e
(
Œue
, 
f•©h
, 
num_docs
, 
num_‹rms
, 
çl£
);

17 
IDF
 
bf1
(&
G
);

18 
Di¡Tim”
 
bf1_tim”
("BF Step 1: idf(t) for‡ll in C");

19 
	gbf1
.
execu‹
(1);

20 
	gbf1_tim”
.
¡İ
();

24 
DL
 
bf2
(
bf1
);

25 
Di¡Tim”
 
bf2_tim”
("BF Step 2:†ength(D) (for‡ll in D) for‡ll D");

26 
	gbf2
.
»£t_aùiv™y
();

27 
	gbf2
.
execu‹
(1);

28 
	gbf2_tim”
.
¡İ
();

31 
TFIDF
 
bf3
(
bf1
);

33 
	gtfidf_time
 = 0, 
	gbf_time
 = 0;

35 
	g¡d
::
£t
<
vid_t
> 
qu”›s
[
BATCH_SIZE
];

37 autØ
	gq
 = 0; q < 
	gnum_qu”›s
; q++)

40 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

42 ià(
	g¿ndom_qu”y
)

44 
	gqu”›s
[
b
].
ş—r
();

45 autØ
	gi
 = 0; i < 
	gnum_qu”y_‹rms
; i++)

46 
	gqu”›s
[
b
].
š£¹
((
¿nd
(è% 
BP
::
Á
è+ 1 + BP::
nd
);

49 
	gqu”›s
[
b
] = 
qu”y_‹rms
;

52 
Di¡Tim”
 
tfidf_tim”
("TFIDF");

53 
Di¡Tim”
 
bf_tim”
("TFIDF with Blind Feedback");

57 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

58 
	gbf3
.
	gqu”›s
[
b
] = &
qu”›s
[b];

59 
Di¡Tim”
 
bf3_tim”
("BF Step 3: score(D) (for‡ll in Q) for‡ll D where in D");

60 
	gbf3
.
»£t
();

61 
	gbf3
.
»£t_aùiv™y
();

71 
	gbf3
.
execu‹
(1);

72 
	gbf3_tim”
.
¡İ
();

76 
usšg
 
	giv_t
 = 
¡d
::
·œ
<
vid_t
, 
	gå_t
>;

77 
	g¡d
::
veùÜ
<
iv_t
> 
tİk
[
BATCH_SIZE
];

78 
Di¡Tim”
 
bf4_tim”
("BF Step 4:op-k docs for Q");

79 
	gbf3
.
	gbtİk
<
	gBATCH_SIZE
, 
	gvid_t
, 
	gå_t
>(
	gk
, 
	gtİk
,

80 [&](
vid_t
 
	gvid
, cÚ¡ 
	gDtS‹
& 
	gs
è-> 
	gå_t
*

81 {  
	gvid
 <ğ
BP
::
nd
 ? (
å_t
*è
s
.
scÜes
 : 
nuÎ±r
; },

82 [&](cÚ¡ 
	giv_t
& 
	ga
, cÚ¡ iv_t& 
	gb
è{ ‡.
	g£cÚd
 > b.second; },

83 
	gŒue
);

84 
	gbf4_tim”
.
¡İ
();

85 
	gtfidf_tim”
.
¡İ
();

86 ià(
	gnum_qu”›s
 <ğ2 
ªd
 
r
 == 0)

88 autØ
b
 = 0; 
	gb
 < 
	gBATCH_SIZE
; b++)

90 
	gLOG
.
šfo
("q-%u:İ-%d docs: \n", 
b
+1, 
k
);

91 autØ
	giv
 : 
tİk
[
b
])

92 
LOG
.
šfo
("idx %d: scÜ%là\n", 
iv
.
fœ¡
, iv.
£cÚd
);

159 
	gbf_tim”
.
¡İ
();

172 
	gtfidf_time
 +ğ
tfidf_tim”
.
»pÜt
(
çl£
);

173 
	gbf_time
 +ğ
bf_tim”
.
»pÜt
(
çl£
);

176 
	gLOG
.
šfo
("TFIDFput: %làqp \n", (
num_qu”›s
 * 
BATCH_SIZE
è/ 
tfidf_time
);

177 
	gLOG
.
šfo
("TFIDF w/ Blšd F“dbackput: %làqp \n", (
num_qu”›s
 * 
BATCH_SIZE
è/ 
bf_time
);

181 
	$maš
(
¬gc
, ** 
¬gv
)

183 
Env
::
	`š™
();

186 ià(
¬gc
 < 8)

188 
LOG
.
	`šfo
("Usage: %s <path> <num_docs> <num_terms> <k> <r (0:‚o blind feedback)> "

190 "[<‹rm_id>+ (nÚe: s–eù„ªdom”ms)] \n", 
¬gv
[0]);

191 
Env
::
	`ex™
(1);

195 
¡d
::
¡ršg
 
f•©h
 = 
¬gv
[1];

196 
BP
::
nd
 = (
vid_t
è
¡d
::
	`©Ş
(
¬gv
[2]);

197 
BP
::
Á
 = (
vid_t
è
¡d
::
	`©Ş
(
¬gv
[3]);

198 
ušt32_t
 
k
 = 
¡d
::
	`©oi
(
¬gv
[4]);

199 
ušt32_t
 
r
 = 
¡d
::
	`©oi
(
¬gv
[5]);

200 
ušt32_t
 
num_qu”›s
 = 
¡d
::
	`©oi
(
¬gv
[6]);

201 
ušt32_t
 
num_qu”y_‹rms
 = 
¡d
::
	`©oi
(
¬gv
[7]);

203 
¡d
::
£t
<
vid_t
> 
qu”y_‹rms
;

205 ià(
num_qu”y_‹rms
 == 0)

207 
	`as£¹
(
¬gc
 > 8);

208 autØ
i
 = 8; i < 
¬gc
; i++)

210 
ušt32_t
 
‹rm_id
 = (
vid_t
è
¡d
::
	`©Ş
(
¬gv
[
i
]);

211 
	`as£¹
(
‹rm_id
 <ğ
BP
::
Á
);

212 
qu”y_‹rms
.
	`š£¹
(
‹rm_id
 + 
BP
::
nd
);

214 
run
<
çl£
>(
f•©h
, 
BP
::
nd
, BP::
Á
, 
k
, 
r
, 
num_qu”›s
, 
num_qu”y_‹rms
, 
qu”y_‹rms
);

218 
	`¤ªd
(0);

219 
run
<
Œue
>(
f•©h
, 
BP
::
nd
, BP::
Á
, 
k
, 
r
, 
num_qu”›s
, 
num_qu”y_‹rms
, 
qu”y_‹rms
);

222 
Env
::
	`fš®ize
();

224 
	}
}

	@src/apps/information_retrieval/tfidf_batch.h

1 #iâdeà
TFIDF_BATCH_H


2 
	#TFIDF_BATCH_H


	)

4 
	~<ÿs£¹
>

5 
	~<c¡dšt
>

6 
	~<¡ršg
>

7 
	~<cm©h
>

8 
	~"¡ruùu»s/¡©ic_b™veùÜ.h
"

9 
	~"v´og¿m/v”‹x_´og¿m.h
"

12 
usšg
 
	gvid_t
 = 
ušt32_t
;

13 
usšg
 
	gew_t
 = 
ušt32_t
;

14 
usšg
 
	gå_t
 = ;

17 
	sBP
 { 
vid_t
 
	mnd
, 
	mÁ
; };

18 
vid_t
 
	gBP
::
nd
 = 0, BP::
Á
 = 0;

21 
cÚ¡ex´
 
ušt32_t
 
	gBATCH_SIZE
 = 32;

23 
usšg
 
	gBV
 = 
SticB™VeùÜ
<
BATCH_SIZE
>;

26 
	sDS‹
 { 
å_t
 
	mscÜes
[
BATCH_SIZE
] = {0.0}; fp_ˆ
	mËngth
 = 1.0; };

27 
	sTS‹
 { 
å_t
 
	midf
 = 0.0; };

30 
	gDtS‹
 : 
DS‹
, 
	gTS‹
, 
	gS‹


32 
BV
 
	gbv
;

34 
	g¡d
::
¡ršg
 
to_¡ršg
() const

36 
¡d
::
¡ršg
 
scÜes
 = "";

37 autØ
	gi
 = 0; i < 
	gBATCH_SIZE
; i++)

38 
	gscÜes
 +ğ
¡d
::
to_¡ršg
(
scÜes
[
i
]) + ", ";

39  "{doc: ([" + 
	gscÜes
 + "], " + 
	g¡d
::
to_¡ršg
(
Ëngth
) + "), "

40 + "{‹rm: (" + 
¡d
::
to_¡ršg
(
idf
) + ")}";

46 
şass
 
	gIDF
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gEm±y
, 
	gå_t
, 
	gDtS‹
>

48 
	gpublic
:

49 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
Em±y
; usšg 
	gA
 = 
å_t
; usšg 
	gS
 = 
DtS‹
;

50 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

52 
boŞ
 
š™
(
ušt32_t
 
vid
, 
DtS‹
& 
s
)

53 {  
	gvid
 <ğ
BP
::
nd
; }

55 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
) {  M(); }

56 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
) {  1.0; }

57 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

58 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{ 
	gs
.
	gidf
 = 
log10
(
BP
::
nd
 / y);  
	gŒue
; }

62 
	gBvMsg
 : 
Msg


64 
BV
 
bv
; 
å_t
 
	gv®ue
;

65 
BvMsg
() {}

66 
BvMsg
(cÚ¡ 
BV
& 
bv
, 
å_t
 
v®ue
) : bv(bv), value(value) {}

69 
	gBvAccum
 : 
Accum


71 
BV
 
bv
; 
å_t
 
	gv®ues
[
BATCH_SIZE
] = {0.0};

72 
BvAccum
() {}

73 
BvAccum
(cÚ¡ 
BV
& 
bv
, 
å_t
 
v®ue
) : bv(bv)

74 { 
¡d
::
fl
(
v®ues
, v®ue + 
BATCH_SIZE
, 
v®ue
); }

75 
	gBvAccum
& 
	gİ”©Ü
+=(cÚ¡ 
BvAccum
& 
Ùh”
)

77 
bv
 +ğ
Ùh”
.bv;

78 autØ
	gi
 = 0; i < 
	gBATCH_SIZE
; i++)

79 ià(
	gÙh”
.
	gbv
.
‹¡
(
i
))

80 
	gv®ues
[
i
] +ğ
Ùh”
.
v®ues
[i];

81  *
	gthis
;

87 
şass
 
	gTFIDF
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gBvMsg
, 
	gBvAccum
, 
	gDtS‹
>

89 
	gpublic
:

90 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
BvMsg
; usšg 
	gA
 = 
BvAccum
; usšg 
	gS
 = 
DtS‹
;

91 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

93 cÚ¡ 
	g¡d
::
£t
<
ušt32_t
>* 
qu”›s
[
BATCH_SIZE
] = {
nuÎ±r
};

95 
boŞ
 
š™
(
ušt32_t
 
vid
, 
DtS‹
& 
s
)

97 ià(
	gvid
 > 
	gBP
::
nd
)

99 
s
.
bv
.
un£t_®l
();

100 autØ
	gi
 = 0; i < 
	gBATCH_SIZE
; i++)

101 ià(
	gqu”›s
[
i
]->
couÁ
(
vid
) == 1)

102 
s
.
bv
.
£t
(
i
);

103  
	gs
.
	gbv
.
couÁ
() > 0;

105  
	gçl£
;

108 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
è{  M(s.
bv
, s.
idf
); }

109 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
)

111  
A
(
msg
.
bv
, 
log10
(1 + 
edge
.
weight
è* msg.
v®ue
);

113 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

114 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
)

116 
	gs
.
	gbv
 = 
y
.
bv
;

117 autØ
	gi
 = 0; i < 
	gBATCH_SIZE
; i++)

118 ià(
	gy
.
	gbv
.
‹¡
(
i
))

119 
	gs
.
	gscÜes
[
i
] = 
y
.
v®ues
[i] / 
s
.
Ëngth
;

120  
	gŒue
;

126 
şass
 
	gDL
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gå_t
, fp_t, 
	gDtS‹
>

128 
	gpublic
:

129 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
å_t
; usšg 
	gA
 = fp_t; usšg 
	gS
 = 
DtS‹
;

130 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

132 
boŞ
 
š™
(
ušt32_t
 
vid
, 
DtS‹
& 
s
)

133 {  
	gvid
 > 
	gBP
::
nd
; }

135 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
è{  
	gs
.
	gidf
; }

136 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
log10
(1 +ƒdge.
weight
è* 
	gmsg
; }

137 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

138 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{ 
	gs
.
	gËngth
 = 
sq¹
(y);  
	gŒue
; }

143 
şass
 
	gQE
 : 
public
 
V”‹xProg¿m
<
ew_t
, 
	gBV
, BV, 
	gDtS‹
>

145 
	gpublic
:

146 
usšg
 
W
 = 
ew_t
; usšg 
	gM
 = 
BV
; usšg 
	gA
 = BV; usšg 
	gS
 = 
DtS‹
;

147 
usšg
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
;

149 cÚ¡ 
	g¡d
::
£t
<
ušt32_t
>* 
docs
[
BATCH_SIZE
] = {
nuÎ±r
};

151 
boŞ
 
š™
(
ušt32_t
 
vid
, 
DtS‹
& 
s
)

153 ià(
	gvid
 <ğ
BP
::
nd
)

155 
s
.
bv
.
un£t_®l
();

156 autØ
	gi
 = 0; i < 
	gBATCH_SIZE
; i++)

157 ià(
	gdocs
[
i
]->
couÁ
(
vid
) == 1)

158 
s
.
bv
.
£t
(
i
);

159  
	gs
.
	gbv
.
couÁ
() > 0;

161  
	gçl£
;

164 
M
 
sÿ‰”
(cÚ¡ 
DtS‹
& 
s
è{  
	gs
.
	gbv
; }

165 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
è{  
	gmsg
; }

166 
combše
(cÚ¡ 
A
& 
y1
, A& 
y2
è{ 
	gy2
 += y1; }

167 
boŞ
 
­¶y
(cÚ¡ 
A
& 
y
, 
DtS‹
& 
s
è{ 
	gs
.
	gbv
 = y;  
	gŒue
; }

	@src/matrix/annotated_matrix2d.h

1 #iâdeà
ANNOTATED_MATRIX_H


2 
	#ANNOTATED_MATRIX_H


	)

4 
	~<£t
>

5 
	~"m©rix/di¡_m©rix2d.h
"

6 
	~"uts/rowg½.h
"

7 
	~"uts/cŞg½.h
"

8 
	~"uts/dashbßrd.h
"

25 
	g‹m¶©e
 <
şass
 
	gWeight
>

26 
	sBasicAÂÙ©iÚ


28 
usšg
 
	mTe
 = 
AÂÙ©edTe2D
<
Weight
>;

29 
usšg
 
	mRowG½
 = 
AÂÙ©edRowG½
<
Te
>;

30 
usšg
 
	mCŞG½
 = 
AÂÙ©edCŞG½
<
Te
>;

31 
usšg
 
	mDashbßrd
 = 
AÂÙ©edDashbßrd
<
RowG½
, 
	mCŞG½
>;

35 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
 = 
BasicAÂÙ©iÚ
<
Weight
>>

36 
şass
 
AÂÙ©edM©rix2D
 : 
public
 
Di¡M©rix2D
<
Weight
, 
ty³Çme
 
	gAÂÙ©iÚ
::
Te
>

38 
ä›nd
 
AÂÙ©edM©rix2D_Te¡
;

40 
	gpublic
:

41 
AÂÙ©edM©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
);

43 
	gpublic
:

45 
usšg
 
Te
 = 
ty³Çme
 
AÂÙ©iÚ
::Tile;

46 
usšg
 
	gRowG½
 = 
ty³Çme
 
AÂÙ©iÚ
::
RowG½
;

47 
usšg
 
	gCŞG½
 = 
ty³Çme
 
AÂÙ©iÚ
::
CŞG½
;

48 
usšg
 
	gDashbßrd
 = 
ty³Çme
 
AÂÙ©iÚ
::
Dashbßrd
;

51 
usšg
 
	gBa£
 = 
Di¡M©rix2D
<
Weight
, 
	gTe
>;

52 
usšg
 
	gBa£
::
Äowg½s
;

53 
usšg
 
	gBa£
::
ncŞg½s
;

54 
usšg
 
	gBa£
::
¿nk
;

55 
usšg
 
	gBa£
::
¿nk_Áes
;

56 
usšg
 
	gBa£
::
¿nk_Äowg½s
;

57 
usšg
 
	gBa£
::
¿nk_ncŞg½s
;

58 
usšg
 
	gBa£
::
tes
;

59 
usšg
 
	gBa£
::
te_height
;

60 
usšg
 
	gBa£
::
te_width
;

62 
	gpublic
:

64 
¡d
::
veùÜ
<
Te
*> 
loÿl_tes
;

67 
	g¡d
::
veùÜ
<
RowG½
> 
loÿl_rowg½s
;

69 
	g¡d
::
veùÜ
<
RowG½
*> 
glob®_rowg½s
;

72 
	g¡d
::
veùÜ
<
CŞG½
> 
loÿl_cŞg½s
;

74 
	g¡d
::
veùÜ
<
CŞG½
*> 
glob®_cŞg½s
;

77 
ušt32_t
 
	gndashbßrds
;

79 
	gFixedVeùÜ
<
	gDashbßrd
> 
	gdashbßrds
;

81 
	g´Ùeùed
:

83 
št32_t
 
owÃr_of_£gm’t
(
ušt32_t
 
id
);

85 
	g´iv©e
:

86 
š™_rowg½s
(
¡d
::
£t
<
ušt32_t
>& 
loÿl_rowg½_šdiûs
);

88 
š™_cŞg½s
(
¡d
::
£t
<
ušt32_t
>& 
loÿl_cŞg½_šdiûs
);

90 
š™_dashbßrds
();

95 
	~"ªnÙ©ed_m©rix2d.hµ
"

	@src/matrix/annotated_matrix2d.hpp

1 
	~<£t
>

2 
	~<®gÜ™hm
>

3 
	~<num”ic
>

4 
	~<ÿs£¹
>

5 
	~<cm©h
>

8 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

9 
	gAÂÙ©edM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$AÂÙ©edM©rix2D
(

10 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
)

11 : 
	$Ba£
(
Äows
, 
ncŞs
, 
Áes
, 
·¹™iÚšg
)

14 
¡d
::
£t
<
ušt32_t
> 
loÿl_rowg½_šdiûs
;

15 
¡d
::
£t
<
ušt32_t
> 
loÿl_cŞg½_šdiûs
;

17 auto& 
teg½
 : 
tes
)

19 auto& 
te
 : 
teg½
)

21 ià(
te
.
¿nk
 ==„ank)

23 
loÿl_rowg½_šdiûs
.
	`š£¹
(
te
.
rg
);

24 
loÿl_cŞg½_šdiûs
.
	`š£¹
(
te
.
cg
);

30 
	`š™_rowg½s
(
loÿl_rowg½_šdiûs
);

31 
	`š™_cŞg½s
(
loÿl_cŞg½_šdiûs
);

35 
loÿl_tes
.
	`»£rve
(
¿nk_Áes
);

36 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

38 auto& 
te
 : 
cŞg½
.
loÿl_tes
)

40 
loÿl_tes
.
	`push_back
(
te
);

45 
	`š™_dashbßrds
();

48 
	}
}

50 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

51 
	gAÂÙ©edM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
š™_rowg½s
(
¡d
::
£t
<
ušt32_t
>& 
loÿl_rowg½_šdiûs
)

53 
glob®_rowg½s
.
»size
(
Äowg½s
);

54 
	gloÿl_rowg½s
.
»£rve
(
loÿl_rowg½_šdiûs
.
size
());

56 
ušt32_t
 
	gi
 = 0;

57 auto& 
	grg
 : 
loÿl_rowg½_šdiûs
)

60 
loÿl_rowg½s
.
em¶aû_back
();

61 
	gRowG½
& 
	growg½
 = 
loÿl_rowg½s
.
back
();

62 
	gglob®_rowg½s
[
rg
] = &
rowg½
;

66 
	growg½
.
	grg
 = 
rg
;

67 
	growg½
.
	g™h
 = 
i
++;

68 
	growg½
.
	goff£t
 = 
rg
 * 
te_height
;

69 
	growg½
.
	g’dpos
 = 
rowg½
.
off£t
 + 
te_height
;

70 
	growg½
.
	gËad”
 = 
owÃr_of_£gm’t
(
rg
);

73 
	growg½
.
	gloÿl_tes
.
»£rve
(
¿nk_ncŞg½s
);

74 
ušt32_t
 
	gcg
 = 0; cg < 
	gncŞg½s
; cg++)

76 auto& 
	gte
 = 
tes
[
rg
][
cg
];

77 ià(
	gte
.
	g¿nk
 =ğ
¿nk
)

78 
rowg½
.
loÿl_tes
.
push_back
(&
te
);

85 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

86 
	gAÂÙ©edM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
š™_cŞg½s
(
¡d
::
£t
<
ušt32_t
>& 
loÿl_cŞg½_šdiûs
)

88 
glob®_cŞg½s
.
»size
(
ncŞg½s
);

89 
	gloÿl_cŞg½s
.
»£rve
(
loÿl_cŞg½_šdiûs
.
size
());

91 
ušt32_t
 
	gj
 = 0;

92 auto& 
	gcg
 : 
loÿl_cŞg½_šdiûs
)

95 
loÿl_cŞg½s
.
em¶aû_back
();

96 
	gCŞG½
& 
	gcŞg½
 = 
loÿl_cŞg½s
.
back
();

97 
	gglob®_cŞg½s
[
cg
] = &
cŞg½
;

101 
	gcŞg½
.
	gcg
 = 
cg
;

102 
	gcŞg½
.
	gjth
 = 
j
++;

103 
	gcŞg½
.
	goff£t
 = 
cg
 * 
te_width
;

104 
	gcŞg½
.
	g’dpos
 = 
cŞg½
.
off£t
 + 
te_height
;

105 
	gcŞg½
.
	gËad”
 = 
owÃr_of_£gm’t
(
cg
);

108 
	gcŞg½
.
	gloÿl_tes
.
»£rve
(
¿nk_Äowg½s
);

109 
ušt32_t
 
	grg
 = 0;„g < 
	gÄowg½s
;„g++)

111 auto& 
	gte
 = 
tes
[
rg
][
cg
];

112 ià(
	gte
.
	g¿nk
 =ğ
¿nk
)

113 
cŞg½
.
loÿl_tes
.
push_back
(&
te
);

120 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

121 
	gAÂÙ©edM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$š™_dashbßrds
()

124 
ndashbßrds
 = 0;

125 
ušt32_t
 
rg
 = 0;„g < 
Äowg½s
;„g++)

126 
ndashbßrds
 +ğ(
	`owÃr_of_£gm’t
(
rg
è=ğ
¿nk
);

130 
dashbßrds
.
	`»£rve
(
ndashbßrds
);

133 
ušt32_t
 
k
 = 0;

134 
ušt32_t
 
rg
 = 0;„g < 
Äowg½s
;„g++)

136 ià(
	`owÃr_of_£gm’t
(
rg
è=ğ
¿nk
)

138 
dashbßrds
.
	`em¶aû_back
();

139 
Dashbßrd
& 
db
 = 
dashbßrds
.
	`back
();

141 
db
.
kth
 = 
k
++;

142 
db
.
rg
 = db.
cg
 =„g;

143 
db
.
rowg½
 = 
glob®_rowg½s
[db.
rg
];

144 
db
.
cŞg½
 = 
glob®_cŞg½s
[db.
cg
];

146 ià(
db
.
rowg½
)

147 
db
.
rowg½
->
kth
 = db.kth;

148 ià(
db
.
cŞg½
)

149 
db
.
cŞg½
->
kth
 = db.kth;

151 
	`as£¹
(
db
.
rowg½
);

152 
	`as£¹
(
db
.
cŞg½
);

157 auto& 
db
 : 
dashbßrds
)

159 
¡d
::
£t
<
št32_t
> 
unique_fŞlow”s
;

160 
ušt32_t
 
cg
 = 0; cg < 
ncŞg½s
; cg++)

162 
Te
& 
te
 = 
tes
[
db
.
rg
][
cg
];

163 ià(
te
.
¿nk
 !=„ank)

164 
unique_fŞlow”s
.
	`š£¹
(
te
.
¿nk
);

167 
db
.
rowg½_fŞlow”s
.
	`assign
(
unique_fŞlow”s
.
	`begš
(), unique_fŞlow”s.
	`’d
());

168 
¡d
::
	`¿ndom_shufæe
(
db
.
rowg½_fŞlow”s
.
	`begš
(), db.rowg½_fŞlow”s.
	`’d
());

172 auto& 
db
 : 
dashbßrds
)

174 
¡d
::
£t
<
št32_t
> 
unique_fŞlow”s
;

175 
ušt32_t
 
rg
 = 0;„g < 
Äowg½s
;„g++)

177 
Te
& 
te
 = 
tes
[
rg
][
db
.
cg
];

178 ià(
te
.
¿nk
 !=„ank)

179 
unique_fŞlow”s
.
	`š£¹
(
te
.
¿nk
);

182 
db
.
cŞg½_fŞlow”s
.
	`assign
(
unique_fŞlow”s
.
	`begš
(), unique_fŞlow”s.
	`’d
());

183 
¡d
::
	`¿ndom_shufæe
(
db
.
cŞg½_fŞlow”s
.
	`begš
(), db.cŞg½_fŞlow”s.
	`’d
());

187 
	}
}

189 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

190 
št32_t
 
	gAÂÙ©edM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$owÃr_of_£gm’t
(
ušt32_t
 
id
)

197  
tes
[
id
][id].
¿nk
;

201 
	}
}

	@src/matrix/csc_matrix2d.h

1 #iâdeà
CSC_MATRIX_H


2 
	#CSC_MATRIX_H


	)

4 
	~"m©rix/´oûs£d_m©rix2d.h
"

5 
	~"uts/csc.h
"

16 
	g‹m¶©e
 <
şass
 
	gWeight
>

17 
	gCSCAÂÙ©iÚ
 : 
Proûs£dAÂÙ©iÚ
<
Weight
>

19 
usšg
 
Te
 = 
CSCTe2D
<
Weight
>;

20 
usšg
 
	gRowG½
 = 
CSCRowG½
<
Te
>;

21 
usšg
 
	gCŞG½
 = 
CSCCŞG½
<
Te
>;

22 
usšg
 
	gDashbßrd
 = 
CSCDashbßrd
<
RowG½
, 
	gCŞG½
>;

26 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
 = 
CSCAÂÙ©iÚ
<
Weight
>>

27 
şass
 
CSCM©rix2D
 : 
public
 
Proûs£dM©rix2D
<
Weight
, 
	gAÂÙ©iÚ
>

29 
	gpublic
:

30 
CSCM©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
);

32 ~
CSCM©rix2D
();

34 
di¡ribu‹
();

36 
	gpublic
:

38 
usšg
 
Ba£
 = 
Proûs£dM©rix2D
<
Weight
, 
	gAÂÙ©iÚ
>;

39 
usšg
 
	gBa£
::
loÿl_cŞg½s
;

40 
usšg
 
	gBa£
::
loÿl_rowg½s
;

41 
usšg
 
	gBa£
::
loÿl_tes
;

42 
usšg
 
	gBa£
::
¿nk_Áes
;

47 
	~"csc_m©rix2d.hµ
"

	@src/matrix/csc_matrix2d.hpp

1 
	~<unÜd”ed_£t
>

4 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

5 
	gCSCM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$CSCM©rix2D
(

6 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
)

7 : 
	$Ba£
(
Äows
, 
ncŞs
, 
Áes
, 
·¹™iÚšg
è{
	}
}

9 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

10 
	gCSCM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::~
	$CSCM©rix2D
()

12 auto& 
te
 : 
loÿl_tes
)

14 
d–‘e
 
te
->
csc
;

15 
d–‘e
 
te
->
sšk_csc
;

17 
	}
}

19 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

20 
	gCSCM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$di¡ribu‹
()

22 
Ba£
::
	`di¡ribu‹
();

24 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

26 ià(
cŞg½
.
Ëad”
 =ğ
Env
::
¿nk
)

27 
LOG
.
šfo
<
çl£
, false>("|");

29 #´agm¨
omp
 
·¿Î–
 
	`scheduË
(, 1)

30 
ušt32_t
 
j
 = 0; j < 
cŞg½
.
loÿl_tes
.
	`size
(); j++)

32 auto& 
te
 = 
cŞg½
.
loÿl_tes
[
j
];

34 auto& 
rowg½
 = 
loÿl_rowg½s
[
te
->
™h
];

36 cÚ¡‡uto& 
loÿtÜ
 = *
rowg½
.locator;

37 cÚ¡‡utØ
bound
 = 
loÿtÜ
.
	`ÄeguÏr
();

38 
	`as£¹
(
loÿtÜ
.
	`ÄeguÏr
(è=ğ
rowg½
.
»guÏr
->
	`couÁ
());

62 autØ
»guÏr
 = 
Ãw
 
¡d
::
unÜd”ed_£t
<
TrË
<
Weight
>, 
EdgeHash
>();

63 autØ
sšk
 = 
Ãw
 
¡d
::
unÜd”ed_£t
<
TrË
<
Weight
>, 
EdgeHash
>();

65 auto& 
ŒË
 : *(
te
->
ŒËs
))

67 
ŒË
.
row
 -ğ
rowg½
.
off£t
;

68 ià(
loÿtÜ
[
ŒË
.
row
] < 
bound
)

69 
»guÏr
->
	`š£¹
(
ŒË
);

71 
sšk
->
	`š£¹
(
ŒË
);

74 
te
->
	`ä“_ŒËs
();

76 
te
->
csc
 = 
Ãw
 
CSC
<
Weight
>(
cŞg½
.
loÿl
->
	`couÁ
(), 
rowg½
.
off£t
, cŞg½.off£t, 
»guÏr
,

77 
loÿtÜ
, *
cŞg½
.loÿtÜ, *
rowg½
.
glob®_loÿtÜ
);

79 
te
->
sšk_csc
 = 
Ãw
 
CSC
<
Weight
>(
cŞg½
.
loÿl
->
	`couÁ
(), 
rowg½
.
off£t
, cŞg½.off£t, 
sšk
,

80 
loÿtÜ
, *
cŞg½
.loÿtÜ, *
rowg½
.
glob®_loÿtÜ
);

82 
d–‘e
 
»guÏr
;

83 
d–‘e
 
sšk
;

87 
Env
::
	`b¬r›r
();

88 
LOG
.
šfo
<
Œue
, 
çl£
>("\n");

89 
	}
}

	@src/matrix/dist_matrix2d.h

1 #iâdeà
DIST_MATRIX2D_H


2 
	#DIST_MATRIX2D_H


	)

4 
	~"m©rix/m©rix2d.h
"

14 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
 = 
Di¡Te2D
<
Weight
>>

15 
şass
 
Di¡M©rix2D
 : 
public
 
M©rix2D
<
Weight
, 
	gTe
>

17 
ä›nd
 
	gDi¡M©rix2D_Te¡
;

19 
	gpublic
:

24 
Di¡M©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
);

26 ~
Di¡M©rix2D
();

32 
di¡ribu‹
();

34 
	g´Ùeùed
:

36 
ušt32_t
 
Äªks
, 
	g¿nk
;

38 
ušt32_t
 
	g¿nk_Áes
, 
	g¿nk_Äowg½s
, 
	g¿nk_ncŞg½s
;

41 
ušt32_t
 
	growg½_Äªks
, 
	gcŞg½_Äªks
;

44 
usšg
 
	gBa£
 = 
M©rix2D
<
Weight
, 
	gTe
>;

45 
usšg
 
	gBa£
::
Äowg½s
;

46 
usšg
 
	gBa£
::
ncŞg½s
;

47 
usšg
 
	gBa£
::
tes
;

49 
	g´Ùeùed
:

51 
assign_tes
();

54 
š‹g”_çùÜize
(
ušt32_t
 
n
, ušt32_t& 
a
, ušt32_t& 
b
);

57 
´št_šfo
();

59 
	g´iv©e
:

61 
MPI_D©©y³
 
MANY_TRIPLES
;

63 cÚ¡ 
ušt32_t
 
	gmªy_ŒËs_size
 = 1;

69 
	~"di¡_m©rix2d.hµ
"

	@src/matrix/dist_matrix2d.hpp

1 
	~<®gÜ™hm
>

2 
	~<num”ic
>

3 
	~<ÿs£¹
>

4 
	~<şim™s
>

5 
	~<cm©h
>

6 
	~<mpi.h
>

7 
	~"uts/’v.h
"

8 
	~"¡ruùu»s/b™veùÜ.h
"

9 
	~"m©rix/g¿ph.h
"

12 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

13 
	gDi¡M©rix2D
<
	gWeight
, 
	gTe
>::
	$Di¡M©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
,

14 
P¬t™iÚšg
 
·¹™iÚšg
)

15 : 
	`Ba£
(
Äows
, 
ncŞs
, 
Áes
, 
·¹™iÚšg
),

16 
	`Äªks
(
Env
::
Äªks
), 
	`¿nk
(Env::
¿nk
), 
	`¿nk_Áes
(
Áes
 /‚ranks)

19 
	`as£¹
(
¿nk_Áes
 * 
Äªks
 =ğ
Áes
);

21 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_COL
)

24 
rowg½_Äªks
 = 
Äªks
;

25 
cŞg½_Äªks
 = 1;

26 
	`as£¹
(
rowg½_Äªks
 * 
cŞg½_Äªks
 =ğ
Äªks
);

28 
¿nk_Äowg½s
 = 
Äowg½s
;

29 
¿nk_ncŞg½s
 = 1;

30 
	`as£¹
(
¿nk_Äowg½s
 * 
¿nk_ncŞg½s
 =ğ
¿nk_Áes
);

32 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_ROW
)

34 
LOG
.
	`çl
("1D_ROW…artitioning Not implemented! \n");

36 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_2D
)

39 
	`š‹g”_çùÜize
(
Äªks
, 
rowg½_Äªks
, 
cŞg½_Äªks
);

40 
	`as£¹
(
rowg½_Äªks
 * 
cŞg½_Äªks
 =ğ
Äªks
);

42 
¿nk_Äowg½s
 = 
Äowg½s
 / 
cŞg½_Äªks
;

43 
¿nk_ncŞg½s
 = 
ncŞg½s
 / 
rowg½_Äªks
;

44 
	`as£¹
(
¿nk_Äowg½s
 * 
¿nk_ncŞg½s
 =ğ
¿nk_Áes
);

48 
	`MPI_Ty³_cÚtiguous
(
mªy_ŒËs_size
 * (
TrË
<
Weight
>), 
MPI_BYTE
, &
MANY_TRIPLES
);

49 
	`MPI_Ty³_comm™
(&
MANY_TRIPLES
);

51 
	`assign_tes
();

57 
B™VeùÜ
 
	`bv
(
Äªks
);

59 
ušt32_t
 
rg
 = 0;„g < 
Äowg½s
;„g++)

61 ià(
bv
.
	`couÁ
(è=ğbv.
	`size
())

62 
bv
.
	`ş—r
();

64 
ušt32_t
 
rg_
 = 
rg
;„g_ < 
Äowg½s
;„g_++)

66 ià(
nÙ
 
bv
.
	`touch
(
tes
[
rg_
][
rg
].
¿nk
))

68 
usšg
 
¡d
::
sw­
;

69 
	`sw­
(
tes
[
rg_
],es[
rg
]);

75 
ušt32_t
 
rg
 = 0;„g < 
Äowg½s
;„g++)

77 
ušt32_t
 
cg
 = 0; cg < 
ncŞg½s
; cg++)

79 auto& 
te
 = 
tes
[
rg
][
cg
];

80 
te
.
rg
 =„g;

81 
te
.
cg
 = cg;

85 
	`´št_šfo
();

86 
	}
}

88 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

89 
	gDi¡M©rix2D
<
	gWeight
, 
	gTe
>::~
	$Di¡M©rix2D
()

92 autØ
»tv®
 = 
	`MPI_Ty³_ä“
(&
MANY_TRIPLES
);

93 
	`as£¹
(
»tv®
 =ğ
MPI_SUCCESS
);

94 
	}
}

96 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

97 
	gDi¡M©rix2D
<
	gWeight
, 
	gTe
>::
	$assign_tes
()

99 
ušt32_t
 
rg
 = 0;„g < 
Äowg½s
;„g++)

101 
ušt32_t
 
cg
 = 0; cg < 
ncŞg½s
; cg++)

103 auto& 
te
 = 
tes
[
rg
][
cg
];

104 
te
.
rg
 =„g;

105 
te
.
cg
 = cg;

107 ià(
this
->
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_COL
)

109 
te
.
¿nk
 = 
cg
;

110 
te
.
™h
 = 
rg
 / 
cŞg½_Äªks
;

111 
te
.
jth
 = 
cg
 / 
rowg½_Äªks
;

113 ià(
this
->
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_ROW
)

115 
LOG
.
	`çl
("1D_ROW…artitioning Not implemented! \n");

117 ià(
this
->
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_2D
)

119 
te
.
¿nk
 = (
cg
 % 
rowg½_Äªks
è* 
cŞg½_Äªks
 + (
rg
 % colgrp_nranks);

120 
te
.
™h
 = 
rg
 / 
cŞg½_Äªks
;

121 
te
.
jth
 = 
cg
 / 
rowg½_Äªks
;

124 
te
.
Áh
 =e.
™h
 * 
¿nk_ncŞg½s
 +e.
jth
;

127 
	}
}

129 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

130 
	gDi¡M©rix2D
<
	gWeight
, 
	gTe
>::
	$š‹g”_çùÜize
(
ušt32_t
 
n
, ušt32_t& 
a
, ušt32_t& 
b
)

133 
a
 = 
b
 = 
	`sq¹
(
n
);

134 
a
 * 
b
 !ğ
n
)

136 
b
++;

137 
a
 = 
n
 / 
b
;

139 
	`as£¹
(
a
 * 
b
 =ğ
n
);

140 
	}
}

142 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

143 
	gDi¡M©rix2D
<
	gWeight
, 
	gTe
>::
	$´št_šfo
()

146 
LOG
.
	`šfo
("#> Assignedheilesohe %u„anks.\n"

149 "#> Each cŞgrou°i divided‡mÚg %u„ªks.\n", 
Äªks
, 
¿nk_Áes
, 
¿nk_Äowg½s
,

150 
¿nk_ncŞg½s
, 
rowg½_Äªks
, 
cŞg½_Äªks
);

153 
ušt32_t
 
rg
 = 0;„g < 
¡d
::
	`mš
(
Äowg½s
, 10u);„g++)

155 
ušt32_t
 
cg
 = 0; cg < 
¡d
::
	`mš
(
ncŞg½s
, 10u); cg++)

157 
LOG
.
šfo
<
Œue
, 
çl£
>("%02d ", 
tes
[
rg
][
cg
].
¿nk
);

161 ià(
ncŞg½s
 > 10u)

162 
LOG
.
šfo
<
Œue
, 
çl£
>(" ...");

163 
LOG
.
šfo
<
Œue
, 
çl£
>("\n");

166 ià(
Äowg½s
 > 10u)

167 
LOG
.
šfo
<
Œue
, 
çl£
>(" ...\n");

168 
	}
}

170 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

171 
	gDi¡M©rix2D
<
	gWeight
, 
	gTe
>::
	$di¡ribu‹
()

173 
¡d
::
veùÜ
<¡d::veùÜ<
TrË
<
Weight
>>> 
	`outboxes
(
Äªks
);

174 
¡d
::
veùÜ
<¡d::veùÜ<
TrË
<
Weight
>>> 
	`šboxes
(
Äªks
);

175 
¡d
::
veùÜ
<
ušt32_t
> 
	`šbox_sizes
(
Äªks
);

178 auto& 
teg½
 : 
tes
)

180 auto& 
te
 : 
teg½
)

182 ià(
te
.
¿nk
 ==„ank)

185 auto& 
outbox
 = 
outboxes
[
te
.
¿nk
];

186 
outbox
.
	`š£¹
(outbox.
	`’d
(), 
te
.
ŒËs
->
	`begš
(),ile.triples->end());

187 
te
.
	`ä“_ŒËs
();

188 
te
.
	`®loÿ‹_ŒËs
();

192 
ušt32_t
 
r
 = 0;„ < 
Äªks
;„++)

194 ià(
r
 =ğ
¿nk
)

197 auto& 
outbox
 = 
outboxes
[
r
];

198 
ušt32_t
 
outbox_size
 = 
outbox
.
	`size
();

199 
	`MPI_S’d»cv
(&
outbox_size
, 1, 
MPI_UNSIGNED
, 
r
, 0, &
šbox_sizes
[r], 1, MPI_UNSIGNED,„, 0,

200 
Env
::
MPI_WORLD
, 
MPI_STATUS_IGNORE
);

203 
¡d
::
veùÜ
<
MPI_Reque¡
> 
ouŒeqs
;

204 
¡d
::
veùÜ
<
MPI_Reque¡
> 
š»qs
;

205 
MPI_Reque¡
 
»que¡
;

207 
ušt32_t
 
i
 = 0; i < 
Äªks
; i++)

209 
ušt32_t
 
r
 = (
¿nk
 + 
i
è% 
Äªks
;

210 ià(
r
 =ğ
¿nk
)

213 auto& 
šbox
 = 
šboxes
[
r
];

214 
ušt32_t
 
šbox_bound
 = 
šbox_sizes
[
r
] + 
mªy_ŒËs_size
;

215 
šbox
.
	`»size
(
šbox_bound
);

218 
	`MPI_I»cv
(
šbox
.
	`d©a
(), 
šbox_bound
 / 
mªy_ŒËs_size
, 
MANY_TRIPLES
, 
r
, 1, 
Env
::
MPI_WORLD
,

219 &
»que¡
);

220 
š»qs
.
	`push_back
(
»que¡
);

223 
ušt32_t
 
i
 = 0; i < 
Äªks
; i++)

225 
ušt32_t
 
r
 = (
¿nk
 + 
i
è% 
Äªks
;

226 ià(
r
 =ğ
¿nk
)

229 auto& 
outbox
 = 
outboxes
[
r
];

230 
ušt32_t
 
outbox_bound
 = 
outbox
.
	`size
(è+ 
mªy_ŒËs_size
;

231 
outbox
.
	`»size
(
outbox_bound
);

234 
	`MPI_I£nd
(
outbox
.
	`d©a
(), 
outbox_bound
 / 
mªy_ŒËs_size
, 
MANY_TRIPLES
, 
r
, 1, 
Env
::
MPI_WORLD
,

235 &
»que¡
);

237 
ouŒeqs
.
	`push_back
(
»que¡
);

240 
	`MPI_Wa™®l
(
š»qs
.
	`size
(), iÄeqs.
	`d©a
(), 
MPI_STATUSES_IGNORE
);

242 
ušt32_t
 
r
 = 0;„ < 
Äªks
;„++)

244 ià(
r
 =ğ
¿nk
)

247 auto& 
šbox
 = 
šboxes
[
r
];

248 
ušt32_t
 
i
 = 0; i < 
šbox_sizes
[
r
]; i++)

249 
Ba£
::
	`š£¹
(
šbox
[
i
]);

251 
šbox
.
	`ş—r
();

252 
šbox
.
	`shršk_to_f™
();

255 
LOG
.
šfo
<
çl£
, false>("|");

257 
	`MPI_Wa™®l
(
ouŒeqs
.
	`size
(), ouŒeqs.
	`d©a
(), 
MPI_STATUSES_IGNORE
);

258 
	`MPI_B¬r›r
(
Env
::
MPI_WORLD
);

259 
LOG
.
šfo
<
Œue
, 
çl£
>("\n");

261 
	}
}

	@src/matrix/graph.h

1 #iâdeà
GRAPH_HPP


2 
	#GRAPH_HPP


	)

4 
	~"uts/commÚ.h
"

5 
	~"m©rix/csc_m©rix2d.h
"

6 
	~"m©rix/hash”s.h
"

10 
	eHashšg


12 
	mNONE
,

13 
	mBUCKET
,

14 
MODULO


22 
	g‹m¶©e
 <
şass
 
	gWeight
>

23 şas 
	cG¿ph


25 
	mpublic
:

27 
usšg
 
M©rix
 = 
CSCM©rix2D
<
Weight
>;

31 
G¿ph
();

33 ~
G¿ph
();

38 
lßd_dœeùed
(
boŞ
 
bš¬y
, 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
nv”tiûs_
 = 0,

39 
boŞ
 
»v”£_edges
 = 
çl£
, boŞ 
»move_cyşes
 = false,

40 
Hashšg
 
hashšg_
 = Hashšg::
BUCKET
,

41 
P¬t™iÚšg
 
·¹™iÚšg_
 = P¬t™iÚšg::
_2D
);

43 
lßd_undœeùed
(
boŞ
 
bš¬y
, 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
nv”tiûs_
 = 0,

44 
Hashšg
 
hashšg_
 = Hashšg::
BUCKET
,

45 
P¬t™iÚšg
 
·¹™iÚšg_
 = P¬t™iÚšg::
_2D
);

47 
lßd_b¬t™e
(
boŞ
 
bš¬y
, 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
nv”tiûs_
, ušt32_ˆ
mv”tiûs_
,

48 
boŞ
 
dœeùed
 = 
Œue
, boŞ 
»v”£_edges
 = 
çl£
,

49 
Hashšg
 
hashšg_
 = Hashšg::
NONE
,

50 
P¬t™iÚšg
 
·¹™iÚšg_
 = P¬t™iÚšg::
_2D
);

52 
lßd_Ïb–s
(
¡d
::
¡ršg
& 
f•©h_
);

57 
ä“
();

60 
	m´iv©e
:

64 
¡d
::
¡ršg
 
f•©h
;

66 
ušt32_t
 
	mnv”tiûs
;

68 
ušt32_t
 
	mmv”tiûs
;

70 
ušt64_t
 
	mÃdges
;

72 
boŞ
 
	mdœeùed
;

74 
Hashšg
 
	mhashšg
;

76 
P¬t™iÚšg
 
	m·¹™iÚšg
;

81 
M©rix
* 
	mA
;

89 
Rev”sibËHash”
* 
	mhash”
 = 
nuÎ±r
;

92 
lßd_bš¬y
(
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, 
boŞ
 
dœeùed_
,

93 
boŞ
 
»v”£_edges
, boŞ 
»move_cyşes
,

94 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
);

97 
lßd_‹xt
(
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, 
boŞ
 
dœeùed_
,

98 
boŞ
 
»v”£_edges
, boŞ 
»move_cyşes
,

99 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
);

102 
	mpublic
:

106 
ušt32_t
 
	$g‘_nv”tiûs
(ècÚ¡ {  
nv”tiûs
; }

108 
ušt32_t
 
	$g‘_mv”tiûs
(ècÚ¡ {  
mv”tiûs
; 
	}
}

110 cÚ¡ 
M©rix
* 
	$g‘_m©rix
(ècÚ¡ {  
A
; 
	}
}

112 
boŞ
 
	$is_dœeùed
(ècÚ¡ {  
dœeùed
; 
	}
}

114 cÚ¡ 
Rev”sibËHash”
* 
	$g‘_hash”
(ècÚ¡ {  
hash”
; 
	}
}

116 
P¬t™iÚšg
 
	$g‘_·¹™iÚšg
(ècÚ¡ {  
·¹™iÚšg
; 
	}
}

122 
	~"g¿ph.hµ
"

	@src/matrix/graph.hpp

1 
	~<c¡dlib
>

2 
	~<c¡dšt
>

3 
	~<c¡dio
>

4 
	~<ÿs£¹
>

5 
	~<cm©h
>

6 
	~<veùÜ
>

7 
	~<sys/¡©.h
>

8 
	~<sys/ty³s.h
>

9 
	~"uts/’v.h
"

10 
	~"uts/di¡_tim”.h
"

11 
	~"m©rix/g¿ph.h
"

14 
	g‹m¶©e
 <
şass
 
	gWeight
>

15 
	gG¿ph
<
	gWeight
>::
	$G¿ph
(è: 
	$A
(
nuÎ±r
è{
	}
}

18 
‹m¶©e
 <
şass
 
Weight
>

19 
G¿ph
<
Weight
>::~
	$G¿ph
()

21 
	`ä“
();

22 ià(
hash”
)

23 
d–‘e
 
hash”
;

24 
hash”
 = 
nuÎ±r
;

25 
	}
}

28 
	g‹m¶©e
 <
şass
 
	gWeight
>

29 
	gG¿ph
<
	gWeight
>::
	$ä“
()

31 ià(
A
)

32 
d–‘e
 
A
;

33 
A
 = 
nuÎ±r
;

34 
	}
}

37 
	g‹m¶©e
 <
şass
 
	gWeight
>

38 
	gG¿ph
<
	gWeight
>::
	$lßd_bš¬y
(

39 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, 
boŞ
 
dœeùed_
,

40 
boŞ
 
»v”£_edges
, boŞ 
»move_cyşes
, 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
)

42 
	`as£¹
(
A
 =ğ
nuÎ±r
);

44 
Di¡Tim”
 
	`šg»ss_tim”
("Ingress");

47 
f•©h
 = 
f•©h_
;

48 
nv”tiûs
 = 
Äows
;

49 
mv”tiûs
 = 
ncŞs
;

50 
Ãdges
 = 0;

51 
dœeùed
 = 
dœeùed_
;

52 
hashšg
 = 
hashšg_
;

53 
·¹™iÚšg
 = 
·¹™iÚšg_
;

56 
boŞ
 
b¬t™e
 = 
Äows
 !ğ
ncŞs
;

57 ià(
b¬t™e
)

58 
nv”tiûs
 = 
mv”tiûs
 = 
Äows
 + 
ncŞs
;

60 ià(
hashšg
 =ğ
Hashšg
::
NONE
)

61 
hash”
 = 
Ãw
 
	`NuÎHash”
();

62 ià(
hashšg
 =ğ
Hashšg
::
BUCKET
)

63 
hash”
 = 
Ãw
 
	`Sim¶eBuck‘Hash”
(
nv”tiûs
, 
Env
::
Äªks
);

64 ià(
hashšg
 =ğ
Hashšg
::
MODULO
)

65 
hash”
 = 
Ãw
 
	`ModuloAr™hm‘icHash”
(
nv”tiûs
);

68 
FILE
* 
fe
;

69 ià(!(
fe
 = 
	`fİ’
(
f•©h
.
	`c_¡r
(), "r")))

71 
LOG
.
	`šfo
("Unableo open input file");

72 
	`ex™
(1);

76 
boŞ
 
h—d”_´e£Á
 = 
nv”tiûs
 == 0;

77 
ušt64_t
 
Üig_fesize
, 
fesize
, 
sh¬e
, 
off£t
 = 0, 
’dpos
;

79 
¡©
 
¡
;

80 ià(
	`¡©
(
f•©h
.
	`c_¡r
(), &
¡
) != 0)

82 
LOG
.
	`šfo
("Stat() failure");

83 
	`ex™
(1);

86 
Üig_fesize
 = 
fesize
 = (
ušt64_t
è
¡
.
¡_size
;

88 ià(
h—d”_´e£Á
)

91 
TrË
<
ušt64_t
> 
h—d”
;

93 ià(!
	`ä—d
(&
h—d”
, (h—d”), 1, 
fe
))

95 
LOG
.
	`šfo
("fread() failure");

96 
	`ex™
(1);

99 
nv”tiûs
 = 
Äows
 = 
h—d”
.
row
 + 1;

100 
mv”tiûs
 = 
ncŞs
 = 
h—d”
.
cŞ
 + 1;

101 
Ãdges
 = 
h—d”
.
weight
;

103 
LOG
.
	`šfo
("Read header:‚vertices = %u, mvertices = %u,‚edges (nnz) = %lu \n",

104 
nv”tiûs
, 
mv”tiûs
, 
Ãdges
);

106 
b¬t™e
 = 
Äows
 !ğ
ncŞs
;

107 ià(
b¬t™e
)

108 
nv”tiûs
 = 
mv”tiûs
 = 
Äows
 + 
ncŞs
;

111 
off£t
 +ğ(
h—d”
);

112 
fesize
 -ğ
off£t
;

115 
ušt64_t
 
ÁrËs
 = (
Üig_fesize
 - 
off£t
è/ (
TrË
<
Weight
>);

117 
LOG
.
	`šfo
("File‡ppearso have %luƒdges (%u-byte weights). \n",

118 
ÁrËs
, (
TrË
<
Weight
>è- (TrË<
Em±y
>));

120 ià(
h—d”_´e£Á
 
ªd
 
Ãdges
 !ğ
ÁrËs
)

121 
LOG
.
	`šfo
("[WARN] Number ofƒdges in header does‚ot match‚umber ofƒdges in file. \n");

124 
A
 = 
Ãw
 
	`M©rix
(
nv”tiûs
, 
mv”tiûs
, 
Env
::
Äªks
 * Env::Äªks, 
·¹™iÚšg
);

127 
sh¬e
 = (
fesize
 / 
Env
::
Äªks
è/ (
TrË
<
Weight
>) * (Triple<Weight>);

128 
	`as£¹
(
sh¬e
 % (
TrË
<
Weight
>) == 0);

130 
off£t
 +ğ
sh¬e
 * 
Env
::
¿nk
;

131 
’dpos
 = (
Env
::
¿nk
 =ğEnv::
Äªks
 - 1è? 
Üig_fesize
 : 
off£t
 + 
sh¬e
;

134 ià(
	`f£ek
(
fe
, 
off£t
, 
SEEK_SET
) < 0)

136 
LOG
.
	`šfo
("fseek() failure \n");

137 
	`ex™
(1);

141 
LOG
.
	`šfo
("Reading input file ... \n");

143 
Di¡Tim”
 
	`»ad_tim”
("Reading Input File");

145 
TrË
<
Weight
> 
ŒË
;

147 
off£t
 < 
’dpos
 && 
	`ä—d
(&
ŒË
, (
TrË
<
Weight
>), 1, 
fe
))

149 ià((
off£t
 & ((1L << 26) - 1L)) == 0)

151 
LOG
.
šfo
<
çl£
, false>("|");

152 
	`fæush
(
¡dout
);

154 
off£t
 +ğ(
TrË
<
Weight
>);

156 ià(
b¬t™e
)

157 
ŒË
.
cŞ
 +ğ
Äows
;

160 ià(
ŒË
.
row
 =ğŒË.
cŞ
)

165 ià(
dœeùed
 
ªd
 
nÙ
 
»v”£_edges
)

166 
¡d
::
	`sw­
(
ŒË
.
row
,rË.
cŞ
);

168 ià(
»move_cyşes
)

170 ià((
nÙ
 
»v”£_edges
 
ªd
 
ŒË
.
cŞ
 >rË.
row
)

171 
	`Ü
 (
»v”£_edges
 
ªd
 
ŒË
.
cŞ
 <rË.
row
))

172 
¡d
::
	`sw­
(
ŒË
.
row
,rË.
cŞ
);

175 
ŒË
.
row
 = (
ušt32_t
è
hash”
->
	`hash
(triple.row);

176 
ŒË
.
cŞ
 = (
ušt32_t
è
hash”
->
	`hash
(triple.col);

179 
A
->
	`š£¹
(
ŒË
);

181 ià(
nÙ
 
dœeùed
)

183 
¡d
::
	`sw­
(
ŒË
.
row
,rË.
cŞ
);

184 
A
->
	`š£¹
(
ŒË
);

188 
»ad_tim”
.
	`¡İ
();

190 
LOG
.
šfo
<
çl£
, f®£>("[%d]", 
Env
::
¿nk
);

191 
Env
::
	`b¬r›r
();

192 
LOG
.
šfo
<
Œue
, 
çl£
>("\n");

194 
	`as£¹
(
off£t
 =ğ
’dpos
);

195 
	`fşo£
(
fe
);

198 
LOG
.
	`šfo
("Partitioning‡nd distributing ... \n");

200 
Di¡Tim”
 
	`·¹_di¡_tim”
("Partition‡nd Distribute");

201 
A
->
	`di¡ribu‹
();

202 
·¹_di¡_tim”
.
	`¡İ
();

206 
šg»ss_tim”
.
	`¡İ
();

207 
šg»ss_tim”
.
	`»pÜt
();

208 
	}
}

211 
	g‹m¶©e
 <
şass
 
	gWeight
>

212 
	gG¿ph
<
	gWeight
>::
	$lßd_‹xt
(

213 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, 
boŞ
 
dœeùed_
,

214 
boŞ
 
»v”£_edges
, boŞ 
»move_cyşes
, 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
)

215 { 
LOG
.
	`šfo
("NÙ im¶em’‹d \n"); 
	`ex™
(1); 
	}
}

218 
	g‹m¶©e
 <
şass
 
	gWeight
>

219 
	gG¿ph
<
	gWeight
>::
	$lßd_dœeùed
(

220 
boŞ
 
bš¬y
, 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
nv”tiûs_
,

221 
boŞ
 
»v”£_edges
, boŞ 
»move_cyşes
, 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
)

223 ià(
bš¬y
)

224 
	`lßd_bš¬y
(
f•©h_
, 
nv”tiûs_
,‚v”tiûs_, 
Œue
, 
»v”£_edges
, 
»move_cyşes
,

225 
hashšg_
, 
·¹™iÚšg_
);

227 
	`lßd_‹xt
(
f•©h_
, 
nv”tiûs_
,‚v”tiûs_, 
Œue
, 
»v”£_edges
, 
»move_cyşes
,

228 
hashšg_
, 
·¹™iÚšg_
);

229 
	}
}

232 
	g‹m¶©e
 <
şass
 
	gWeight
>

233 
	gG¿ph
<
	gWeight
>::
	$lßd_undœeùed
(

234 
boŞ
 
bš¬y
, 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
nv”tiûs_
,

235 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
)

237 ià(
bš¬y
)

238 
	`lßd_bš¬y
(
f•©h_
, 
nv”tiûs_
,‚v”tiûs_, 
çl£
, f®£, f®£, 
hashšg_
, 
·¹™iÚšg_
);

240 
	`lßd_‹xt
(
f•©h_
, 
nv”tiûs_
,‚v”tiûs_, 
çl£
, f®£, f®£, 
hashšg_
, 
·¹™iÚšg_
);

241 
	}
}

244 
	g‹m¶©e
 <
şass
 
	gWeight
>

245 
	gG¿ph
<
	gWeight
>::
	$lßd_b¬t™e
(

246 
boŞ
 
bš¬y
, 
¡d
::
¡ršg
 
f•©h_
, 
ušt32_t
 
nv”tiûs_
, ušt32_ˆ
mv”tiûs_
,

247 
boŞ
 
dœeùed
, boŞ 
»v”£_edges
, 
Hashšg
 
hashšg_
, 
P¬t™iÚšg
 
·¹™iÚšg_
)

249 ià(
bš¬y
)

250 
	`lßd_bš¬y
(
f•©h_
, 
nv”tiûs_
, 
mv”tiûs_
, 
dœeùed
, 
»v”£_edges
, 
çl£
,

251 
hashšg_
, 
·¹™iÚšg_
);

253 
	`lßd_‹xt
(
f•©h_
, 
nv”tiûs_
, 
mv”tiûs_
, 
dœeùed
, 
»v”£_edges
, 
çl£
,

254 
hashšg_
, 
·¹™iÚšg_
);

255 
	}
}

258 
	g‹m¶©e
 <
şass
 
	gWeight
>

259 
	gG¿ph
<
	gWeight
>::
	$lßd_Ïb–s
(
¡d
::
¡ršg
& 
f•©h_
)

262 
	}
}

	@src/matrix/hashers.h

1 #iâdeà
REVERSIBLE_HASHER_H


2 
	#REVERSIBLE_HASHER_H


	)

4 
	~<c¡dlib
>

5 
	~<®gÜ™hm
>

12 şas 
	cRev”sibËHash”


14 
	mpublic
:

15 
vœtu®
 ~
	$Rev”sibËHash”
() {}

16 
vœtu®
 
	$hash
(
v
) const = 0;

17 
vœtu®
 
	$unhash
(
v
) const = 0;

18 
	}
};

25 şas 
	cNuÎHash”
 : 
public
 
Rev”sibËHash”


27 
public
:

28 
	$NuÎHash”
() {}

29 
	$hash
(
v
ècÚ¡ {  v; 
	}
}

30 
	$unhash
(
v
ècÚ¡ {  v; 
	}
}

39 şas 
	cSim¶eBuck‘Hash”
 : 
public
 
Rev”sibËHash”


41 
´iv©e
:

42 cÚ¡ 
muÉl›r
 = 128u;

43 
	mÅ¬ts
 = 0;

44 
	mheight
 = 0;

45 
	mmax_¿nge
 = 0;

47 
	mpublic
:

48 
	$Sim¶eBuck‘Hash”
(
max_domaš
, 
nbuck‘s
)

50 
Å¬ts
 = 
nbuck‘s
 * 
muÉl›r
;

51 
height
 = 
max_domaš
 / 
Å¬ts
;

52 
max_¿nge
 = 
height
 * 
Å¬ts
;

55 
	$hash
(
v
) const {

56 if(
v
 >ğ
max_¿nge
)  v;

57 
cŞ
 = (
ušt32_t
è
v
 % 
Å¬ts
;

58 
row
 = 
v
 / 
Å¬ts
;

59  
row
 + 
cŞ
 * 
height
;

60 
	}
}

62 
	$unhash
(
v
) const {

63 if(
v
 >ğ
max_¿nge
)  v;

64 
cŞ
 = 
v
 / 
height
;

65 
row
 = 
v
 % 
height
;

66  
cŞ
 + 
row
 * 
Å¬ts
;

67 
	}
}

76 şas 
	cModuloAr™hm‘icHash”
 : 
public
 
Rev”sibËHash”


78 
´iv©e
:

79 
max_¿nge
 = 0;

80 
	mh1
 = 0;

81 
	mh2
 = 0;

83 
	mpublic
:

84 
	$ModuloAr™hm‘icHash”
(
max_domaš
è: 
	$max_¿nge
(
max_domaš
)

86 
	`¤ªd
(12345);

87 
g
 = 0;

88 
g
 != 1)

91 
h1
 = 0;

92 
h1
 % 2 == 0)

93 
h1
 = 
	`¿nd
(è% 
max_¿nge
;

94 
g
 = 
	`gcd
(
max_¿nge
, 
h1
, 
h2
);

99 
	$hash
(
v
ècÚ¡ {  v * 
h1
 % 
max_¿nge
; 
	}
}

101 
	$unhash
(
v
ècÚ¡ {  v * 
h2
 % 
max_¿nge
; 
	}
}

103 
	g´iv©e
:

104 
	$gcd
(
a
, 
b
, & 
bi
)

106 ià(
b
 > 
a
)

107 
¡d
::
	`sw­
(
a
, 
b
);

108 
x
 = 0, 
y
 = 1;

109 
Ï¡x
 = 1, 
Ï¡y
 = 0;

110 
b
 != 0)

112 
q
 = 
a
 / 
b
;

113 
‹mp1
 = 
a
 % 
b
;

114 
a
 = 
b
;

115 
b
 = 
‹mp1
;

116 
‹mp2
 = 
x
;

117 
x
 = 
Ï¡x
 - 
q
 * x;

118 
Ï¡x
 = 
‹mp2
;

119 
‹mp3
 = 
y
;

120 
y
 = 
Ï¡y
 - 
q
 * y;

121 
Ï¡y
 = 
‹mp3
;

123 
bi
 = 
Ï¡y
;

124  
a
;

125 
	}
}

	@src/matrix/matrix2d.h

1 #iâdeà
MATRIX2D_H


2 
	#MATRIX2D_H


	)

4 
	~<veùÜ
>

5 
	~"uts/te.h
"

14 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
 = 
Te2D
<
Weight
>>

15 şas 
	cM©rix2D


17 
ä›nd
 
M©rix2D_Te¡
;

19 
	mpublic
:

20 
M©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
);

27 
š£¹
(cÚ¡ 
TrË
<
Weight
>& 
ŒË
);

29 
ušt32_t
 
£gm’t_of_idx
(ušt32_ˆ
idx
);

31 
	m´Ùeùed
:

33 cÚ¡ 
ušt32_t
 
Äows
, 
	mncŞs
;

35 cÚ¡ 
P¬t™iÚšg
 
	m·¹™iÚšg
;

37 cÚ¡ 
ušt32_t
 
	mÁes
, 
	mÄowg½s
, 
	mncŞg½s
;

39 cÚ¡ 
ušt32_t
 
	mte_height
, 
	mte_width
;

45 
	m¡d
::
veùÜ
<
¡d
::veùÜ<
Te
>> 
tes
;

47 
	m´Ùeùed
:

49 
Paœ
 
te_of_ŒË
(cÚ¡ 
TrË
<
Weight
>& 
ŒË
);

51 
	m´iv©e
:

52 
´št_šfo
();

54 
¡©ic_as£¹
(
¡d
::
is_ba£_of
<
Te2D
<
Weight
>, 
Te
>::
v®ue
,

60 
	~"m©rix2d.hµ
"

	@src/matrix/matrix2d.hpp

1 
	~<ÿs£¹
>

2 
	~<cm©h
>

5 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

6 
	gM©rix2D
<
	gWeight
, 
	gTe
>::
	$M©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
,

7 
P¬t™iÚšg
 
·¹™iÚšg
)

8 : 
	`Äows
(
Äows
), 
	`ncŞs
(
ncŞs
), 
	`Áes
(
Áes
), 
	`Äowg½s
(
	`sq¹
Òtes)), 
	`ncŞg½s
Òte / 
Äowg½s
),

9 
	`te_height
((
Äows
 / 
Äowg½s
è+ 1), 
	`te_width
((
ncŞs
 / 
ncŞg½s
) + 1),

10 
	$·¹™iÚšg
(
·¹™iÚšg
)

13 
	`as£¹
(
Äows
 > 0 &&‚row =ğ
ncŞs
);

14 
	`as£¹
(
Äowg½s
 * 
ncŞg½s
 =ğ
Áes
 &&‚rowgrps ==‚colgrps);

17 
	`as£¹
((
Äows
 - 1è/ 
te_height
 < 
Äowg½s
);

18 
	`as£¹
((
ncŞs
 - 1è/ 
te_width
 < 
ncŞg½s
);

19 
	`as£¹
(
te_height
 =ğ
te_width
);

22 
tes
.
	`»size
(
ncŞg½s
);

23 
ušt32_t
 
x
 = 0; x < 
ncŞg½s
; x++)

24 
tes
[
x
].
	`»size
(
Äowg½s
);

26 
	`´št_šfo
();

27 
	}
}

29 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

30 
	gM©rix2D
<
	gWeight
, 
	gTe
>::
š£¹
(cÚ¡ 
TrË
<
Weight
>& 
ŒË
)

32 
Paœ
 
p
 = 
te_of_ŒË
(
ŒË
);

33 
	gtes
[
p
.
row
][p.
cŞ
].
	gŒËs
->
push_back
(
ŒË
);

36 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

37 
ušt32_t
 
	gM©rix2D
<
	gWeight
, 
	gTe
>::
	$£gm’t_of_idx
(
ušt32_t
 
idx
)

38 {  
idx
 / 
te_height
; 
	}
}

40 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

41 
Paœ
 
	gM©rix2D
<
	gWeight
, 
	gTe
>::
te_of_ŒË
(cÚ¡ 
TrË
<
Weight
>& 
ŒË
)

42 {  { 
ŒË
.
row
 / 
te_height
, 
	gŒË
.
	gcŞ
 / 
	gte_width
 }; }

44 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gTe
>

45 
	gM©rix2D
<
	gWeight
, 
	gTe
>::
	$´št_šfo
()

47 
LOG
.
	`šfo
("#> Created‡ square matrix with %u x %uƒntries‡nd %u x %uiles.\n"

48 "#> Eachšhm©rix ha %u x %uƒÁr›s.\n", 
Äows
, 
ncŞs
, 
Äowg½s
,

49 
ncŞg½s
, 
te_height
, 
te_width
);

50 
	}
}

	@src/matrix/processed_matrix2d.h

1 #iâdeà
PROCESSED_MATRIX_H


2 
	#PROCESSED_MATRIX_H


	)

4 
	~"m©rix/ªnÙ©ed_m©rix2d.h
"

5 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

16 
	g‹m¶©e
 <
şass
 
	gWeight
>

17 
	gProûs£dAÂÙ©iÚ
 : 
BasicAÂÙ©iÚ
<
Weight
>

19 
usšg
 
Te
 = 
Proûs£dTe2D
<
Weight
>;

20 
usšg
 
	gRowG½
 = 
Proûs£dRowG½
<
Te
>;

21 
usšg
 
	gCŞG½
 = 
Proûs£dCŞG½
<
Te
>;

22 
usšg
 
	gDashbßrd
 = 
Proûs£dDashbßrd
<
RowG½
, 
	gCŞG½
>;

26 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
 = 
Proûs£dAÂÙ©iÚ
<
Weight
>>

27 
şass
 
Proûs£dM©rix2D
 : 
public
 
AÂÙ©edM©rix2D
<
Weight
, 
	gAÂÙ©iÚ
>

29 
ä›nd
 
	gProûs£dM©rix2D_Te¡
;

31 
	gpublic
:

32 
Proûs£dM©rix2D
(
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
);

34 ~
Proûs£dM©rix2D
();

37 
di¡ribu‹
();

39 
	gpublic
:

41 
usšg
 
Ba£
 = 
AÂÙ©edM©rix2D
<
Weight
, 
	gAÂÙ©iÚ
>;

42 
usšg
 
	gDashbßrd
 = 
ty³Çme
 
AÂÙ©iÚ
::
Dashbßrd
;

43 
usšg
 
	gBa£
::
¿nk
;

44 
usšg
 
	gBa£
::
te_width
;

45 
usšg
 
	gBa£
::
te_height
;

46 
usšg
 
	gBa£
::
loÿl_rowg½s
;

47 
usšg
 
	gBa£
::
loÿl_cŞg½s
;

48 
usšg
 
	gBa£
::
dashbßrds
;

50 
usšg
 
	gBV
 = 
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>;

53 
´•roûss
();

55 
	g´iv©e
:

56 
wa™_®l
(
¡d
::
veùÜ
<
MPI_Reque¡
>& 
»qs
);

58 
g©h”_dashbßrd_rowg½_bvs
();

60 
g©h”_dashbßrd_cŞg½_bvs
();

62 
´oûss_dashbßrd_bvs
();

64 
g©h”_rowg½s_bvs
();

66 
g©h”_cŞg½s_bvs
();

68 
ü—‹_rowg½s_loÿtÜs
();

70 
ü—‹_cŞg½s_loÿtÜs
();

72 
	g´iv©e
:

73 
¡d
::
veùÜ
<
MPI_Reque¡
> 
rowg½_š»qs
, 
	growg½_ouŒeqs
;

75 
	g¡d
::
veùÜ
<
MPI_Reque¡
> 
cŞg½_š»qs
, 
	gcŞg½_ouŒeqs
;

77 
	g¡d
::
veùÜ
<*> 
rowg½_šblobs
, 
	growg½_outblobs
;

79 
	g¡d
::
veùÜ
<*> 
cŞg½_šblobs
, 
	gcŞg½_outblobs
;

81 
boŞ
 
	g®»ady_di¡ribu‹d
;

86 
	~"´oûs£d_m©rix2d.hµ
"

	@src/matrix/processed_matrix2d.hpp

1 
	~<£t
>

2 
	~<®gÜ™hm
>

3 
	~<num”ic
>

4 
	~<ÿs£¹
>

5 
	~<şim™s
>

6 
	~<cm©h
>

7 
	~<mpi.h
>

14 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

15 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$Proûs£dM©rix2D
(

16 
ušt32_t
 
Äows
, ušt32_ˆ
ncŞs
, ušt32_ˆ
Áes
, 
P¬t™iÚšg
 
·¹™iÚšg
)

17 : 
	`Ba£
(
Äows
, 
ncŞs
, 
Áes
, 
·¹™iÚšg
), 
	$®»ady_di¡ribu‹d
(
çl£
)

19 
	`as£¹
(
te_width
 =ğ
te_height
);

21 auto& 
rowg½
 : 
loÿl_rowg½s
)

23 
rowg½
.
loÿtÜ
 = 
Ãw
 
	`LoÿtÜ
Ôowg½.
	`¿nge
());

24 
rowg½
.
glob®_loÿtÜ
 = 
Ãw
 
	`LoÿtÜ
Ôowg½.
	`¿nge
());

26 
rowg½
.
loÿl
 = 
Ãw
 
	`BV
(
te_width
);

27 
rowg½
.
»guÏr
 = 
Ãw
 
	`BV
(
te_width
);

28 
rowg½
.
sšk
 = 
Ãw
 
	`BV
(
te_width
);

30 
rowg½
.
glob®ly_»guÏr
 = 
Ãw
 
	`BV
(
te_width
);

31 
rowg½
.
glob®ly_sšk
 = 
Ãw
 
	`BV
(
te_width
);

34 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

36 
cŞg½
.
loÿtÜ
 = 
Ãw
 
	`LoÿtÜ
(cŞg½.
	`¿nge
());

37 
cŞg½
.
loÿl
 = 
Ãw
 
	`BV
(
te_width
);

38 
cŞg½
.
»guÏr
 = 
Ãw
 
	`BV
(
te_width
);

39 
cŞg½
.
sourû
 = 
Ãw
 
	`BV
(
te_width
);

42 auto& 
db
 : 
dashbßrds
)

44 
db
.
loÿtÜ
 = 
Ãw
 
	`LoÿtÜ
(
te_width
);

45 
db
.
»guÏr
 = 
Ãw
 
	`BV
(
te_width
);

46 
db
.
sšk
 = 
Ãw
 
	`BV
(
te_width
);

47 
db
.
sourû
 = 
Ãw
 
	`BV
(
te_width
);

52 auto& 
db
 : 
dashbßrds
)

54 
¡d
::
veùÜ
<
št32_t
> 
¿nks
 = 
db
.
rowg½_fŞlow”s
;

55 
¿nks
.
	`push_back
(
this
->
¿nk
);

57 
db
.
rowg½_¿nks_m‘a
.
	`»£rve
(
¿nks
.
	`size
());

58 autØ
r
 : 
¿nks
)

59 
db
.
rowg½_¿nks_m‘a
.
	`em¶aû_back
(
r
, 
te_width
);

63 auto& 
db
 : 
dashbßrds
)

65 
¡d
::
veùÜ
<
št32_t
> 
¿nks
 = 
db
.
cŞg½_fŞlow”s
;

66 
¿nks
.
	`push_back
(
this
->
¿nk
);

68 
db
.
cŞg½_¿nks_m‘a
.
	`»£rve
(
¿nks
.
	`size
());

69 autØ
r
 : 
¿nks
)

70 
db
.
cŞg½_¿nks_m‘a
.
	`em¶aû_back
(
r
, 
te_width
);

72 
	}
}

74 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

75 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::~
	$Proûs£dM©rix2D
()

77 auto& 
rowg½
 : 
loÿl_rowg½s
)

79 
d–‘e
 
rowg½
.
loÿtÜ
;

80 
d–‘e
 
rowg½
.
glob®_loÿtÜ
;

82 
d–‘e
 
rowg½
.
loÿl
;

83 
d–‘e
 
rowg½
.
»guÏr
;

84 
d–‘e
 
rowg½
.
sšk
;

86 
d–‘e
 
rowg½
.
glob®ly_»guÏr
;

87 
d–‘e
 
rowg½
.
glob®ly_sšk
;

90 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

92 
d–‘e
 
cŞg½
.
loÿtÜ
;

93 
d–‘e
 
cŞg½
.
loÿl
;

94 
d–‘e
 
cŞg½
.
»guÏr
;

95 
d–‘e
 
cŞg½
.
sourû
;

98 auto& 
db
 : 
dashbßrds
)

100 
d–‘e
 
db
.
loÿtÜ
;

101 
d–‘e
 
db
.
»guÏr
;

102 
d–‘e
 
db
.
sšk
;

103 
d–‘e
 
db
.
sourû
;

105 
	}
}

107 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

108 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$di¡ribu‹
()

110 
	`as£¹
(!
®»ady_di¡ribu‹d
);

112 
Ba£
::
	`di¡ribu‹
();

113 
	`´•roûss
();

115 
®»ady_di¡ribu‹d
 = 
Œue
;

116 
	}
}

118 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

119 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$´•roûss
()

121 
	`g©h”_dashbßrd_rowg½_bvs
();

122 
	`g©h”_dashbßrd_cŞg½_bvs
();

124 
	`´oûss_dashbßrd_bvs
();

126 
	`as£¹
(
rowg½_š»qs
.
	`size
() == 0);

127 
	`as£¹
(
cŞg½_š»qs
.
	`size
() == 0);

128 
	`as£¹
(
rowg½_šblobs
.
	`size
() == 0);

129 
	`as£¹
(
cŞg½_šblobs
.
	`size
() == 0);

131 
	`g©h”_rowg½s_bvs
();

132 
	`g©h”_cŞg½s_bvs
();

134 
	`ü—‹_rowg½s_loÿtÜs
();

135 
	`ü—‹_cŞg½s_loÿtÜs
();

137 
	`as£¹
(
rowg½_š»qs
.
	`size
() == 0);

138 
	`as£¹
(
cŞg½_š»qs
.
	`size
() == 0);

139 
	`as£¹
(
rowg½_šblobs
.
	`size
() == 0);

140 
	`as£¹
(
cŞg½_šblobs
.
	`size
() == 0);

142 
	`wa™_®l
(
cŞg½_ouŒeqs
);

144 
ušt32_t
 
idx
 = 0;

145 auto& 
db
 : 
dashbßrds
)

146 auto& 
m
 : 
db
.
cŞg½_¿nks_m‘a
)

147 
m
.
»guÏr
.
	`i£nd_po¡´oûss
(
cŞg½_outblobs
.
	`©
(
idx
++));

149 
cŞg½_outblobs
.
	`ş—r
();

151 auto& 
db
 : 
dashbßrds
)

152 
db
.
loÿtÜ
->
	`fÜ_dashbßrd
(*db.
»guÏr
, *db.
sšk
, *db.
sourû
);

171 
	}
}

173 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

174 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
wa™_®l
(
¡d
::
veùÜ
<
MPI_Reque¡
>& 
»qs
)

176 autØ
»tv®
 = 
MPI_Wa™®l
(
»qs
.
size
(),„eqs.
d©a
(), 
MPI_STATUSES_IGNORE
);

177 
as£¹
(
»tv®
 !ğ
MPI_ERR_IN_STATUS
);

178 
	g»qs
.
ş—r
();

181 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

182 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$´oûss_dashbßrd_bvs
()

184 
	`wa™_®l
(
rowg½_š»qs
);

186 
ušt32_t
 
idx
 = 0;

188 auto& 
db
 : 
dashbßrds
)

189 auto& 
m
 : 
db
.
rowg½_¿nks_m‘a
)

190 
m
.
»guÏr
.
	`œecv_po¡´oûss
(
rowg½_šblobs
.
	`©
(
idx
++));

192 
	`wa™_®l
(
cŞg½_š»qs
);

194 
idx
 = 0;

196 auto& 
db
 : 
dashbßrds
)

197 auto& 
m
 : 
db
.
cŞg½_¿nks_m‘a
)

198 
m
.
»guÏr
.
	`œecv_po¡´oûss
(
cŞg½_šblobs
.
	`©
(
idx
++));

200 
rowg½_šblobs
.
	`ş—r
();

201 
cŞg½_šblobs
.
	`ş—r
();

203 auto& 
db
 : 
dashbßrds
)

205 
BV
 
	`rows
(
te_height
);

206 
BV
 
	`cŞs
(
te_width
);

208 auto& 
m
 : 
db
.
rowg½_¿nks_m‘a
)

209 
rows
.
	`uniÚ_w™h
(
m
.
»guÏr
);

210 auto& 
m
 : 
db
.
cŞg½_¿nks_m‘a
)

211 
cŞs
.
	`uniÚ_w™h
(
m
.
»guÏr
);

216 
db
.
»guÏr
->
	`uniÚ_w™h
(
rows
);

218 
	#CONSIDER_DANGLING_PRIMARY
 
çl£


	)

219 #ià!
CONSIDER_DANGLING_PRIMARY


220 
db
.
»guÏr
->
	`š‹r£ù_w™h
(
cŞs
);

222 
db
.
sšk
->
	`uniÚ_w™h
(
rows
);

223 
db
.
sšk
->
	`difã»nû_w™h
(
cŞs
);

226 
db
.
sourû
->
	`uniÚ_w™h
(
cŞs
);

227 
db
.
sourû
->
	`difã»nû_w™h
(
rows
);

229 
	}
}

233 
	~"´oûs£d_m©rix2d_d‘as.hµ
"

	@src/matrix/processed_matrix2d_details.hpp

8 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

9 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$g©h”_dashbßrd_rowg½_bvs
()

11 
MPI_Reque¡
 
»q
;

14 auto& 
db
 : 
dashbßrds
)

16 auto& 
m
 : 
db
.
rowg½_¿nks_m‘a
)

18 
rowg½_šblobs


19 .
	`push_back
(
m
.
»guÏr
.
	`œecv
(m.
¿nk
, 
Dashbßrd
::
	`rowg½_g
(
db
.
rg
),

20 
Env
::
MPI_WORLD
, &
»q
));

21 
rowg½_š»qs
.
	`push_back
(
»q
);

26 auto& 
rowg½
 : 
loÿl_rowg½s
)

28 
BV
& 
bv
 = *
rowg½
.
loÿl
;

30 auto& 
te
 : 
rowg½
.
loÿl_tes
)

32 auto& 
ŒË
 : *(
te
->
ŒËs
))

33 
bv
.
	`touch
(
ŒË
.
row
 - 
rowg½
.
off£t
);

36 
rowg½_outblobs


37 .
	`push_back
(
bv
.
	`i£nd
(
rowg½
.
Ëad”
, 
Dashbßrd
::
	`rowg½_g
Ôowg½.
rg
),

38 
Env
::
MPI_WORLD
, &
»q
));

39 
rowg½_ouŒeqs
.
	`push_back
(
»q
);

41 
	}
}

43 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

44 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$g©h”_dashbßrd_cŞg½_bvs
()

46 
MPI_Reque¡
 
»q
;

49 auto& 
db
 : 
dashbßrds
)

51 auto& 
m
 : 
db
.
cŞg½_¿nks_m‘a
)

53 
cŞg½_šblobs
.
	`push_back
(
m
.
»guÏr
.
	`œecv
(m.
¿nk
, 
Dashbßrd
::
	`cŞg½_g
(
db
.
cg
),

54 
Env
::
MPI_WORLD
, &
»q
));

55 
cŞg½_š»qs
.
	`push_back
(
»q
);

60 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

62 
BV
& 
bv
 = *
cŞg½
.
loÿl
;

64 auto& 
te
 : 
cŞg½
.
loÿl_tes
)

66 auto& 
ŒË
 : *(
te
->
ŒËs
))

67 
bv
.
	`touch
(
ŒË
.
cŞ
 - 
cŞg½
.
off£t
);

70 
cŞg½_outblobs


71 .
	`push_back
(
bv
.
	`i£nd
(
cŞg½
.
Ëad”
, 
Dashbßrd
::
	`cŞg½_g
(cŞg½.
cg
),

72 
Env
::
MPI_WORLD
, &
»q
));

73 
cŞg½_ouŒeqs
.
	`push_back
(
»q
);

75 
	}
}

77 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

78 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$g©h”_rowg½s_bvs
()

80 
MPI_Reque¡
 
»q
;

82 auto& 
rowg½
 : 
loÿl_rowg½s
)

84 
rowg½_šblobs
.
	`push_back
(
rowg½
.
glob®ly_»guÏr
->
	`œecv
(

85 
rowg½
.
Ëad”
, 
Dashbßrd
::
	`rowg½_g
Ôowg½.
rg
), 
Env
::
MPI_WORLD
, &
»q
));

86 
rowg½_š»qs
.
	`push_back
(
»q
);

88 
rowg½_šblobs
.
	`push_back
(
rowg½
.
glob®ly_sšk
->
	`œecv
(

89 
rowg½
.
Ëad”
, 
this
->
Äowg½s
 + 
Dashbßrd
::
	`rowg½_g
Ôowg½.
rg
), 
Env
::
MPI_WORLD
, &
»q
));

90 
rowg½_š»qs
.
	`push_back
(
»q
);

93 
	`wa™_®l
(
rowg½_ouŒeqs
);

95 
ušt32_t
 
idx
 = 0;

97 auto& 
rowg½
 : 
loÿl_rowg½s
)

98 
rowg½
.
loÿl
->
	`i£nd_po¡´oûss
(
rowg½_outblobs
.
	`©
(
idx
++));

100 
	`as£¹
(
rowg½_outblobs
.
	`size
(è=ğ
idx
);

101 
rowg½_outblobs
.
	`ş—r
();

103 auto& 
db
 : 
dashbßrds
)

105 auto& 
m
 : 
db
.
rowg½_¿nks_m‘a
)

107 
m
.
»guÏr
.
	`š‹r£ù_w™h
(*
db
.regular);

108 
rowg½_outblobs
.
	`push_back
(
db
.
»guÏr
->
	`i£nd
(

109 
m
.
¿nk
, 
Dashbßrd
::
	`rowg½_g
(
db
.
rg
), 
Env
::
MPI_WORLD
, &
»q
));

110 
rowg½_ouŒeqs
.
	`push_back
(
»q
);

112 
rowg½_outblobs
.
	`push_back
(
db
.
sšk
->
	`i£nd
(

113 
m
.
¿nk
, 
this
->
Äowg½s
 + 
Dashbßrd
::
	`rowg½_g
(
db
.
rg
), 
Env
::
MPI_WORLD
, &
»q
));

114 
rowg½_ouŒeqs
.
	`push_back
(
»q
);

117 
	}
}

119 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

120 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$g©h”_cŞg½s_bvs
()

122 
MPI_Reque¡
 
»q
;

124 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

126 
cŞg½_šblobs
.
	`push_back
(
cŞg½
.
»guÏr
->
	`œecv
(

127 
cŞg½
.
Ëad”
, 
Dashbßrd
::
	`cŞg½_g
(cŞg½.
cg
), 
Env
::
MPI_WORLD
, &
»q
));

128 
cŞg½_š»qs
.
	`push_back
(
»q
);

131 
	`wa™_®l
(
cŞg½_ouŒeqs
);

133 
ušt32_t
 
idx
 = 0;

135 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

136 
cŞg½
.
loÿl
->
	`i£nd_po¡´oûss
(
cŞg½_outblobs
.
	`©
(
idx
++));

138 
cŞg½_outblobs
.
	`ş—r
();

140 auto& 
db
 : 
dashbßrds
)

142 auto& 
m
 : 
db
.
cŞg½_¿nks_m‘a
)

144 
m
.
Ùh”
.
	`uniÚ_w™h
(m.
»guÏr
);

145 
m
.
Ùh”
.
	`difã»nû_w™h
(*
db
.
»guÏr
);

146 
m
.
»guÏr
.
	`š‹r£ù_w™h
(*
db
.regular);

148 
cŞg½_outblobs
.
	`push_back
(
m
.
»guÏr
.
	`i£nd
(

149 
m
.
¿nk
, 
Dashbßrd
::
	`cŞg½_g
(
db
.
cg
), 
Env
::
MPI_WORLD
, &
»q
));

150 
cŞg½_ouŒeqs
.
	`push_back
(
»q
);

153 
	}
}

155 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

156 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$ü—‹_rowg½s_loÿtÜs
()

158 
	`as£¹
(
rowg½_š»qs
.
	`size
(è=ğ
loÿl_rowg½s
.size() * 2);

159 
	`wa™_®l
(
rowg½_š»qs
);

161 
ušt32_t
 
idx
 = 0;

162 auto& 
rowg½
 : 
loÿl_rowg½s
)

164 
rowg½
.
glob®ly_»guÏr
->
	`œecv_po¡´oûss
(
rowg½_šblobs
.
	`©
(
idx
++));

165 
rowg½
.
glob®ly_sšk
->
	`œecv_po¡´oûss
(
rowg½_šblobs
.
	`©
(
idx
++));

167 
rowg½
.
»guÏr
->
	`uniÚ_w™h
(*rowg½.
loÿl
);

168 
rowg½
.
»guÏr
->
	`š‹r£ù_w™h
(*rowg½.
glob®ly_»guÏr
);

170 
rowg½
.
sšk
->
	`uniÚ_w™h
(*rowg½.
loÿl
);

171 
rowg½
.
sšk
->
	`difã»nû_w™h
(*rowg½.
»guÏr
);

173 
rowg½
.
loÿtÜ
->
	`äom_b™veùÜs
(*rowg½.
loÿl
, *rowg½.
»guÏr
, *rowg½.
sšk
);

175 
BV
 
	`glob®
(*
rowg½
.
glob®ly_»guÏr
);

176 
glob®
.
	`uniÚ_w™h
(*
rowg½
.
glob®ly_sšk
);

178 
rowg½
.
glob®_loÿtÜ
->
	`äom_b™veùÜs
(

179 
glob®
, *
rowg½
.
glob®ly_»guÏr
, *rowg½.
glob®ly_sšk
);

182 
	`as£¹
(
rowg½_šblobs
.
	`size
(è=ğ
idx
);

183 
rowg½_šblobs
.
	`ş—r
();

185 
	`wa™_®l
(
rowg½_ouŒeqs
);

187 
idx
 = 0;

188 auto& 
db
 : 
dashbßrds
)

189 auto& 
m
 : 
db
.
rowg½_¿nks_m‘a
)

191 
db
.
»guÏr
->
	`i£nd_po¡´oûss
(
rowg½_outblobs
.
	`©
(
idx
++));

192 
db
.
sšk
->
	`i£nd_po¡´oûss
(
rowg½_outblobs
.
	`©
(
idx
++));

195 
	`as£¹
(
rowg½_outblobs
.
	`size
(è=ğ
idx
);

196 
rowg½_outblobs
.
	`ş—r
();

197 
	}
}

199 
	g‹m¶©e
 <
şass
 
	gWeight
, cÏs 
	gAÂÙ©iÚ
>

200 
	gProûs£dM©rix2D
<
	gWeight
, 
	gAÂÙ©iÚ
>::
	$ü—‹_cŞg½s_loÿtÜs
()

202 
	`wa™_®l
(
cŞg½_š»qs
);

204 
ušt32_t
 
idx
 = 0;

205 auto& 
cŞg½
 : 
loÿl_cŞg½s
)

207 
cŞg½
.
»guÏr
->
	`œecv_po¡´oûss
(
cŞg½_šblobs
.
	`©
(
idx
++));

209 
cŞg½
.
sourû
->
	`uniÚ_w™h
(*cŞg½.
loÿl
);

210 
cŞg½
.
sourû
->
	`difã»nû_w™h
(*cŞg½.
»guÏr
);

212 
cŞg½
.
loÿtÜ
->
	`äom_b™veùÜs
(*cŞg½.
loÿl
, *cŞg½.
»guÏr
, *cŞg½.
sourû
);

215 
cŞg½_šblobs
.
	`ş—r
();

216 
	}
}

	@src/structures/bitvector.h

1 #iâdeà
BIT_VECTOR_H


2 
	#BIT_VECTOR_H


	)

4 
	~<ÿs£¹
>

5 
	~<c¡ršg
>

6 
	~<c¡dšt
>

9 şas 
	cB™VeùÜ


11 
	m´Ùeùed
:

12 
cÚ¡ex´
 
ušt32_t
 
b™width
 = 32;

14 
cÚ¡ex´
 
ušt32_t
 
	mlg_b™width
 = 5;

16 
cÚ¡ex´
 
ušt32_t
 
	mb™width_mask
 = 0x1F;

18 
	m´Ùeùed
:

19 
ušt32_t
 
n
;

21 
ušt32_t
* 
	mwÜds
;

23 
ušt32_t
* 
	mÂzs
;

25 
ušt32_t
 
	mpos
 = 0;

27 
ušt32_t
 
	mÿche
 = 0;

29 
boŞ
 
	mowns_wÜds
 = 
Œue
;

31 
	mpublic
:

33 
	$B™VeùÜ
() {}

35 
	$B™VeùÜ
(
ušt32_t
 
n
)

36 : 
	`n
(
n
), 
	`wÜds
(
Ãw
 
ušt32_t
[
	`bufãr_nwÜds
()]()), 
	$Âzs
(
wÜds
)

39 *
Âzs
 = 0;

40 
wÜds
++;

41 
	`»wšd
();

42 
	}
}

45 
	$B™VeùÜ
(cÚ¡ 
B™VeùÜ
& 
bv
, 
boŞ
 
d“p
 = 
Œue
)

46 : 
	`n
(
bv
.
n
), 
	`wÜds
(
d“p
 ? (
Ãw
 
ušt32_t
[
	`bufãr_nwÜds
()]è: bv.
	`bufãr
()), 
	$Âzs
(
wÜds
)

49 
owns_wÜds
 = 
d“p
;

50 
wÜds
++;

51 ià(
d“p
)

53 
	`»wšd
();

54 
	`memıy
(
	`bufãr
(), 
bv
.bufãr(), 
	`bufãr_nby‹s
());

56 
	}
}

58 
	gvœtu®
 ~
	$B™VeùÜ
()

61 ià(
owns_wÜds
)

62 
d–‘e
[] 
	`bufãr
();

63 
	}
}

66 
	gB™VeùÜ
& 
	gİ”©Ü
=(
B™VeùÜ
 cÚ¡&èğ
d–‘e
;

68 
	gpublic
:

69 
ušt32_t
 
	$size
(ècÚ¡ {  
n
; 
	}
};

71 
ušt32_t
 
	$couÁ
(ècÚ¡ {  *
Âzs
; 
	}
};

78 
	$‹mpÜ¬y_»size
(
ušt32_t
 
n_
)

80 
	`as£¹
(
	`couÁ
() == 0);

81 
	`»wšd
();

82 
	`uÁouch
(
n
);

83 
n
 = 
n_
;

84 *
Âzs
 = 0;

85 
	`»wšd
();

86 
	}
}

88 
boŞ
 
	$touch
(
ušt32_t
 
idx
)

90 
ušt32_t
 
x
 = 
idx
 >> 
lg_b™width
;

91 
ušt32_t
 
Üig
 = 
wÜds
[
x
];

92 
wÜds
[
x
] |ğ1 << (
idx
 & 
b™width_mask
);

93 
ušt32_t
 
diff
 = (
Üig
 !ğ
wÜds
[
x
]);

94 *
Âzs
 +ğ
diff
;

95  !
diff
;

96 
	}
}

98 
boŞ
 
	$uÁouch
(
ušt32_t
 
idx
)

100 
ušt32_t
 
x
 = 
idx
 >> 
lg_b™width
;

101 
ušt32_t
 
Üig
 = 
wÜds
[
x
];

102 
wÜds
[
x
] &ğ~(1 << (
idx
 & 
b™width_mask
));

103 
ušt32_t
 
diff
 = (
Üig
 !ğ
wÜds
[
x
]);

104 *
Âzs
 -ğ
diff
;

105  
diff
;

106 
	}
}

108 
ušt32_t
 
	$check
(
ušt32_t
 
idx
) const

110  
wÜds
[
idx
 >> 
lg_b™width
] & (1 << (idx & 
b™width_mask
));

111 
	}
}

113 
	$ş—r
()

115 
	`mem£t
(
	`bufãr
(), 0, 
	`bufãr_nby‹s
());

116 
	`»wšd
();

117 
	}
}

119 
	$fl
()

121 
	`mem£t
(
	`bufãr
(), 0xFFFFFFFF, 
	`bufãr_nby‹s
());

122 *
Âzs
 = 
n
;

123 
	`»wšd
();

124 
	}
}

126 
	$fl
(
ušt32_t
 
äom_wÜd
, ušt32_ˆ
nwÜds_to_fl
)

128 
nwÜds_to_fl
 = 
¡d
::
	`mš
ÒwÜds_to_fl, 
	`veùÜ_nwÜds
(è- 
äom_wÜd
);

129 
	`mem£t
(
wÜds
 + 
äom_wÜd
, 0xFFFFFFFF, 
nwÜds_to_fl
 * (
ušt32_t
));

130 *
Âzs
 = 
nwÜds_to_fl
 * 
b™width
;

131 
	`»wšd
();

132 
	}
}

134 
	gpublic
:

135 
»wšd
();

137 
push
(
ušt32_t
 
idx
);

139 
boŞ
 
pİ
(
ušt32_t
& 
idx
);

141 
boŞ
 
Ãxt
(
ušt32_t
& 
idx
);

143 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

144 
boŞ
 
	$advªû
(
ušt32_t
& 
idx
)

146 ià(
de¡ruùive
)

147  
	`pİ
(
idx
);

149  
	`Ãxt
(
idx
);

150 
	}
}

152 
	gpublic
:

153 
uniÚ_w™h
(
B™VeùÜ
 cÚ¡& 
bv
);

155 
š‹r£ù_w™h
(
B™VeùÜ
 cÚ¡& 
bv
);

157 
difã»nû_w™h
(
B™VeùÜ
 cÚ¡& 
bv
);

159 
	g´Ùeùed
:

160 
ušt32_t
* 
	$bufãr
() const

162  
wÜds
 - 1;

163 
	}
}

165 
ušt32_t
 
	$veùÜ_nwÜds
() const

167 
ušt32_t
 
n_
 = 
n
 + 1;

168  
n_
 / 
b™width
 + (n_ % bitwidth > 0);

169 
	}
}

171 
ušt32_t
 
	$bufãr_nwÜds
() const

173  
	`veùÜ_nwÜds
() + 1;

174 
	}
}

176 
ušt32_t
 
	$bufãr_nby‹s
() const

178  
	`bufãr_nwÜds
(è* (
ušt32_t
);

179 
	}
}

181 
	gpublic
:

182 
ušt32_t
 
	$g‘_b™width
(è{  
b™width
; 
	}
}

184 
ušt32_t
 
	$g‘_nwÜds
(ècÚ¡ {  
	`veùÜ_nwÜds
(); 
	}
}

189 
	~"b™veùÜ.hµ
"

	@src/structures/bitvector.hpp

1 
	~"b™veùÜ.h
"

4 
	gB™VeùÜ
::
	$»wšd
()

6 
pos
 = 0;

7 
ÿche
 = 0;

13 ià(
nÙ
 
	`touch
(
n
))

14 (*
Âzs
)--;

15 
	}
}

17 
	gB™VeùÜ
::
	$push
(
ušt32_t
 
idx
)

19 
	`touch
(
idx
);

20 
	}
}

22 
boŞ
 
	gB™VeùÜ
::
	$pİ
(
ušt32_t
& 
idx
)

24 
wÜds
[
pos
] == 0)

25 
pos
++;

27 
ušt32_t
 
lsb
 = 
	`__butš_ùz
(
wÜds
[
pos
]);

28 
wÜds
[
pos
] ^ğ1 << 
lsb
;

29 
idx
 = (
pos
 << 
lg_b™width
è+ 
lsb
;

31 *
Âzs
 -ğ(
idx
 < 
n
);

32  
idx
 < 
n
;

33 
	}
}

35 
boŞ
 
	gB™VeùÜ
::
	$Ãxt
(
ušt32_t
& 
idx
)

37 
wÜds
[
pos
] == 0)

38 
pos
++;

39 
ÿche
 = cach? cach: 
wÜds
[
pos
];

41 
ušt32_t
 
lsb
 = 
	`__butš_ùz
(
ÿche
);

42 
ÿche
 ^ğ1 << 
lsb
;

43 
idx
 = (
pos
 << 
lg_b™width
è+ 
lsb
;

45 
pos
 +ğ(
ÿche
 == 0);

46  
idx
 < 
n
;

47 
	}
}

49 
	gB™VeùÜ
::
	$uniÚ_w™h
(
B™VeùÜ
 cÚ¡& 
bv
)

51 
	`as£¹
(
bv
.
n
 ==‚);

52 
ušt32_t
 
Âzs_
 = 0;

54 
ušt32_t
 
max
 = 
	`veùÜ_nwÜds
();

55 
ušt32_t
 
i
 = 0; i < 
max
; i++)

57 
wÜds
[
i
] |ğ
bv
.words[i];

58 
Âzs_
 +ğ
	`__butš_pİcouÁ
(
wÜds
[
i
]);

61 *
Âzs
 = 
Âzs_
 - 1;

62 
	}
}

64 
	gB™VeùÜ
::
	$š‹r£ù_w™h
(
B™VeùÜ
 cÚ¡& 
bv
)

66 
	`as£¹
(
bv
.
n
 ==‚);

67 
	`as£¹
(
	`check
(
n
));

68 
	`as£¹
(
bv
.
	`check
(
n
));

69 
ušt32_t
 
Âzs_
 = 0;

71 
ušt32_t
 
max
 = 
	`veùÜ_nwÜds
();

72 
ušt32_t
 
i
 = 0; i < 
max
; i++)

74 
wÜds
[
i
] &ğ
bv
.words[i];

75 
Âzs_
 +ğ
	`__butš_pİcouÁ
(
wÜds
[
i
]);

78 *
Âzs
 = 
Âzs_
 - 1;

79 
	}
}

81 
	gB™VeùÜ
::
	$difã»nû_w™h
(
B™VeùÜ
 cÚ¡& 
bv
)

83 
	`as£¹
(
bv
.
n
 ==‚);

84 
ušt32_t
 
Âzs_
 = 0;

86 
ušt32_t
 
max
 = 
	`veùÜ_nwÜds
();

87 
ušt32_t
 
i
 = 0; i < 
max
; i++)

89 
wÜds
[
i
] &ğ~
bv
.words[i];

90 
Âzs_
 +ğ
	`__butš_pİcouÁ
(
wÜds
[
i
]);

93 
	`touch
(
n
);

94 *
Âzs
 = 
Âzs_
;

95 
	}
}

	@src/structures/communicable.h

1 #iâdeà
COMMUNICABLE_H


2 
	#COMMUNICABLE_H


	)

28 
	g‹m¶©e
 <
şass
 
	gA¼ay
>

29 şas 
	cCommuniÿbË
 : 
public
 
A¼ay


31 
public
:

33 
usšg
 
A¼ay
::Array;

35 * 
	$Ãw_blob
()

37  
A¼ay
::
	`Ãw_blob
(
	`blob_nby‹s_max
());

40 
	$d–‘e_blob
(* 
blob
)

42 
A¼ay
::
	`d–‘e_blob
(
blob
);

43 
	}
}

45 
ušt32_t
 
	$blob_nby‹s
(
ušt32_t
 
couÁ
)

47  
A¼ay
::
	`blob_nby‹s
(
couÁ
);

48 
	}
}

50 
ušt32_t
 
	$blob_nby‹s_tight
()

52  
A¼ay
::
	`blob_nby‹s
(A¼ay::
	`couÁ
());

53 
	}
}

55 
ušt32_t
 
	$blob_nby‹s_max
()

57  
A¼ay
::
	`blob_nby‹s
(A¼ay::
	`size
());

58 
	}
}

60 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
 = 
çl£
>

61 * 
	$i£nd
(
št32_t
 
¿nk
, iÁ32_ˆ
g
, 
MPI_Comm
 
comm
, 
MPI_Reque¡
* 
»que¡
)

63 * 
blob
 = 
nuÎ±r
;

66 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
ty³Çme
 
A¼ay
::
Ty³
>::
v®ue
)

69 
ušt32_t
 
nby‹s
 = 
A¼ay
::
‹m¶©e
 
£rŸlize_što
<
de¡ruùive
>(
blob
);

70 
	`MPI_I£nd
(
blob
, 
nby‹s
, 
MPI_BYTE
, 
¿nk
, 
g
, 
comm
, 
»que¡
);

74 
blob
 = 
A¼ay
::
	`Ãw_blob
(
	`blob_nby‹s_tight
());

75 
ušt32_t
 
nby‹s
 = 
A¼ay
::
‹m¶©e
 
£rŸlize_što
<
de¡ruùive
>(
blob
);

76 
	`MPI_I£nd
(
blob
, 
nby‹s
, 
MPI_BYTE
, 
¿nk
, 
g
, 
comm
, 
»que¡
);

79  
blob
;

80 
	}
}

82 
	$i£nd_po¡´oûss
(* 
blob
)

84 
	`d–‘e_blob
(
blob
);

85 
	}
}

87 * 
	$œecv
(
št32_t
 
¿nk
, iÁ32_ˆ
g
, 
MPI_Comm
 
comm
, 
MPI_Reque¡
* 
»que¡
)

89 * 
blob
 = 
nuÎ±r
;

92 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
ty³Çme
 
A¼ay
::
Ty³
>::
v®ue
)

95 
MPI_Stus
* 
¡©us
 = 
Ãw
 MPI_Status;

96 
¡©us
->
MPI_SOURCE
 = 
¿nk
;

97 
¡©us
->
MPI_TAG
 = 
g
;

98 
æag
 = 0;

99 
	`MPI_I´obe
(
¿nk
, 
g
, 
comm
, &
æag
, 
¡©us
);

100 *
»que¡
 = 
MPI_REQUEST_NULL
;

101  
¡©us
;

105 
blob
 = 
	`Ãw_blob
();

106 
	`MPI_I»cv
(
blob
, 
	`blob_nby‹s_max
(), 
MPI_BYTE
, 
¿nk
, 
g
, 
comm
, 
»que¡
);

107  
blob
;

109 
	}
}

111 
	$œecv_po¡´oûss
(* 
blob
)

113 
A¼ay
::
	`de£rŸlize_äom
(
blob
);

114 
	`d–‘e_blob
(
blob
);

115 
	}
}

117 
	$œecv_po¡´oûss
(* 
blob
, 
ušt32_t
 
sub_size
)

119 
A¼ay
::
	`de£rŸlize_äom
(
blob
, 
sub_size
);

120 
	`d–‘e_blob
(
blob
);

121 
	}
}

124 
œecv_dyÇmic_®l
(
¡d
::
veùÜ
<*>& 
the_blobs
, std::veùÜ<
MPI_Reque¡
>& 
the_»que¡s
)

126 autØ
i
 = 0; 
	gi
 < 
	gthe_blobs
.
size
(); i++)

128 
MPI_Stus
* 
	g¡©us
 = (MPI_Stus*è
the_blobs
[
i
];

129 
	gsourû
 = 
¡©us
->
MPI_SOURCE
;

130 
	gg
 = 
¡©us
->
MPI_TAG
;

131 
d–‘e
 
	g¡©us
;

133 
MPI_Stus
 
	g¡©us_
;

134 
MPI_Reque¡
* 
	g»que¡
 = &
the_»que¡s
[
i
];

135 
	gcouÁ
;

137 
MPI_Probe
(
sourû
, 
g
, 
Env
::
MPI_WORLD
, &
¡©us_
);

138 
MPI_G‘_couÁ
(&
¡©us_
, 
MPI_BYTE
, &
couÁ
);

140 
	gthe_blobs
[
i
] = 
Ãw
 [
couÁ
];

142 
MPI_I»cv
(
the_blobs
[
i
], 
couÁ
, 
MPI_BYTE
, 
sourû
, 
g
, 
Env
::
MPI_WORLD
, 
»que¡
);

147 
œecv_dyÇmic_some
(
¡d
::
veùÜ
<*>& 
the_blobs
, std::veùÜ<
MPI_Reque¡
>& 
the_»que¡s
)

149 
num_»ady
 = 0;

151 
	gnum_»ady
 == 0)

153 autØ
i
 = 0; 
	gi
 < 
	gthe_blobs
.
size
(); i++)

155 *& 
	gblob
 = 
the_blobs
[
i
];

156 
	gMPI_Reque¡
& 
	g»que¡
 = 
the_»que¡s
[
i
];

158 ià(
	gblob
 =ğ
nuÎ±r
)

164 ià(
	g»que¡
 !ğ
MPI_REQUEST_NULL
)

169 
num_»ady
++;

174 
	gMPI_Stus
*& 
	g¡©us
 = (
MPI_Stus
*&è
the_blobs
[
i
];

175 
	gsourû
 = 
¡©us
->
MPI_SOURCE
;

176 
	gg
 = 
¡©us
->
MPI_TAG
;

178 
MPI_Stus
 
	g¡©us_
;

179 
	gæag
 = 0;

181 
MPI_I´obe
(
sourû
, 
g
, 
Env
::
MPI_WORLD
, &
æag
, &
¡©us_
);

183 ià(
	gæag
)

185 
	gcouÁ
;

186 
MPI_G‘_couÁ
(&
¡©us_
, 
MPI_BYTE
, &
couÁ
);

188 
d–‘e
 
	g¡©us
;

189 
	gblob
 = 
Ãw
 [
couÁ
];

191 
MPI_I»cv
(
blob
, 
couÁ
, 
MPI_BYTE
, 
sourû
, 
g
, 
Env
::
MPI_WORLD
, &
»que¡
);

192 
	gnum_»ady
++;

198 
	$œecv_dyÇmic_Úe
(*& 
blob
, 
MPI_Reque¡
*& 
»que¡
)

200 
MPI_Stus
* 
¡©us
 = (MPI_Stus*è
blob
;

201 
sourû
 = 
¡©us
->
MPI_SOURCE
;

202 
g
 = 
¡©us
->
MPI_TAG
;

203 
d–‘e
 
¡©us
;

205 
MPI_Stus
 
¡©us_
;

206 
couÁ
 = 0;

208 
	`MPI_Probe
(
sourû
, 
g
, 
Env
::
MPI_WORLD
, &
¡©us_
);

209 
	`MPI_G‘_couÁ
(&
¡©us_
, 
MPI_BYTE
, &
couÁ
);

211 
blob
 = 
Ãw
 [
couÁ
];

213 
	`MPI_I»cv
(
blob
, 
couÁ
, 
MPI_BYTE
, 
sourû
, 
g
, 
Env
::
MPI_WORLD
, 
»que¡
);

214 
	}
}

	@src/structures/fixed_vector.h

1 #iâdeà
FIXED_VECTOR_


2 
	#FIXED_VECTOR_


	)

4 
	~<®gÜ™hm
>

23 
	g‹m¶©e
 <
şass
 
	gV®ue
>

24 şas 
	cFixedVeùÜ


26 
	mpublic
:

27 
usšg
 
Ty³
 = 
V®ue
;

29 
	m´iv©e
:

30 
ušt32_t
 
ÿ·c™y
;

32 
ušt32_t
 
	mpos™iÚ
;

33 
V®ue
* 
	mv®ues
;

35 
	mpublic
:

37 
	$FixedVeùÜ
(è: 
	$ÿ·c™y
(0) {}

39 ~
	$FixedVeùÜ
()

41 ià(
ÿ·c™y
 > 0)

43 
d–‘e
[] 
v®ues
;

44 
v®ues
 = 
nuÎ±r
;

46 
	}
}

48 
	gpublic
:

50 
	$»£rve
(
ušt32_t
 
ÿ·c™y_
)

52 
	`as£¹
(
ÿ·c™y
 == 0);

53 
ÿ·c™y
 = 
ÿ·c™y_
;

54 
pos™iÚ
 = 0;

55 
v®ues
 = 
Ãw
 
V®ue
[
ÿ·c™y
];

56 
	}
}

58 
	$»size
(
ušt32_t
 
ÿ·c™y_
)

60 
	`»£rve
(
ÿ·c™y_
);

61 
ušt32_t
 
i
 = 0; i < 
ÿ·c™y
; i++)

62 
	`em¶aû_back
();

63 
	}
}

65 
	g‹m¶©e
 <
	gşass
... 
	gArgs
>

66 
	$em¶aû_back
(
Args
&& ... 
¬gs
)

68 
	`Ãw
 (
v®ues
 + 
pos™iÚ
è
	`V®ue
(
¬gs
...);

69 
pos™iÚ
++;

70 
	}
}

72 
ušt32_t
 
	$size
(ècÚ¡ {  
pos™iÚ
; 
	}
}

74 
	gpublic
:

75 
V®ue
& 
	$back
(ècÚ¡ { 
	`as£¹
(
pos™iÚ
 >ğ1);  
v®ues
[pos™iÚ - 1]; 
	}
}

77 
	gV®ue
& 
	gİ”©Ü
[](
ušt32_t
 
	gidx
ècÚ¡ {  
	gv®ues
[
idx
]; }

79 
V®ue
* 
	$begš
(ècÚ¡ {  
v®ues
; 
	}
}

81 
V®ue
* 
	$’d
(ècÚ¡ {  
v®ues
 + 
ÿ·c™y
; 
	}
}

83 
V®ue
* 
	$d©a
(ècÚ¡ {  
	`begš
(); 
	}
}

	@src/structures/random_access_array.h

1 #iâdeà
RANDOM_ACCESS_ARRAY_


2 
	#RANDOM_ACCESS_ARRAY_


	)

4 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

7 
	g‹m¶©e
 <
şass
 
	gV®ue
>

8 şas 
	cRªdomAcûssA¼ay


10 
	mpublic
:

11 
usšg
 
Ty³
 = 
V®ue
;

12 
usšg
 
	mAùiv™yS‘
 = 
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>;

14 
Aùiv™yS‘
* 
	maùiv™y
;

16 
	m´Ùeùed
:

17 
ušt32_t
 
n
;

19 
V®ue
* 
	mv®s
;

21 
	mpublic
:

23 
	$RªdomAcûssA¼ay
() {}

26 
	$RªdomAcûssA¼ay
(
ušt32_t
 
n
)

27 : 
	`aùiv™y
(
Ãw
 
	`Aùiv™yS‘
(
n
)), 
	`n
Ò), 
	`v®s
Òew 
V®ue
[n + 1]())

28 { 
	`»wšd
(); 
	}
}

30 ~
	$RªdomAcûssA¼ay
()

32 
d–‘e
[] 
v®s
;

33 
v®s
 = 
nuÎ±r
;

34 
d–‘e
 
aùiv™y
;

35 
aùiv™y
 = 
nuÎ±r
;

36 
	}
}

38 
	$‹mpÜ¬y_»size
(
ušt32_t
 
n_
)

40 
	`»wšd
();

41 
aùiv™y
->
	`‹mpÜ¬y_»size
(
n_
);

42 
n
 = 
n_
;

43 
	}
}

46 
	$fl
(cÚ¡ 
V®ue
& 
v®
è{ 
¡d
::
	`fl
(
v®s
, v® + 
n
, v®); 
	}
}

48 
	$ş—r
()

50 
ušt32_t
 
idx
;

51 
V®ue
 
v®
;

52 
	`»wšd
();

53 
	`pİ
(
idx
, 
v®
)) { }

54 
	`»wšd
();

55 
	}
}

57 
	gV®ue
& 
	gİ”©Ü
[](
ušt32_t
 
	gidx
è{  
	gv®s
[
idx
]; }

59 
ušt32_t
 
	$size
(ècÚ¡ {  
n
; 
	}
}

62 
RªdomAcûssA¼ay
(cÚ¡ RªdomAcûssA¼ay&èğ
d–‘e
;

64 cÚ¡ 
	gRªdomAcûssA¼ay
& 
	gİ”©Ü
=(cÚ¡ 
RªdomAcûssA¼ay
&èğ
d–‘e
;

66 
	gpublic
:

68 
	$»wšd
(è{ 
aùiv™y
->
	`»wšd
(); 
	}
}

70 
	$push
(
ušt32_t
 
idx
, cÚ¡ 
V®ue
& 
v®
)

72 
aùiv™y
->
	`push
(
idx
);

73 
v®s
[
idx
] = 
v®
;

74 
	}
}

76 
boŞ
 
	$pİ
(
ušt32_t
& 
idx
, 
V®ue
& 
v®
)

78 
boŞ
 
v®id
 = 
aùiv™y
->
	`pİ
(
idx
);

79 
v®
 = 
v®s
[
idx
];

80 
v®s
[
idx
] = 
	`V®ue
();

81  
v®id
;

82 
	}
}

84 
boŞ
 
	$Ãxt
(
ušt32_t
& 
idx
, 
V®ue
& 
v®
)

86 
boŞ
 
v®id
 = 
aùiv™y
->
	`Ãxt
(
idx
);

87 
v®
 = 
v®s
[
idx
];

88  
v®id
;

89 
	}
}

91 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

92 
boŞ
 
	$advªû
(
ušt32_t
& 
idx
, 
V®ue
& 
v®
)

94 ià(
de¡ruùive
)

95  
	`pİ
(
idx
, 
v®
);

97  
	`Ãxt
(
idx
, 
v®
);

98 
	}
}

100 
	gpublic
:

102 
‹m¶©e
 <
boŞ
 
de¡ruùive
 = 
çl£
>

103 
ušt32_t
 
£rŸlize_što
(*& 
blob
);

105 
de£rŸlize_äom
(cÚ¡ * 
blob
);

107 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
 = 
çl£
>

108 
ušt32_t
 
£rŸlize_što_dyÇmic
(*& 
blob
);

110 
de£rŸlize_äom_dyÇmic
(cÚ¡ * 
blob
);

112 
	g´Ùeùed
:

114 * 
	$Ãw_blob
(
ušt32_t
 
nby‹s
è{  
Ãw
 [nby‹s]; 
	}
}

116 
	$d–‘e_blob
(* 
blob
è{ 
d–‘e
[] ((*èblob); 
	}
}

119 
ušt32_t
 
	$blob_nby‹s
(
ušt32_t
 
couÁ
)

121 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`blob_nby‹s
(
couÁ
);

122 
ušt32_t
 
max_·ddšg
 = 
	`®ignof
(
V®ue
);

123 
ušt32_t
 
v®ues_nby‹s
 = 
couÁ
 * (
V®ue
);

124  
aùiv™y_nby‹s
 + 
max_·ddšg
 + 
v®ues_nby‹s
;

125 
	}
}

127 
ušt32_t
 
	$couÁ
(è{  
aùiv™y
->
	`couÁ
(); 
	}
}

129 
	g´iv©e
:

130 
V®ue
* 
blob_v®ues_off£t
(cÚ¡ * 
blob
, 
ušt32_t
 
aùiv™y_nby‹s
, ušt32_ˆ
v®ues_nby‹s
);

135 
	~"¿ndom_acûss_¬¿y.hµ
"

	@src/structures/random_access_array.hpp

1 
	~<memÜy
>

2 
	~<s¡»am
>

3 
	~<boo¡/¬chive/bš¬y_ßrchive.hµ
>

4 
	~<boo¡/¬chive/bš¬y_Ÿrchive.hµ
>

7 
	g‹m¶©e
 <
şass
 
	gV®ue
>

8 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

9 
ušt32_t
 
	gRªdomAcûssA¼ay
<
	gV®ue
>::
	$£rŸlize_što
(*& 
blob
)

11 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
V®ue
>::
v®ue
)

12  
RªdomAcûssA¼ay
::
‹m¶©e
 
£rŸlize_što_dyÇmic
<
de¡ruùive
>(
blob
);

14 
ušt32_t
 
v®ues_nby‹s
 = 
aùiv™y
->
	`couÁ
(è* (
V®ue
);

15 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
£rŸlize_što
<
çl£
 >(
blob
);

17 
V®ue
* 
v®ues
 = 
	`blob_v®ues_off£t
(
blob
, 
aùiv™y_nby‹s
, 
v®ues_nby‹s
);

19 
V®ue
 
v®
;

20 
ušt32_t
 
idx
, 
x
 = 0;

22 
	`»wšd
();

23 
this
->
advªû
<
de¡ruùive
>(
idx
, 
v®
))

24 
v®ues
[
x
++] = 
v®
;

25 
	`»wšd
();

28  (*è(
v®ues
 + 
x
è- (*è
blob
;

29 
	}
}

31 
	g‹m¶©e
 <
şass
 
	gV®ue
>

32 
	gRªdomAcûssA¼ay
<
	gV®ue
>::
	$de£rŸlize_äom
(cÚ¡ * 
blob
)

34 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
V®ue
>::
v®ue
)

36 
	`de£rŸlize_äom_dyÇmic
(
blob
);

40 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`de£rŸlize_äom
(
blob
);

41 
ušt32_t
 
v®ues_nby‹s
 = 
aùiv™y
->
	`couÁ
(è* (
V®ue
);

43 
V®ue
* 
v®ues
 = 
	`blob_v®ues_off£t
(
blob
, 
aùiv™y_nby‹s
, 
v®ues_nby‹s
);

45 
	`»wšd
();

46 
ušt32_t
 
idx
, 
x
 = 0;

47 
aùiv™y
->
	`Ãxt
(
idx
))

48 
v®s
[
idx
] = 
v®ues
[
x
++];

49 
	`»wšd
();

50 
	}
}

52 
	g‹m¶©e
 <
şass
 
	gV®ue
>

53 
V®ue
* 
	gRªdomAcûssA¼ay
<
	gV®ue
>::
	$blob_v®ues_off£t
(cÚ¡ * 
blob
, 
ušt32_t
 
aùiv™y_nby‹s
,

54 
ušt32_t
 
v®ues_nby‹s
)

56 * 
±r
 = (*è
blob
 + 
aùiv™y_nby‹s
;

58 
size_t
 
¥aû
 = 
SIZE_MAX
;

59 
V®ue
* 
»tv®
 = (V®ue*è
¡d
::
	`®ign
(
	`®ignof
(V®ue), 
v®ues_nby‹s
, 
±r
, 
¥aû
);

60 
	`as£¹
(
»tv®
);

62  
»tv®
;

63 
	}
}

67 
	g‹m¶©e
 <
şass
 
	gV®ue
>

68 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

69 
ušt32_t
 
	gRªdomAcûssA¼ay
<
	gV®ue
>::
	$£rŸlize_što_dyÇmic
(*& 
blob
)

71 
ušt32_t
 
Çùive
 = 
aùiv™y
->
	`couÁ
();

72 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`blob_nby‹s
(
Çùive
);

74 ià(
Çùive
 == 0)

76 
blob
 = 
Ãw
 [
aùiv™y_nby‹s
];

79 
ušt32_t
 
aùiv™y_nby‹s_
 = 
aùiv™y
->
£rŸlize_što
<
çl£
 >(
blob
);

80 
	`as£¹
(
aùiv™y_nby‹s
 =ğ
aùiv™y_nby‹s_
);

82 
	`»wšd
();

84  
aùiv™y_nby‹s
;

88 * 
tmp_blob
 = 
Ãw
 [
aùiv™y_nby‹s
];

89 
ušt32_t
 
aùiv™y_nby‹s_
 = 
aùiv™y
->
£rŸlize_što
<
çl£
 >(
tmp_blob
);

90 
	`as£¹
(
aùiv™y_nby‹s
 =ğ
aùiv™y_nby‹s_
);

93 
¡d
::
¡ršg
* 
v®ues
 = 
Ãw
 std::¡ršg[
Çùive
];

94 
ušt32_t
 
v®ues_nby‹s
 = 0u;

96 
V®ue
 
v®
;

97 
ušt32_t
 
idx
, 
x
 = 0;

99 
	`»wšd
();

100 
this
->
advªû
<
de¡ruùive
>(
idx
, 
v®
))

103 
usšg
 
boo¡
::
io¡»ams
::
back_š£¹_deviû
;

104 
usšg
 
boo¡
::
io¡»ams
::
¡»am
;

105 
back_š£¹_deviû
<
¡d
::
¡ršg
> 
	`š£¹”
(
v®ues
[
x
]);

106 
¡»am
<
back_š£¹_deviû
<
¡d
::
¡ršg
>> 
	`s
(
š£¹”
);

107 
boo¡
::
¬chive
::
bš¬y_ßrchive
 
	`ß
(
s
);

108 
ß
 << 
v®
;

109 
s
.
	`æush
();

111 
v®ues_nby‹s
 +ğ
v®ues
[
x
].
	`size
();

112 
x
++;

114 
	`»wšd
();

119 
ušt32_t
 
sizes_nby‹s
 = (ušt32_tè* 
Çùive
;

120 
ušt32_t
 
blob_nby‹s
 = 
aùiv™y_nby‹s
 + 
sizes_nby‹s
 + 
v®ues_nby‹s
;

123 
blob
 = 
Ãw
 [
blob_nby‹s
];

126 
	`memıy
(
blob
, 
tmp_blob
, 
aùiv™y_nby‹s
);

127 
d–‘e
[] 
tmp_blob
;

131 
size_t
 
¥aû
 = 
SIZE_MAX
;

133 * 
±r
 = ((*è
blob
è+ 
aùiv™y_nby‹s
;

134 
ušt32_t
* 
sizes
 = (ušt32_t*è
¡d
::
	`®ign
(
	`®ignof
(ušt32_t), (ušt32_t), 
±r
, 
¥aû
);

136 
±r
 = ((*è
sizes
è+ 
sizes_nby‹s
;

137 * 
v®ues_
 = (*è
¡d
::
	`®ign
(
	`®ignof
(), (), 
±r
, 
¥aû
);

139 autØ
i
 = 0; i < 
Çùive
; i++)

141 
ušt32_t
 
nby‹s
 = (ušt32_tè
v®ues
[
i
].
	`size
();

142 
sizes
[
i
] = 
nby‹s
;

143 
	`memıy
(
v®ues_
, 
v®ues
[
i
].
	`c_¡r
(), 
nby‹s
);

144 
v®ues_
 +ğ
nby‹s
;

146 
d–‘e
[] 
v®ues
;

148  
blob_nby‹s
;

149 
	}
}

151 
	g‹m¶©e
 <
şass
 
	gV®ue
>

152 
	gRªdomAcûssA¼ay
<
	gV®ue
>::
	$de£rŸlize_äom_dyÇmic
(cÚ¡ * 
blob
)

154 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`de£rŸlize_äom
(
blob
);

156 
ušt32_t
 
Çùive
 = 
aùiv™y
->
	`couÁ
();

158 ià(
Çùive
 == 0)

160 
	`»wšd
();

166 
size_t
 
¥aû
 = 
SIZE_MAX
;

168 * 
±r
 = (*è
blob
 + 
aùiv™y_nby‹s
;

169 
ušt32_t
* 
sizes
 = (ušt32_t*è
¡d
::
	`®ign
(
	`®ignof
(ušt32_t), (ušt32_t), 
±r
, 
¥aû
);

170 
ušt32_t
 
sizes_nby‹s
 = (ušt32_tè* 
Çùive
;

172 
±r
 = ((*è
sizes
è+ 
sizes_nby‹s
;

173 * 
v®ues
 = (*è
¡d
::
	`®ign
(
	`®ignof
(), (), 
±r
, 
¥aû
);

174 
ušt32_t
 
v®ues_nby‹s
 = 0u;

176 
ušt32_t
 
idx
, 
x
 = 0;

178 
	`»wšd
();

179 
aùiv™y
->
	`Ãxt
(
idx
))

181 
V®ue
 
v®
;

183 
usšg
 
boo¡
::
io¡»ams
::
basic_¬¿y_sourû
;

184 
usšg
 
boo¡
::
io¡»ams
::
¡»am
;

185 
basic_¬¿y_sourû
<> 
	`deviû
(
v®ues
, (
size_t
è
sizes
[
x
]);

186 
¡»am
<
basic_¬¿y_sourû
<>> 
	`s
(
deviû
);

187 
boo¡
::
¬chive
::
bš¬y_Ÿrchive
 
	`Ÿ
(
s
);

188 
Ÿ
 >> 
v®
;

189 
v®s
[
idx
] = 
v®
;

190 
v®ues
 +ğ
sizes
[
x
];

192 
v®ues_nby‹s
 +ğ
sizes
[
x
];

193 
x
++;

195 
	`»wšd
();

196 
	}
}

	@src/structures/serializable_bitvector.h

1 #iâdeà
SERIALIZABLE_BIT_VECTOR_H


2 
	#SERIALIZABLE_BIT_VECTOR_H


	)

4 
	~"¡ruùu»s/b™veùÜ.h
"

5 
	~"¡ruùu»s/communiÿbË.h
"

8 şas 
	cS”ŸlizabËB™VeùÜ
 : 
public
 
B™VeùÜ


10 
public
:

11 
usšg
 
B™VeùÜ
::BitVector;

12 
usšg
 
	mTy³
 = 
B™VeùÜ
;

14 
	$S”ŸlizabËB™VeùÜ
() {}

16 
	$S”ŸlizabËB™VeùÜ
(cÚ¡ 
S”ŸlizabËB™VeùÜ
& 
bv
, 
boŞ
 
d“p
 = 
Œue
)

17 : 
	$B™VeùÜ
(
bv
, 
d“p
è{
	}
}

20 
	gS”ŸlizabËB™VeùÜ
& 
	gİ”©Ü
=(
S”ŸlizabËB™VeùÜ
 cÚ¡&èğ
d–‘e
;

22 
	gpublic
:

23 
‹m¶©e
 <
boŞ
 
de¡ruùive
 = 
çl£
>

24 
ušt32_t
 
£rŸlize_što
(* 
blob
);

26 
ušt32_t
 
de£rŸlize_äom
(cÚ¡ * 
blob
);

28 
ušt32_t
 
de£rŸlize_äom
(cÚ¡ * 
blob
, ušt32_ˆ
sub_size
);

30 
	g´Ùeùed
:

31 * 
	$Ãw_blob
(
ušt32_t
 
nby‹s
è{  
Ãw
 [nby‹s]; 
	}
}

33 
	$d–‘e_blob
(* 
blob
è{ 
d–‘e
[] ((*èblob); 
	}
}

35 
ušt32_t
 
	$blob_nby‹s
(
ušt32_t
 
couÁ
è{  
	`blob_nby‹s
(couÁ, 
this
->
	`size
()); 
	}
}

37 
ušt32_t
 
	$blob_nby‹s
(
ušt32_t
 
couÁ
, ušt32_ˆ
size
)

39 ià(
	`is_d’£
(
couÁ
, 
size
))

41 
ušt32_t
 
size_
 = 
size
 + 1;

42 
ušt32_t
 
nwÜds
 = 
size_
 / 
b™width
 + (size_ % bitwidth > 0);

43  (
nwÜds
 + 1è* (
ušt32_t
);

46  (
couÁ
 + 1è* (
ušt32_t
);

47 
	}
}

49 
	g´iv©e
:

50 
boŞ
 
	$is_d’£
(è{  
	`is_d’£
(
this
->
	`couÁ
()); 
	}
}

52 
boŞ
 
	$is_d’£
(
ušt32_t
 
couÁ
è{  
	`is_d’£
(couÁ, 
this
->
	`size
()); 
	}
}

54 
boŞ
 
	$is_d’£
(
ušt32_t
 
couÁ
, ušt32_ˆ
size
)

55 {  
couÁ
 > ((
size
 / 
this
->
b™width
è* 2 / 3); 
	}
}

60 
	~"£rŸlizabË_b™veùÜ.hµ
"

	@src/structures/serializable_bitvector.hpp

3 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

4 
ušt32_t
 
	gS”ŸlizabËB™VeùÜ
::
	$£rŸlize_što
(* 
blob
)

6 
	`as£¹
(
	`check
(
this
->
	`size
()));

8 ià(
	`is_d’£
())

10 
	`»wšd
();

11 
	`as£¹
(
this
->
	`bufãr_nby‹s
(è=ğ
	`blob_nby‹s
Ñhis->
	`couÁ
()));

12 
ušt32_t
 
nby‹s
 = 
this
->
	`bufãr_nby‹s
();

13 
	`memıy
(
blob
, 
this
->
	`bufãr
(), 
nby‹s
);

15 ià(
de¡ruùive
)

16 
this
->
	`ş—r
();

17  
nby‹s
;

20 
ušt32_t
 
idx
, 
x
 = 0;

21 
ušt32_t
* 
out
 = (ušt32_t*è
blob
;

22 
out
[
x
++] = 
this
->
	`couÁ
();

23 
	`as£¹
(
out
[0] <ğ
this
->
	`size
());

25 
	`»wšd
();

26 
this
->
advªû
<
de¡ruùive
>(
idx
))

27 
out
[
x
++] = 
idx
;

28 
	`»wšd
();

30  
x
 * (
ušt32_t
);

31 
	}
}

34 
ušt32_t
 
	gS”ŸlizabËB™VeùÜ
::
	$de£rŸlize_äom
(cÚ¡ * 
blob
)

36  
	`de£rŸlize_äom
(
blob
, 
this
->
	`size
());

37 
	}
}

51 
ušt32_t
 
	gS”ŸlizabËB™VeùÜ
::
	$de£rŸlize_äom
(cÚ¡ * 
blob
, 
ušt32_t
 
sub_size
)

53 ià(
sub_size
 < 
this
->
	`size
())

54 
	`as£¹
(
this
->
	`couÁ
() == 0);

55 
	`as£¹
(
sub_size
 =ğ
this
->
	`size
());

57 
ušt32_t
* 
š
 = (ušt32_t*è
blob
;

58 
ušt32_t
 
tmp_couÁ
 = 
š
[0];

59 
	`as£¹
(
tmp_couÁ
 <ğ
sub_size
);

67 ià(
	`is_d’£
(
tmp_couÁ
, 
sub_size
))

69 
	`as£¹
(
	`blob_nby‹s
(
tmp_couÁ
, 
sub_size
è=ğ
this
->
	`bufãr_nby‹s
());

70 
ušt32_t
 
nby‹s
 = 
	`blob_nby‹s
(
tmp_couÁ
, 
sub_size
);

72 
	`memıy
(
this
->
	`bufãr
(), 
blob
, 
nby‹s
);

73 
	`as£¹
(
	`check
(
this
->
	`size
()));

75 *
Âzs
 = 
tmp_couÁ
;

76 
	`»wšd
();

78  
nby‹s
;

81 
	`»wšd
();

83 
ušt32_t
 
max
 = 
tmp_couÁ
 + 1;

84 
ušt32_t
 
i
 = 1; i < 
max
; i++)

85 
this
->
	`push
(
š
[
i
]);

88 
	`as£¹
(*
Âzs
 =ğ
tmp_couÁ
);

89 
	`as£¹
(
	`check
(
this
->
	`size
()));

91  
max
 * (
ušt32_t
);

92 
	}
}

	@src/structures/static_bitvector.h

1 #iâdeà
STATIC_BITVECTOR_H


2 
	#STATIC_BITVECTOR_H


	)

4 
	~<¡ršg
>

5 
	~<c¡dšt
>

6 
	~<c¡dlib
>

7 
	~<c¡ršg
>

8 
	~<x86šŒš.h
>

9 
	~<b™£t
>

10 
	~<ÿs£¹
>

13 
ušt32_t
 
	twÜd_t
;

22 
	g‹m¶©e
 <
size_t
 
	gSIZE
>

23 şas 
	cSticB™VeùÜ


25 
cÚ¡ex´
 
ušt32_t
 
	mBITS_PER_WORD
 = (
wÜd_t
);

27 
cÚ¡ex´
 
ušt32_t
 
	mNWORDS
 = (
SIZE
 - 1è/ 
BITS_PER_WORD
 + 1;

29 
wÜd_t
 
	mwÜds
[
NWORDS
] = {0};

31 
	gpublic
:

33 
	$SticB™VeùÜ
(è{
	}
}

35 
SticB™VeùÜ
(cÚ¡ SticB™VeùÜ<
SIZE
>& 
Ùh”
)

36 { 
memıy
(
wÜds
, 
Ùh”
.wÜds, 
BITS_PER_WORD
 * 
NWORDS
); }

38 
size_t
 
	$size
(ècÚ¡ {  
SIZE
; 
	}
}

40 
wÜd_t
* 
	$d©a
(ècÚ¡ {  
wÜds
; 
	}
};

42 
	$£t_®l
(è{ 
	`mem£t
(
wÜds
, 0xFFFF, 
BITS_PER_WORD
 * 
NWORDS
); 
	}
}

44 
	$un£t_®l
(è{ 
	`mem£t
(
wÜds
, 0, 
BITS_PER_WORD
 * 
NWORDS
); 
	}
}

46 
	$£t
(
size_t
 
b™
)

47 { 
wÜds
[
b™
 / 
BITS_PER_WORD
] |ğ((
ušt32_t
è1è<< (b™ % BITS_PER_WORD); 
	}
}

49 
	$un£t
(
size_t
 
b™
)

50 { 
wÜds
[
b™
 / 
BITS_PER_WORD
] &ğ~(((
ušt32_t
è1è<< (b™ % BITS_PER_WORD)); 
	}
}

52 
boŞ
 
	$‹¡
(
size_t
 
b™
) const

53 {  
wÜds
[
b™
 / 
BITS_PER_WORD
] & (((
ušt32_t
è1è<< (b™ % BITS_PER_WORD)); 
	}
}

55 
	gSticB™VeùÜ
& 
	gİ”©Ü
+=(cÚ¡ 
SticB™VeùÜ
& 
Ùh”
)

57 
as£¹
(
NWORDS
 =ğ
Ùh”
.NWORDS);

58 autØ
	gi
 = 0; i < 
	gNWORDS
; i++)

59 
	gwÜds
[
i
] |ğ
Ùh”
.
wÜds
[i];

60  *
	gthis
;

63 
	gSticB™VeùÜ
& 
	gİ”©Ü
*=(cÚ¡ 
SticB™VeùÜ
& 
Ùh”
)

65 
as£¹
(
NWORDS
 =ğ
Ùh”
.NWORDS);

66 autØ
	gi
 = 0; i < 
	gNWORDS
; i++)

67 
	gwÜds
[
i
] &ğ
Ùh”
.
wÜds
[i];

68  *
	gthis
;

71 
size_t
 
	$couÁ
() const

73 
size_t
 
couÁ
 = 0;

74 autØ
i
 = 0; i < 
NWORDS
; i++)

75 
couÁ
 +ğ
	`_mm_pİút_u32
(
wÜds
[
i
]);

76  
couÁ
;

77 
	}
}

79 
	g¡d
::
¡ršg
 
	$to_¡ršg
() const

81 
¡d
::
¡ršg
 
¡r
 = "";

82 autØ
i
 = 0; i < 
NWORDS
; i++)

83 
¡r
 +ğ
¡d
::
b™£t
<4>(
wÜds
[
i
]).
	`to_¡ršg
();

84  
¡r
;

85 
	}
}

	@src/structures/streaming_array.h

1 #iâdeà
STREAMING_ARRAY_


2 
	#STREAMING_ARRAY_


	)

4 
	~<şim™s
>

5 
	~<memÜy
>

6 
	~<c¡dšt
>

7 
	~<c¡dlib
>

8 
	~<uts/commÚ.h
>

9 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

10 
	~"¡ruùu»s/communiÿbË.h
"

13 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
=
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>>

14 şas 
	cSŒ—mšgA¼ay


16 
public
:

17 
usšg
 
Ty³
 = 
V®ue
;

19 
Aùiv™yS‘
* 
	maùiv™y
;

21 
	m´Ùeùed
:

22 
ušt32_t
 
n
;

24 
ušt32_t
 
	mpos
;

26 
V®ue
* 
	mv®s
;

28 
boŞ
 
	mowns_v®s
 = 
Œue
;

30 
	mpublic
:

32 
	$SŒ—mšgA¼ay
() {}

35 
	$SŒ—mšgA¼ay
(
ušt32_t
 
n
)

36 : 
	`aùiv™y
(
Ãw
 
	`Aùiv™yS‘
(
n
)), 
	`n
Ò), 
	`v®s
Òew 
V®ue
[n + 1])

38 
	`as£¹
(
v®s
);

39 
	`»wšd
();

40 
	}
}

42 ~
	$SŒ—mšgA¼ay
()

44 ià(
owns_v®s
)

46 
d–‘e
[] 
v®s
;

47 
v®s
 = 
nuÎ±r
;

49 
d–‘e
 
aùiv™y
;

50 
aùiv™y
 = 
nuÎ±r
;

51 
	}
}

55 cÚ¡ 
	gSŒ—mšgA¼ay
& 
	gİ”©Ü
=(cÚ¡ 
SŒ—mšgA¼ay
&èğ
d–‘e
;

58 
	$SŒ—mšgA¼ay
(cÚ¡ 
SŒ—mšgA¼ay
& 
Ùh”
, 
boŞ
 
d“p
 = 
çl£
)

59 : 
	`n
(
Ùh”
.
n
), 
	`aùiv™y
(
Ãw
 
	$Aùiv™yS‘
(*
Ùh”
.
aùiv™y
, 
Œue
 ))

61 
owns_v®s
 = 
d“p
;

62 
v®s
 = 
d“p
 ? (
Ãw
 
V®ue
[
n
 + 1]è: 
Ùh”
.vals;

63 
	`as£¹
(
v®s
);

64 ià(
d“p
)

65 
	`memıy
(
v®s
, 
Ùh”
.v®s, (
V®ue
è* (
n
 + 1));

66 
	`»wšd
();

67 
	}
}

69 
	$‹mpÜ¬y_»size
(
ušt32_t
 
n_
)

71 
	`»wšd
();

72 
aùiv™y
->
	`‹mpÜ¬y_»size
(
n_
);

73 
n
 = 
n_
;

74 
	`»wšd
();

75 
	}
}

77 
ušt32_t
 
	$size
(è{  
n
; 
	}
}

79 
	$ş—r
()

81 
aùiv™y
->
	`ş—r
();

82 
	`»wšd
();

83 
	}
}

85 
	gpublic
:

87 
	$»wšd
()

89 
pos
 = 0;

90 
aùiv™y
->
	`»wšd
();

91 
	}
}

93 
	$push
(
ušt32_t
 
idx
, cÚ¡ 
V®ue
& 
v®
)

97 
v®s
[
aùiv™y
->
	`couÁ
()] = 
v®
;

98 
aùiv™y
->
	`push
(
idx
);

99 
	}
}

101 
boŞ
 
	$pİ
(
ušt32_t
& 
idx
, 
V®ue
& 
v®
)

103 
v®
 = 
v®s
[
pos
++];

104  
aùiv™y
->
	`pİ
(
idx
);

105 
	}
}

107 
boŞ
 
	$Ãxt
(
ušt32_t
& 
idx
, 
V®ue
& 
v®
)

109 
v®
 = 
v®s
[
pos
++];

110  
aùiv™y
->
	`Ãxt
(
idx
);

111 
	}
}

113 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

114 
boŞ
 
	$advªû
(
ušt32_t
& 
idx
, 
V®ue
& 
v®
)

116 ià(
de¡ruùive
)

117  
	`pİ
(
idx
, 
v®
);

119  
	`Ãxt
(
idx
, 
v®
);

120 
	}
}

122 
	gpublic
:

124 
‹m¶©e
 <
boŞ
 
de¡ruùive
 = 
çl£
>

125 
ušt32_t
 
£rŸlize_što
(*& 
blob
);

127 
de£rŸlize_äom
(cÚ¡ * 
blob
);

129 
de£rŸlize_äom
(cÚ¡ * 
blob
, 
ušt32_t
 
sub_size
);

131 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
 = 
çl£
>

132 
ušt32_t
 
£rŸlize_što_dyÇmic
(*& 
blob
);

134 
de£rŸlize_äom_dyÇmic
(cÚ¡ * 
blob
, 
ušt32_t
 
sub_size
);

136 
	g´Ùeùed
:

138 * 
	$Ãw_blob
(
ušt32_t
 
nby‹s
è{  
Ãw
 [nby‹s]; 
	}
}

140 
	$d–‘e_blob
(* 
blob
è{ 
d–‘e
[] ((*èblob); 
	}
}

143 
ušt32_t
 
	$blob_nby‹s
(
ušt32_t
 
couÁ
)

145 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`blob_nby‹s
(
couÁ
);

146 
ušt32_t
 
max_·ddšg
 = 
	`®ignof
(
V®ue
);

147 
ušt32_t
 
v®ues_nby‹s
 = 
couÁ
 * (
V®ue
);

148  
aùiv™y_nby‹s
 + 
max_·ddšg
 + 
v®ues_nby‹s
;

149 
	}
}

151 
ušt32_t
 
	$couÁ
(è{  
aùiv™y
->
	`couÁ
(); 
	}
}

153 
	g´iv©e
:

154 
V®ue
* 
blob_v®ues_off£t
(cÚ¡ * 
blob
, 
ušt32_t
 
aùiv™y_nby‹s
, ušt32_ˆ
v®ues_nby‹s
);

159 
	~"¡»amšg_¬¿y.hµ
"

	@src/structures/streaming_array.hpp

1 
	~<boo¡/¬chive/bš¬y_ßrchive.hµ
>

2 
	~<boo¡/¬chive/bš¬y_Ÿrchive.hµ
>

3 
	~<boo¡/io¡»ams/deviû/back_š£¹”.hµ
>

4 
	~<boo¡/io¡»ams/¡»am.hµ
>

7 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
>

8 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

9 
ušt32_t
 
	gSŒ—mšgA¼ay
<
	gV®ue
, 
	gAùiv™yS‘
>::
	$£rŸlize_što
(*& 
blob
)

12 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
V®ue
>::
v®ue
)

13  
SŒ—mšgA¼ay
::
‹m¶©e
 
£rŸlize_što_dyÇmic
<
de¡ruùive
>(
blob
);

15 
ušt32_t
 
Çùive
 = 
aùiv™y
->
	`couÁ
();

17 
V®ue
 
v®
;

18 
ušt32_t
 
idx
, 
x
 = 0;

20 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
£rŸlize_što
<
çl£
 >(
blob
);

21 
ušt32_t
 
v®ues_nby‹s
 = 
Çùive
 * (
V®ue
);

23 
V®ue
* 
v®ues
 = 
	`blob_v®ues_off£t
(
blob
, 
aùiv™y_nby‹s
, 
v®ues_nby‹s
);

25 
	`»wšd
();

26 
SŒ—mšgA¼ay
::
‹m¶©e
 
advªû
<
de¡ruùive
>(
idx
, 
v®
))

27 
v®ues
[
x
++] = 
v®
;

28 
	`»wšd
();

30 ià(
nÙ
 
¡d
::
is_§me
<
V®ue
, 
Em±y
>::
v®ue
)

32  (
ušt32_t
è((*è(
v®ues
 + 
x
è- (*è
blob
);

34  (
ušt32_t
è((*è(
v®ues
è- (*è
blob
);

35 
	}
}

37 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
>

38 
	gSŒ—mšgA¼ay
<
	gV®ue
, 
	gAùiv™yS‘
>::
	$de£rŸlize_äom
(cÚ¡ * 
blob
)

40 
	`de£rŸlize_äom
(
blob
, 
	`size
());

41 
	}
}

43 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
>

44 
	gSŒ—mšgA¼ay
<
	gV®ue
, 
	gAùiv™yS‘
>::
	$de£rŸlize_äom
(cÚ¡ * 
blob
, 
ušt32_t
 
sub_size
)

47 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
V®ue
>::
v®ue
)

49 
	`de£rŸlize_äom_dyÇmic
(
blob
, 
sub_size
);

53 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`de£rŸlize_äom
(
blob
, 
sub_size
);

55 
ušt32_t
 
Çùive
 = 
aùiv™y
->
	`couÁ
();

57 
ušt32_t
 
v®ues_nby‹s
 = 
Çùive
 * (
V®ue
);

59 
V®ue
* 
v®ues
 = 
	`blob_v®ues_off£t
(
blob
, 
aùiv™y_nby‹s
, 
v®ues_nby‹s
);

61 
	`memıy
(
v®s
, 
v®ues
, 
Çùive
 * (
V®ue
));

63 
	`»wšd
();

64 
	}
}

66 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
>

67 
V®ue
* 
	gSŒ—mšgA¼ay
<
	gV®ue
, 
	gAùiv™yS‘
>::
	$blob_v®ues_off£t
(

68 cÚ¡ * 
blob
, 
ušt32_t
 
aùiv™y_nby‹s
, ušt32_ˆ
v®ues_nby‹s
)

70 * 
±r
 = (*è
blob
 + 
aùiv™y_nby‹s
;

72 
size_t
 
¥aû
 = 
SIZE_MAX
;

73 
V®ue
* 
»tv®
 = (V®ue*è
¡d
::
	`®ign
(
	`®ignof
(V®ue), 
v®ues_nby‹s
, 
±r
, 
¥aû
);

74 
	`as£¹
(
»tv®
);

76  
»tv®
;

77 
	}
}

81 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
>

82 
	g‹m¶©e
 <
boŞ
 
	gde¡ruùive
>

83 
ušt32_t
 
	gSŒ—mšgA¼ay
<
	gV®ue
, 
	gAùiv™yS‘
>::
	$£rŸlize_što_dyÇmic
(*& 
blob
)

85 
ušt32_t
 
Çùive
 = 
aùiv™y
->
	`couÁ
();

86 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`blob_nby‹s
(
Çùive
);

88 ià(
Çùive
 == 0)

90 
blob
 = 
Ãw
 [
aùiv™y_nby‹s
];

93 
ušt32_t
 
aùiv™y_nby‹s_
 = 
aùiv™y
->
£rŸlize_što
<
çl£
 >(
blob
);

94 
	`as£¹
(
aùiv™y_nby‹s
 =ğ
aùiv™y_nby‹s_
);

96 
	`»wšd
();

98  
aùiv™y_nby‹s
;

102 * 
tmp_blob
 = 
Ãw
 [
aùiv™y_nby‹s
];

103 
ušt32_t
 
aùiv™y_nby‹s_
 = 
aùiv™y
->
£rŸlize_što
<
çl£
 >(
tmp_blob
);

104 
	`as£¹
(
aùiv™y_nby‹s
 =ğ
aùiv™y_nby‹s_
);

107 
¡d
::
¡ršg
* 
v®ues
 = 
Ãw
 std::¡ršg[
Çùive
];

109 
ušt32_t
 
v®ues_nby‹s
 = 0u;

111 
V®ue
 
v®
;

112 
ušt32_t
 
idx
, 
x
 = 0;

114 
	`»wšd
();

115 
advªû
<
de¡ruùive
>(
idx
, 
v®
))

118 
usšg
 
boo¡
::
io¡»ams
::
back_š£¹_deviû
;

119 
usšg
 
boo¡
::
io¡»ams
::
¡»am
;

120 
back_š£¹_deviû
<
¡d
::
¡ršg
> 
	`š£¹”
(
v®ues
[
x
]);

121 
¡»am
<
back_š£¹_deviû
<
¡d
::
¡ršg
>> 
	`s
(
š£¹”
);

122 
boo¡
::
¬chive
::
bš¬y_ßrchive
 
	`ß
(
s
);

123 
ß
 << 
v®
;

124 
s
.
	`æush
();

126 
v®ues_nby‹s
 +ğ
v®ues
[
x
].
	`size
();

127 
x
++;

130 
	`»wšd
();

135 
ušt32_t
 
sizes_nby‹s
 = (ušt32_tè* 
Çùive
;

136 
ušt32_t
 
blob_nby‹s
 = 
aùiv™y_nby‹s
 + 
sizes_nby‹s
 + 
v®ues_nby‹s
;

139 
blob
 = 
Ãw
 [
blob_nby‹s
];

142 
	`memıy
(
blob
, 
tmp_blob
, 
aùiv™y_nby‹s
);

143 
d–‘e
[] 
tmp_blob
;

147 
size_t
 
¥aû
 = 
SIZE_MAX
;

149 * 
±r
 = ((*è
blob
è+ 
aùiv™y_nby‹s
;

150 
ušt32_t
* 
sizes
 = (ušt32_t*è
¡d
::
	`®ign
(
	`®ignof
(ušt32_t), (ušt32_t), 
±r
, 
¥aû
);

152 
±r
 = ((*è
sizes
è+ 
sizes_nby‹s
;

153 * 
v®ues_
 = (*è
¡d
::
	`®ign
(
	`®ignof
(), (), 
±r
, 
¥aû
);

155 autØ
i
 = 0; i < 
Çùive
; i++)

157 
ušt32_t
 
nby‹s
 = (ušt32_tè
v®ues
[
i
].
	`size
();

158 
sizes
[
i
] = 
nby‹s
;

159 
	`memıy
(
v®ues_
, 
v®ues
[
i
].
	`c_¡r
(), 
nby‹s
);

160 
v®ues_
 +ğ
nby‹s
;

163 
d–‘e
[] 
v®ues
;

165  
blob_nby‹s
;

166 
	}
}

168 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gAùiv™yS‘
>

169 
	gSŒ—mšgA¼ay
<
	gV®ue
, 
	gAùiv™yS‘
>::
	$de£rŸlize_äom_dyÇmic
(

170 cÚ¡ * 
blob
, 
ušt32_t
 
sub_size
)

172 
ušt32_t
 
aùiv™y_nby‹s
 = 
aùiv™y
->
	`de£rŸlize_äom
(
blob
, 
sub_size
);

174 
ušt32_t
 
Çùive
 = 
aùiv™y
->
	`couÁ
();

176 ià(
Çùive
 == 0)

178 
	`»wšd
();

184 
size_t
 
¥aû
 = 
SIZE_MAX
;

186 * 
±r
 = (*è
blob
 + 
aùiv™y_nby‹s
;

187 
ušt32_t
* 
sizes
 = (ušt32_t*è
¡d
::
	`®ign
(
	`®ignof
(ušt32_t), (ušt32_t), 
±r
, 
¥aû
);

188 
ušt32_t
 
sizes_nby‹s
 = (ušt32_tè* 
Çùive
;

190 
±r
 = ((*è
sizes
è+ 
sizes_nby‹s
;

191 * 
v®ues
 = (*è
¡d
::
	`®ign
(
	`®ignof
(), (), 
±r
, 
¥aû
);

192 
ušt32_t
 
v®ues_nby‹s
 = 0u;

194 autØ
i
 = 0; i < 
Çùive
; i++)

196 
V®ue
 
v®
;

198 
usšg
 
boo¡
::
io¡»ams
::
basic_¬¿y_sourû
;

199 
usšg
 
boo¡
::
io¡»ams
::
¡»am
;

200 
basic_¬¿y_sourû
<> 
	`deviû
(
v®ues
, (
size_t
è
sizes
[
i
]);

201 
¡»am
<
basic_¬¿y_sourû
<>> 
	`s
(
deviû
);

202 
boo¡
::
¬chive
::
bš¬y_Ÿrchive
 
	`Ÿ
(
s
);

203 
Ÿ
 >> 
v®
;

204 
v®s
[
i
] = 
v®
;

205 
v®ues
 +ğ
sizes
[
i
];

207 
v®ues_nby‹s
 +ğ
sizes
[
i
];

210 
	`»wšd
();

211 
	}
}

	@src/tools/cw2bin.cpp

1 
	~<io¡»am
>

2 
	~<f¡»am
>

3 
	~<unÜd”ed_m­
>

4 
	~<veùÜ
>

5 
	~<boo¡/mpi/’vœÚm’t.hµ
>

6 
	~<boo¡/mpi/communiÿtÜ.hµ
>

7 
	~<boo¡/£rŸliz©iÚ/veùÜ.hµ
>

8 
	~<boo¡/£rŸliz©iÚ/ut™y.hµ
>

9 
	~<boo¡/mpi/cŞËùives.hµ
>

12 
usšg
 
Çme¥aû
 
	g¡d
;

13 
Çme¥aû
 
	gmpi
 = 
boo¡
::
mpi
;

16 
¡ršg
 
	gLOG
;

18 
usšg
 
	gvid_t
 = 
ušt32_t
;

19 
usšg
 
	gew_t
 = 
ušt32_t
;

21 
	sTrË


23 
vid_t
 
	m¤c
, 
	md¡
;

24 
ew_t
 
	mweight
;

26 
TrË
(
vid_t
 
¤c
 = 0, vid_ˆ
d¡
 = 0, 
ew_t
 
weight
 = 0)

27 : 
¤c
(¤c), 
d¡
(d¡), 
weight
(weight) {}

29 
wr™e
(
o¡»am
& 
os
) const

30 { 
	mos
.
wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
this
), (
TrË
)); }

33 
	sSŒHash


35 
size_t
 
İ”©Ü
()(
	m¡d
::
¡ršg
 cÚ¡& 
s
) const

37 
size_t
 
»suÉ
 = 2166136261U;

38 autØ
	m™”
 = 
s
.
begš
(); i‹¸!ğs.
’d
(); ++iter)

39 
	m»suÉ
 = 127 * 
»suÉ
 + 
¡©ic_ÿ¡
<>(*
™”
);

40  
	m»suÉ
;

45 
	$maš
(
¬gc
, * 
¬gv
[])

57 
mpi
::
’vœÚm’t
 
	`’v
(
¬gc
, 
¬gv
);

58 
mpi
::
communiÿtÜ
 
wÜld
;

60 
¿nk
 = 
wÜld
.
	`¿nk
();

62 
cÚ¡ex´
 
NPARTS_IN
 = 20;

63 
cÚ¡ex´
 
NPARTS_OUT
 = 40;

65 
LOG
 = "[" + 
	`to_¡ršg
(
¿nk
) + "] ";

67 
¡ršg
 
dœ
 = "/datasets/suwaileh/clueweb12/b/la3";

72 ià(
¿nk
 == 0)

73 
cout
 << 
LOG
 << "R—dšg doc_id couÁs" << 
’dl
;

75 
vid_t
 
doc_id_couÁs
[
NPARTS_IN
] = {0};

76 
vid_t
 
doc_id_off£ts
[
NPARTS_IN
] = {0};

77 
if¡»am
 
	`fš_doc_id_couÁs
(
dœ
 + "/doc-id-map/counts");

78 
	`as£¹
(
fš_doc_id_couÁs
.
	`good
());

79 
i
 = 0; i < 
NPARTS_IN
; i++)

80 
fš_doc_id_couÁs
 >> 
doc_id_couÁs
[
i
];

81 
fš_doc_id_couÁs
.
	`şo£
();

82 
i
 = 1; i < 
NPARTS_IN
; i++)

83 
doc_id_off£ts
[
i
] = 
doc_id_couÁs
[i-1] + doc_id_offsets[i-1];

90 ià(
¿nk
 == 0)

91 
cout
 << 
LOG
 << "R—dšg (doc_id,”m_¡r,fèedge äom iÅuˆg¿ph fe" << 
’dl
;

95 
if¡»am
 
	`fš_g¿ph
(
dœ
 + "/g¿ph/" + (
¿nk
/2 < 10 ? "0" : ""è+ 
	`to_¡ršg
(rank/2));

96 ià(
nÙ
 
fš_g¿ph
.
	`good
())

98 
cout
 << 
LOG
 << "Could‚Ù„—d iÅuˆg¿ph f" << 
¿nk
 / 2 << 
’dl
;

99 
	`ex™
(-1);

103 
fš_g¿ph
.
	`£ekg
(0, fš_g¿ph.
’d
);

104 
size_t
 
mid_off£t
 = 
fš_g¿ph
.
	`‹Îg
() / 2;

105 
fš_g¿ph
.
	`£ekg
(
mid_off£t
);

106 
dummy
[1024];

107 
fš_g¿ph
.
	`g‘lše
(
dummy
, 1024);

108 
mid_off£t
 = 
fš_g¿ph
.
	`‹Îg
();

110 
fš_g¿ph
.
	`£ekg
(
¿nk
 % 2 =ğ0 ? 0 : 
mid_off£t
);

114 ià(
¿nk
 =ğ0è
cout
 << 
LOG
 << "S¹šg fœ¡…ass" << 
’dl
;

116 
unÜd”ed_m­
<
¡ršg
, 
vid_t
>* 
‹rms_ªd_couÁs
[
NPARTS_OUT
];

118 
i
 = 0; i < 
NPARTS_OUT
; i++)

119 
‹rms_ªd_couÁs
[
i
] = 
Ãw
 
unÜd”ed_m­
<
¡ršg
, 
vid_t
>();

121 
nÙ
 
fš_g¿ph
.
	`eof
())

123 
¡ršg
 
‹rm_¡r
;

124 
·œ
<
vid_t
, 
ew_t
> 
doc_id_tf
;

126 
fš_g¿ph
 >> 
doc_id_tf
.
fœ¡
;

127 
fš_g¿ph
 >> 
‹rm_¡r
;

128 ià(
fš_g¿ph
.
	`³ek
() == '\n') ;

129 
fš_g¿ph
 >> 
doc_id_tf
.
£cÚd
;

131 ià(
nÙ
 
fš_g¿ph
.
	`good
(è
Ü
 fš_g¿ph.
	`eof
())

134 
SŒHash
 
¡r_hash
;

135 
size_t
 
h
 = 
	`¡r_hash
(
‹rm_¡r
);

137 (*
‹rms_ªd_couÁs
[
h
 % 
NPARTS_OUT
])[
‹rm_¡r
]++;

139 ià(
¿nk
 % 2 =ğ0 
ªd
 
fš_g¿ph
.
	`‹Îg
(è>ğ
mid_off£t
)

143 ià(
¿nk
 =ğ0è
cout
 << 
LOG
 << "Com¶‘ed fœ¡…ass" << 
’dl
;

149 
unÜd”ed_m­
<
size_t
, 
veùÜ
<
·œ
<
vid_t
, 
ew_t
>>>* 
‹rm_occu»nûs
[
NPARTS_OUT
];

151 
i
 = 0; i < 
NPARTS_OUT
; i++)

152 
‹rm_occu»nûs
[
i
] = 
Ãw
 
unÜd”ed_m­
<
size_t
, 
veùÜ
<
·œ
<
vid_t
, 
ew_t
>>>();

154 
veùÜ
<
¡ršg
>* 
æ©_‹rms
[
NPARTS_OUT
];

155 
i
 = 0; i < 
NPARTS_OUT
; i++)

156 
æ©_‹rms
[
i
] = 
Ãw
 
veùÜ
<
¡ršg
>();

158 
i
 = 0; i < 
NPARTS_OUT
; i++)

160 
æ©_‹rms
[
i
]->
	`»£rve
(
‹rms_ªd_couÁs
[i]->
	`size
());

161 autØ
‹rm
 : *
‹rms_ªd_couÁs
[
i
])

163 
æ©_‹rms
[
i
]->
	`push_back
(
‹rm
.
fœ¡
);

164 
SŒHash
 
¡r_hash
;

165 
size_t
 
h
 = 
	`¡r_hash
(
‹rm
.
fœ¡
);

166 (*
‹rm_occu»nûs
[
i
])[
h
].
	`»£rve
(
‹rm
.
£cÚd
);

170 ià(
¿nk
 =ğ0è
cout
 << 
LOG
 << "S¹šg secÚd…ass" << 
’dl
;

172 
fš_g¿ph
.
	`£ekg
(
¿nk
 % 2 =ğ0 ? 0 : 
mid_off£t
);

174 
nÙ
 
fš_g¿ph
.
	`eof
())

176 
¡ršg
 
‹rm_¡r
;

177 
·œ
<
vid_t
, 
ew_t
> 
doc_id_tf
;

179 
fš_g¿ph
 >> 
doc_id_tf
.
fœ¡
;

180 
fš_g¿ph
 >> 
‹rm_¡r
;

181 ià(
fš_g¿ph
.
	`³ek
() == '\n') ;

182 
fš_g¿ph
 >> 
doc_id_tf
.
£cÚd
;

184 ià(
nÙ
 
fš_g¿ph
.
	`good
(è
Ü
 fš_g¿ph.
	`eof
())

187 
doc_id_tf
.
fœ¡
 +ğ
doc_id_off£ts
[
¿nk
/2];

189 
SŒHash
 
¡r_hash
;

190 
size_t
 
h
 = 
	`¡r_hash
(
‹rm_¡r
);

192 (*
‹rm_occu»nûs
[
h
 % 
NPARTS_OUT
])[h].
	`push_back
(
doc_id_tf
);

194 ià(
¿nk
 % 2 =ğ0 
ªd
 
fš_g¿ph
.
	`‹Îg
(è>ğ
mid_off£t
)

198 ià(
¿nk
 =ğ0è
cout
 << 
LOG
 << "Com¶‘ed secÚd…ass" << 
’dl
;

203 ià(
¿nk
 == 0)

204 
cout
 << 
LOG
 << "M­pšgƒdge tØ‹rm ªd„educšg”ms" << 
’dl
;

209 
veùÜ
<
·œ
<
size_t
, veùÜ<·œ<
vid_t
, 
ew_t
>>>>* 
æ©_‹rm_occu»nûs
[
NPARTS_OUT
];

211 
i
 = 0; i < 
NPARTS_OUT
; i++)

212 
æ©_‹rm_occu»nûs
[
i
] = 
Ãw
 
veùÜ
<
·œ
<
size_t
, veùÜ<·œ<
vid_t
, 
ew_t
>>>>();

214 
i
 = 0; i < 
NPARTS_OUT
; i++)

216 ià(
i
 !ğ
¿nk
)

218 
æ©_‹rm_occu»nûs
[
i
]->
	`»£rve
(
‹rm_occu»nûs
[i]->
	`size
());

219 autØ
‹rm
 : *
‹rm_occu»nûs
[
i
])

220 
æ©_‹rm_occu»nûs
[
i
]->
	`push_back
(
‹rm
);

221 
‹rm_occu»nûs
[
i
]->
	`ş—r
();

222 
d–‘e
 
‹rm_occu»nûs
[
i
];

227 
i
 = 0; i < 
NPARTS_OUT
; i++)

229 ià(
i
 =ğ
¿nk
)

233 
j
 = 0; j < 
NPARTS_OUT
; j++)

235 ià(
j
 !ğ
¿nk
)

237 
wÜld
.
	`£nd
(
j
, 
i
 * 100 + j, *
æ©_‹rms
[j]);

238 
æ©_‹rms
[
j
]->
	`ş—r
();

239 
d–‘e
 
æ©_‹rms
[
j
];

241 
wÜld
.
	`£nd
(
j
, 
i
 * 200 + j, *
æ©_‹rm_occu»nûs
[j]);

242 
æ©_‹rm_occu»nûs
[
j
]->
	`ş—r
();

243 
d–‘e
 
æ©_‹rm_occu»nûs
[
j
];

252 autØ
æ©_‹rms_i
 = 
Ãw
 
veùÜ
<
¡ršg
>();

253 
wÜld
.
	`»cv
(
i
, i * 100 + 
¿nk
, *
æ©_‹rms_i
);

254 autØ
‹rm
 : *
æ©_‹rms_i
)

255 (*
‹rms_ªd_couÁs
[
¿nk
])[
‹rm
]++;

256 
æ©_‹rms_i
->
	`ş—r
();

257 
d–‘e
 
æ©_‹rms_i
;

259 autØ
æ©_‹rm_occu»nûs_i
 = 
Ãw
 
veùÜ
<
·œ
<
size_t
, veùÜ<·œ<
vid_t
, 
ew_t
>>>>();

260 
wÜld
.
	`»cv
(
i
, i * 200 + 
¿nk
, *
æ©_‹rm_occu»nûs_i
);

261 autØ
‹rm
 : *
æ©_‹rm_occu»nûs_i
)

263 (*
‹rm_occu»nûs
[
¿nk
])[
‹rm
.
fœ¡
].
	`»£rve
Ñ”m.
£cÚd
.
	`size
()

264 + (*
‹rm_occu»nûs
[
¿nk
])[
‹rm
.
fœ¡
].
	`size
());

265 autØ
doc_id_tf
 : 
‹rm
.
£cÚd
)

266 (*
‹rm_occu»nûs
[
¿nk
])[
‹rm
.
fœ¡
].
	`push_back
(
doc_id_tf
);

268 
æ©_‹rm_occu»nûs_i
->
	`ş—r
();

269 
d–‘e
 
æ©_‹rm_occu»nûs_i
;

276 ià(
¿nk
 == 0)

277 
cout
 << 
LOG
 << "C®cuÏtšg”m_id off£ts" << 
’dl
;

279 
vid_t
 
‹rm_id_couÁs
[
NPARTS_OUT
] = {0};

280 
vid_t
 
‹rm_id_off£ts
[
NPARTS_OUT
] = {0};

281 
mpi
::
	`®l_g©h”
(
wÜld
, (
vid_t
è(*
‹rms_ªd_couÁs
[
¿nk
]).
	`size
(), 
‹rm_id_couÁs
);

282 
i
 = 1; i < 
NPARTS_OUT
; i++)

283 
‹rm_id_off£ts
[
i
] =”m_id_off£ts[i-1] + 
‹rm_id_couÁs
[i-1];

289 ià(
¿nk
 == 0)

290 
cout
 << 
LOG
 << "Writing (doc_id,erm_id,f)ƒdges‡nd "

291 << "Ñ”m_¡r,”m_idèm­pšgs" << 
’dl
;

294 
of¡»am
 
	`fout_g¿ph
(
dœ
 + "/bš/şueweb12_ÿtb.w.bš" + 
	`to_¡ršg
(
¿nk
), 
ios
::
bš¬y
);

295 ià(
nÙ
 
fout_g¿ph
.
	`good
())

297 
cout
 << 
LOG
 << "E¼Ü c»©šg g¿ph ouuˆfe" << 
’dl
;

298 
	`ex™
(-1);

301 
of¡»am
 
	`fout_‹rm_id_m­
(
dœ
 + "/‹rm-id-m­/" + (
¿nk
 < 10 ? "0" : ""è+ 
	`to_¡ršg
(rank));

302 ià(
nÙ
 
fout_‹rm_id_m­
.
	`good
())

304 
cout
 << 
LOG
 << "E¼Ü c»©šg”m_id m­pšg fe" << 
’dl
;

305 
	`ex™
(-1);

308 
vid_t
 
‹rm_id
 = 1 + 
‹rm_id_off£ts
[
¿nk
];

309 autØ
‹rm
 : *
‹rms_ªd_couÁs
[
¿nk
])

311 
fout_‹rm_id_m­
 << 
‹rm
.
fœ¡
 << " " << 
‹rm_id
 << 
’dl
;

312 
SŒHash
 
¡r_hash
;

313 
size_t
 
h
 = 
	`¡r_hash
(
‹rm
.
fœ¡
);

314 autØ
doc_id_tf
 : (*
‹rm_occu»nûs
[
¿nk
])[
h
])

316 
TrË
 
	`e
(
doc_id_tf
.
fœ¡
, 
‹rm_id
, doc_id_tf.
£cÚd
);

317 
e
.
	`wr™e
(
fout_g¿ph
);

319 
‹rm_id
++;

322 
fout_g¿ph
.
	`şo£
();

323 
fout_‹rm_id_m­
.
	`şo£
();

325 
‹rms_ªd_couÁs
[
¿nk
]->
	`ş—r
();

326 
d–‘e
 
‹rms_ªd_couÁs
[
¿nk
];

328 
‹rm_occu»nûs
[
¿nk
]->
	`ş—r
();

329 
d–‘e
 
‹rm_occu»nûs
[
¿nk
];

331 
wÜld
.
	`b¬r›r
();

334 ià(
¿nk
 == 0)

335 
cout
 << 
LOG
 << "DÚe" << 
’dl
;

338 
	}
}

	@src/tools/mtx2bin.cpp

1 
	~<c¡dio
>

2 
	~<io¡»am
>

3 
	~<f¡»am
>

4 
	~<veùÜ
>

7 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	$maš
(
¬gc
, * 
¬gv
[])

12 
cout


17 << 
’dl
;

19 
cout
 << "U§ge: " << 
¬gv
[0] << " <filepath_in> <filepath_out> "

20 << 
’dl
 << "\t [-hi[o]]„ead in first‚on-comment†ine‡s header [and write [o]ut]"

21 << 
’dl
 << "\t [-wi]„ead inƒdge weights (must be int or double) "

22 << 
’dl
 << "\t [-wo{i|d}] write outƒdge weights ({i}nt/{d}ouble) "

23 << 
’dl
 << "\t (rand [1,128] if‚one given)"

24 << 
’dl
;

26 ià(
¬gc
 < 3)

29 
¡ršg
 
å©h_š
 = 
¬gv
[1];

30 
¡ršg
 
å©h_out
 = 
¬gv
[2];

32 
boŞ
 
h—d”_š
 = 
çl£
;

33 
boŞ
 
h—d”_out
 = 
çl£
;

34 
boŞ
 
weights_š
 = 
çl£
;

35 
boŞ
 
weights_out
 = 
çl£
;

36 
boŞ
 
weights_št
 = 
çl£
;

37 
boŞ
 
weights_¿nd
 = 
çl£
;

39 autØ
i
 = 3; i < 
¬gc
; i++)

41 ià(
	`¡ršg
(
¬gv
[
i
]è=ğ"-hi" 
Ü
 string(argv[i]) == "-hio")

42 
h—d”_š
 = 
Œue
;

43 ià(
	`¡ršg
(
¬gv
[
i
]) == "-hio")

44 
h—d”_out
 = 
Œue
;

45 ià(
	`¡ršg
(
¬gv
[
i
]) == "-wi")

46 
weights_š
 = 
Œue
;

47 ià(
	`¡ršg
(
¬gv
[
i
]è=ğ"-woi" 
Ü
 string(argv[i]) == "-wod")

48 
weights_out
 = 
Œue
;

49 ià(
	`¡ršg
(
¬gv
[
i
]) == "-woi")

50 
weights_št
 = 
Œue
;

53 
weights_¿nd
 = 
nÙ
 
weights_š
 
ªd
 
weights_out
;

55 
if¡»am
 
	`fš
(
å©h_š
.
	`c_¡r
());

56 
of¡»am
 
	`fout
(
å©h_out
.
	`c_¡r
(), 
ios
::
bš¬y
);

59 
veùÜ
<> 
	`bufãr
(1024);

60 
c
 = (è
fš
.
	`³ek
();

61 
c
 == '%' || c == '#')

63 
fš
.
	`g‘lše
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

64 
c
 = (è
fš
.
	`³ek
();

68 
ušt32_t
 
n
, 
m
;

69 
ušt64_t
 
Âz
 = 0;

70 ià(
h—d”_š
)

74 
fš
 >> 
n
 >> 
m
 >> 
Âz
;

75 
cout
 << "H—d”: " << 
n
 << " " << 
m
 << " " << 
Âz
 << 
’dl
;

78 ià(
h—d”_out
)

80 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
n
), (
ušt32_t
));

81 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
m
), (
ušt32_t
));

82 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
Âz
), (
ušt64_t
));

87 
ušt32_t
 
i
, 
j
;

88 
wd
 = 1;

89 
	`¤ªd
(0);

90 !
fš
.
	`eof
())

92 
fš
 >> 
i
;

93 ià(
fš
.
	`eof
()) ;

94 
fš
 >> 
j
;

96 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
i
), (
ušt32_t
));

97 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
j
), (
ušt32_t
));

98 ià(
weights_š
)

99 
fš
 >> 
wd
;

100 ià(
weights_out
)

102 ià(
weights_¿nd
)

103 
wd
 = 1 + (
	`¿nd
() % 128);

104 ià(
weights_št
)

106 
ušt32_t
 
wi
 = (ušt32_tè
wd
;

107 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
wi
), (
ušt32_t
));

110 
fout
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(&
wd
), ());

114 
fš
.
	`şo£
();

115 
fout
.
	`şo£
();

116 
	}
}

	@src/utils/colgrp.h

5 #iâdeà
COLGRP_H


6 
	#COLGRP_H


	)

8 
	~"uts/loÿtÜ.h
"

9 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

12 
	g‹m¶©e
 <
şass
 
	gTe
>

13 
	sAÂÙ©edCŞG½


15 
	m¡d
::
veùÜ
<
Te
*> 
loÿl_tes
;

17 
ušt32_t
 
	mcg
, 
	mjth
;

18 
ušt32_t
 
	moff£t
, 
	m’dpos
;

19 
št32_t
 
	mËad”
;

20 
ušt32_t
 
	mkth
;

22 
ušt32_t
 
¿nge
()

23 {  
	m’dpos
 - 
	moff£t
; }

27 
	g‹m¶©e
 <
şass
 
	gTe
>

28 
	gProûs£dCŞG½
 : 
AÂÙ©edCŞG½
<
Te
>

30 
usšg
 
BV
 = 
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>;

33 
LoÿtÜ
* 
	gloÿtÜ
;

35 
BV
* 
	gloÿl
;

36 
BV
* 
	g»guÏr
;

37 
BV
* 
	gsourû
;

40 
	g‹m¶©e
 <
şass
 
	gTe
>

41 
	gCSCCŞG½
 : 
Proûs£dCŞG½
<
Te
>

	@src/utils/common.h

1 #iâdeà
COMMON_H


2 
	#COMMON_H


	)

4 
	~<c¡dšt
>

5 
	~<boo¡/£rŸliz©iÚ/acûss.hµ
>

6 
	~<boo¡/£rŸliz©iÚ/veùÜ.hµ
>

7 
	~"uts/log.h
"

11 
	eP¬t™iÚšg


13 
	m_1D_ROW
,

14 
	m_1D_COL
,

15 
_2D


23 
	g‹m¶©e
 <
şass
 
	gWeight
>

24 
	sTrË


26 
ušt32_t
 
	mrow
, 
	mcŞ
;

28 
Weight
 
	mweight
;

30 
	mTrË
& 
	mİ”©Ü
=(cÚ¡ 
TrË
<
Weight
>& 
Ùh”
)

32 
row
 = 
Ùh”
.row;

33 
	mcŞ
 = 
Ùh”
.
cŞ
;

34 
	mweight
 = 
Ùh”
.
weight
;

35  *
	mthis
;

38 
Weight
 
v®ue
(è{  
	mweight
; }

41 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
TrË
<
Weight
>& 
Ùh”
) const

42 {  
row
 =ğ
Ùh”
.row 
ªd
 
cŞ
 == other.col; }

50 
	sEdgeHash


52 
	m‹m¶©e
 <
şass
 
	mWeight
>

53 
	m¡d
::
size_t
 
İ”©Ü
()(cÚ¡ 
TrË
<
Weight
>& 
x
) const

55 
¡d
::
size_t
 
hr
 = std::
hash
<
ušt32_t
>()(
x
.
row
), 
	mhc
 = std::hash<ušt32_t>()(x.
cŞ
);

56 
	mhr
 ^ğ(
hc
 + 0x9e3779b9 + (
hr
 << 6) + (hr >> 2));

57  
	mhr
;

62 
	sEm±y


64 cÚ¡ 
Em±y
 
	mEMPTY
;

67 
	m‹m¶©e
 <
şass
 
	mArchive
>

68 
£rŸlize
(
Archive
& 
¬chive
, cÚ¡ 
ušt32_t
 
v”siÚ
) {}

71 cÚ¡ 
Em±y
 
	gEm±y
::
EMPTY
 = Empty();

74 
	g‹m¶©e
 <>

75 
	gTrË
<
	gEm±y
>

77 
ušt32_t
 
	grow
, 
	gcŞ
;

79 
	gTrË
& 
	gİ”©Ü
=(cÚ¡ 
TrË
<
Em±y
>& 
Ùh”
)

81 
row
 = 
Ùh”
.row;

82 
	gcŞ
 = 
Ùh”
.
cŞ
;

83  *
	gthis
;

86 
Em±y
 
v®ue
(è{  
	gEm±y
::
EMPTY
; }

89 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
TrË
<
Em±y
>& 
Ùh”
) const

90 {  
row
 =ğ
Ùh”
.row 
ªd
 
cŞ
 == other.col; }

94 
usšg
 
	gPaœ
 = 
TrË
<
Em±y
>;

97 
	sS”ŸlizabË


99 
	mvœtu®
 ~
S”ŸlizabË
() {};

101 
ä›nd
 
şass
 
	mboo¡
::
£rŸliz©iÚ
::
acûss
;

103 
	m‹m¶©e
 <
şass
 
	mArchive
>

104 
£rŸlize
(
Archive
& 
¬chive
, cÚ¡ 
ušt32_t
 
v”siÚ
)

105 { 
	mLOG
.
w¬n
("Serializableypes must implement boost:: serialize(Archive&) \n"); }

109 
	g‹m¶©e
 <
ušt32_t
 
	gdeçuÉ_v®ue
 = 0>

110 
	sIÁeg”W¿µ”


112 
ušt32_t
 
v®ue
;

114 
IÁeg”W¿µ”
(è{ 
	mv®ue
 = 
deçuÉ_v®ue
; }

116 
IÁeg”W¿µ”
(
ušt32_t
 
v®ue
) : value(value) {}

118 
IÁeg”W¿µ”
& 
İ”©Ü
=(cÚ¡ IÁeg”W¿µ”& 
Ùh”
è{ 
v®ue
 = oth”.v®ue;  *
	mthis
; }

120 
boŞ
 
	mİ”©Ü
!=(cÚ¡ 
IÁeg”W¿µ”
& 
Ùh”
ècÚ¡ {  
v®ue
 != other.value; }

121 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
IÁeg”W¿µ”
& 
Ùh”
ècÚ¡ {  
nÙ
 
İ”©Ü
!=(other); }

122 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mIÁeg”W¿µ”
& 
	mÙh”
ècÚ¡ {  
	mv®ue
 < other.value; }

124 
boŞ
 
	mİ”©Ü
!=(
ušt32_t
 
Ùh”
ècÚ¡ {  
v®ue
 != other; }

125 
boŞ
 
	mİ”©Ü
==(
ušt32_t
 
Ùh”
ècÚ¡ {  
nÙ
 
İ”©Ü
!=(other); }

126 
boŞ
 
	mİ”©Ü
<(
ušt32_t
 
	mÙh”
ècÚ¡ {  
	mv®ue
 < other; }

128 
	m‹m¶©e
 <
şass
 
	mArchive
>

129 
£rŸlize
(
Archive
& 
¬chive
, cÚ¡ 
ušt32_t
è{ 
	m¬chive
 & *
	mthis
; }

133 
	g‹m¶©e
 <
şass
 
	gT
>

134 
	gS”ŸlizabËVeùÜ
 : 
¡d
::
veùÜ
<
T
>, 
	gS”ŸlizabË


136 
S”ŸlizabËVeùÜ
() {}

137 
S”ŸlizabËVeùÜ
(
size_t
 
size
è: 
¡d
::
veùÜ
<
T
>(size) {}

138 
S”ŸlizabËVeùÜ
(cÚ¡ 
¡d
::
veùÜ
<
T
>& 
Ùh”
) : std::vector<T>(other) {}

139 
S”ŸlizabËVeùÜ
(cÚ¡ 
¡d
::
veùÜ
<
T
>&& 
Ùh”
) : std::vector<T>(other) {}

141 
‹m¶©e
 <
şass
 
Archive
>

142 
£rŸlize
(
Archive
& 
¬chive
, cÚ¡ 
ušt32_t
è{ 
	g¬chive
 & *((
	g¡d
::
veùÜ
<
T
>*è
this
); }

	@src/utils/csc.h

1 #iâdeà
CSC_H


2 
	#CSC_H


	)

4 
	~<®gÜ™hm
>

5 
	~<ÿs£¹
>

6 
	~<sys/mmª.h
>

7 
	~<unÜd”ed_£t
>

8 
	~"uts/commÚ.h
"

9 
	~"uts/loÿtÜ.h
"

12 
	g‹m¶©e
 <
şass
 
	gWeight
>

13 
	sCSCEÁry


15 
ušt32_t
 
	mglob®_idx
;

17 
ušt32_t
 
	midx
;

19 
Weight
 
	mv®
;

22 
CSCEÁry
() {}

24 
CSCEÁry
(
ušt32_t
 
glob®_idx
, ušt32_ˆ
idx
, cÚ¡ 
TrË
<
Weight
>& 
ŒË
)

25 : 
glob®_idx
(glob®_idx), 
idx
(idx), 
v®
(
ŒË
.
weight
) {}

27 
£t
(
ušt32_t
 
glob®_idx_
, ušt32_ˆ
idx_
, cÚ¡ 
TrË
<
Weight
>& 
ŒË_
)

29 
	mglob®_idx
 = 
glob®_idx_
;

30 
	midx
 = 
idx_
;

31 
	mv®
 = 
ŒË_
.
weight
;

34 cÚ¡ 
Weight
* 
edge_±r
(è{  &
	mv®
; }

38 
	g‹m¶©e
 <>

39 
	gCSCEÁry
<
	gEm±y
>

41 
ušt32_t
 
	gglob®_idx
;

43 
ušt32_t
 
	gidx
;

45 
CSCEÁry
() {}

47 
CSCEÁry
(
ušt32_t
 
glob®_idx
, ušt32_ˆ
idx
, cÚ¡ 
TrË
<
Em±y
>& 
ŒË
)

48 : 
glob®_idx
(glob®_idx), 
idx
(idx) {}

50 
£t
(
ušt32_t
 
glob®_idx_
, ušt32_ˆ
idx_
, cÚ¡ 
TrË
<
Em±y
>& 
ŒË_
)

52 
	gglob®_idx
 = 
glob®_idx_
;

53 
	gidx
 = 
idx_
;

56 cÚ¡ 
Em±y
* 
edge_±r
(è{  &(
	gEm±y
::
EMPTY
); }

60 
	g‹m¶©e
 <
şass
 
	gWeight
>

61 
	sCSC


63 
usšg
 
	mEÁry
 = 
CSCEÁry
<
Weight
>;

65 
ušt32_t
 
	mncŞs
;

67 
ušt32_t
 
	mÃÁr›s
;

69 
ušt32_t
* 
	mcŞ±rs
;

71 
ušt32_t
* 
	mcŞidxs
;

73 
EÁry
* 
	m’Œ›s
;

76 
CSC
(
ušt32_t
 
ncŞs
, ušt32_ˆ
rowg½_off£t
, 
št32_t
 
cŞg½_off£t
,

77 
¡d
::
unÜd”ed_£t
<
TrË
<
Weight
>, 
EdgeHash
>* 
ŒËs
,

78 cÚ¡ 
LoÿtÜ
& 
loÿtÜ
, cÚ¡ LoÿtÜ& 
cŞg½_loÿtÜ
, cÚ¡ LoÿtÜ& 
glob®_loÿtÜ
)

79 : 
ncŞs
ÒcŞs), 
ÃÁr›s
(
ŒËs
->
size
())

84 
	mcŞ±rs
 = (
ušt32_t
*è
mm­
(
nuÎ±r
, (
ncŞs
 + 1è* (ušt32_t), 
PROT_READ
 | 
PROT_WRITE
,

85 
MAP_ANONYMOUS
 | 
MAP_PRIVATE
, -1, 0);

86 
as£¹
(
cŞ±rs
 !ğ
nuÎ±r
);

87 
	mcŞidxs
 = (
ušt32_t
*è
mm­
(
nuÎ±r
, (
ncŞs
 + 1è* (ušt32_t), 
PROT_READ
 | 
PROT_WRITE
,

88 
MAP_ANONYMOUS
 | 
MAP_PRIVATE
, -1, 0);

89 
as£¹
(
cŞidxs
 !ğ
nuÎ±r
);

90 
	m’Œ›s
 = (
EÁry
*è
mm­
(
nuÎ±r
, 
ÃÁr›s
 * (EÁry), 
PROT_READ
 | 
PROT_WRITE
,

91 
MAP_ANONYMOUS
 | 
MAP_PRIVATE
, -1, 0);

92 
as£¹
(
’Œ›s
 !ğ
nuÎ±r
);

94 auto& 
	mŒË
 : *
ŒËs
)

96 ++
cŞ±rs
[
cŞg½_loÿtÜ
[
ŒË
.
cŞ
 - 
cŞg½_off£t
]];

97 
	mcŞidxs
[
cŞg½_loÿtÜ
[
ŒË
.
cŞ
 - 
cŞg½_off£t
]] =riple.col;

101 
	m¡d
::
·¹Ÿl_sum
(
cŞ±rs
, cŞ±r + 
ncŞs
 + 1, colptrs);

103 auto& 
	mŒË
 : *
ŒËs
)

106 
ušt32_t
 
off£t
 = 
loÿtÜ
[
ŒË
.
row
] <†oÿtÜ.
ÄeguÏr
() ? 0 :†ocator.nregular();

107 
ušt32_t
 
	mglob®_off£t


108 ğ
glob®_loÿtÜ
[
ŒË
.
row
] < glob®_loÿtÜ.
ÄeguÏr
() ? 0 : global_locator.nregular();

110 
as£¹
(
glob®_loÿtÜ
.
ÄeguÏr
(è>ğ
loÿtÜ
.nregular());

111 
as£¹
(
glob®_loÿtÜ
[
ŒË
.
row
] >ğ
loÿtÜ
[triple.row]);

112 
as£¹
((
glob®_loÿtÜ
[
ŒË
.
row
] >ğglob®_loÿtÜ.
ÄeguÏr
())

113 =ğ(
loÿtÜ
[
ŒË
.
row
] >ğloÿtÜ.
ÄeguÏr
()));

115 
as£¹
(
loÿtÜ
[
ŒË
.
row
] - 
off£t
 <ğ
glob®_loÿtÜ
[ŒË.row] - 
glob®_off£t
);

117 autØ
	mcŞ
 = 
cŞg½_loÿtÜ
[
ŒË
.
cŞ
 - 
cŞg½_off£t
];

118 
	m’Œ›s
[--
cŞ±rs
[
cŞ
]].
£t
(

119 
glob®_loÿtÜ
[
ŒË
.
row
] - 
glob®_off£t
,rË.row + 
rowg½_off£t
,riple);

124 
ušt32_t
 
	mi
 = 0; i < 
	mncŞs
; i++)

125 
	m¡d
::
sÜt
(
’Œ›s
 + 
cŞ±rs
[
i
],ƒÁr› + cŞ±rs[˜+ 1], 
idx_com·»
);

127 
as£¹
(
cŞ±rs
[0] == 0);

128 
	mi
 = 0; i < 
	mncŞs
; i++)

129 
as£¹
(
cŞ±rs
[
i
] <= colptrs[i + 1]);

132 ~
CSC
()

137 
munm­
(
cŞ±rs
, (
ncŞs
 + 1è* (
ušt32_t
));

138 
munm­
(
cŞidxs
, (
ncŞs
 + 1è* (
ušt32_t
));

139 
munm­
(
’Œ›s
, 
ÃÁr›s
 * (
EÁry
));

142 
	m´iv©e
:

143 
boŞ
 
idx_com·»
(cÚ¡ 
EÁry
& 
a
, cÚ¡ EÁry& 
b
)

144 {  
	ma
.
	mglob®_idx
 < 
	mb
.global_idx; }

146 
boŞ
 
cŞumn_majÜ_com·»
(cÚ¡ 
TrË
<
Weight
>& 
a
, cÚ¡ TrË<Weight>& 
b
)

147 {  (
	ma
.
	mcŞ
 < 
	mb
.cŞè| (×.cŞ =ğ
b
.
cŞ
è& (
a
.
row
 < b.row)); }

150 
CSC
(cÚ¡ CSC&èğ
d–‘e
;

151 cÚ¡ 
	mCSC
& 
	mİ”©Ü
=(cÚ¡ 
CSC
&èğ
d–‘e
;

	@src/utils/dashboard.h

5 #iâdeà
DASHBOARD_H


6 
	#DASHBOARD_H


	)

8 
	~"uts/loÿtÜ.h
"

9 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

10 
	~"¡ruùu»s/fixed_veùÜ.h
"

13 
	g‹m¶©e
 <
şass
 
	gRowG½
, cÏs 
	gCŞG½
>

14 
	sAÂÙ©edDashbßrd


16 
	m¡d
::
veùÜ
<
št32_t
> 
rowg½_fŞlow”s
;

17 
	m¡d
::
veùÜ
<
št32_t
> 
cŞg½_fŞlow”s
;

19 
RowG½
* 
	mrowg½
;

21 
CŞG½
* 
	mcŞg½
;

23 
ušt32_t
 
	mrg
, 
	mcg
, 
	mkth
;

25 
AÂÙ©edDashbßrd
() {}

29 
	g‹m¶©e
 <
şass
 
	gRowG½
, cÏs 
	gCŞG½
>

30 
	gProûs£dDashbßrd
 : 
AÂÙ©edDashbßrd
<
RowG½
, 
	gCŞG½
>

32 
usšg
 
	gBV
 = 
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>;

34 
	sRªksM‘a


36 
RªksM‘a
() {}

38 
RªksM‘a
(
ušt32_t
 
¿nk
, ušt32_ˆ
¿nge
)

39 : 
sub_»guÏr
(
¿nge
), 
sub_Ùh”
Ôªge), 
»guÏr
Ôªge), 
Ùh”
Ôªge), 
¿nk
(rank)

40 { 
	gg’”©ed_sub_»guÏr
 = 
çl£
; }

42 
BV
 
	gsub_»guÏr
;

43 
BV
 
	gsub_Ùh”
;

44 
BV
 
	g»guÏr
;

46 
BV
 
	gÙh”
;

48 
ušt32_t
 
	g¿nk
;

50 
boŞ
 
	gg’”©ed_sub_»guÏr
;

52 
g’”©e_sub_»guÏr
(
BV
& 
db_»guÏr
, BV& 
db_Ùh”
)

54 ià(
	gg’”©ed_sub_»guÏr
)

56 
	gg’”©ed_sub_»guÏr
 = 
Œue
;

58 
	gsub_»guÏr
.
‹mpÜ¬y_»size
(
db_»guÏr
.
couÁ
());

59 
	gsub_Ùh”
.
‹mpÜ¬y_»size
(
db_Ùh”
.
couÁ
());

61 
ušt32_t
 
	gidx
, 
	gidx_
 = 0;

62 
	gdb_»guÏr
.
»wšd
();

63 
	gdb_Ùh”
.
»wšd
();

65 
	g»guÏr
.
»wšd
();

66 
	g»guÏr
.
Ãxt
(
idx
))

67 
as£¹
(
db_»guÏr
.
check
(
idx
));

68 
	g»guÏr
.
»wšd
();

70 
	gdb_»guÏr
.
Ãxt
(
idx
))

72 ià(
	g»guÏr
.
check
(
idx
))

73 
	gsub_»guÏr
.
touch
(
idx_
);

74 
	gidx_
++;

77 
as£¹
(
idx_
 =ğ
sub_»guÏr
.
size
());

78 
as£¹
(
sub_»guÏr
.
couÁ
(è=ğ
»guÏr
.count());

80 
	gidx_
 = 0;

81 
	gdb_Ùh”
.
Ãxt
(
idx
))

83 ià(
	gÙh”
.
check
(
idx
))

84 
	gsub_Ùh”
.
touch
(
idx_
);

85 
	gidx_
++;

88 
as£¹
(
idx_
 =ğ
sub_Ùh”
.
size
());

89 
as£¹
(
sub_Ùh”
.
couÁ
(è=ğ
Ùh”
.count());

91 
	gdb_»guÏr
.
»wšd
();

92 
	gdb_Ùh”
.
»wšd
();

98 
	gFixedVeùÜ
<
	gRªksM‘a
> 
	growg½_¿nks_m‘a
;

100 
	gFixedVeùÜ
<
	gRªksM‘a
> 
	gcŞg½_¿nks_m‘a
;

102 
BV
* 
	g»guÏr
;

104 
BV
* 
	gsšk
;

106 
BV
* 
	gsourû
;

108 
LoÿtÜ
* 
	gloÿtÜ
;

110 
Proûs£dDashbßrd
() {}

112 
ušt32_t
 
rowg½_g
(ušt32_ˆ
uth
, 
boŞ
 
sšk
 = 
çl£
)

113 {  
sšk
 ? (6 * 
uth
 + 1) : (6 * uth); }

115 
ušt32_t
 
cŞg½_g
(ušt32_ˆ
uth
, 
boŞ
 
sourû
 = 
çl£
)

116 {  
sourû
 ? (6 * 
uth
 + 5) : (6 * uth + 4); }

120 
	g‹m¶©e
 <
şass
 
	gRowG½
, cÏs 
	gCŞG½
>

121 
	gCSCDashbßrd
 : 
Proûs£dDashbßrd
<
RowG½
, 
	gCŞG½
>

123 
CSCDashbßrd
() {}

	@src/utils/dist_timer.cpp

1 
	~"uts/di¡_tim”.h
"

4 
	g¡d
::
veùÜ
<
Di¡Tim”
> Di¡Tim”::
®l_tim”s
;

	@src/utils/dist_timer.h

5 #iâdeà
DIST_TIMER_H


6 
	#DIST_TIMER_H


	)

8 
	~<¡ršg
>

9 
	~<veùÜ
>

10 
	~<®gÜ™hm
>

11 
	~<num”ic
>

12 
	~<m©h.h
>

13 
	~"uts/’v.h
"

14 
	~"uts/log.h
"

17 şas 
	cDi¡Tim”


19 
	mpublic
:

21 
¡d
::
veùÜ
<
Di¡Tim”
> 
®l_tim”s
;

23 
	$»pÜt_®l
()

25 auto& 
t
 : 
®l_tim”s
)

26 
t
.
	`»pÜt
();

29 
public
:

31 
	$Di¡Tim”
(
¡d
::
¡ršg
 
Çme
è: 
	`Çme
Òame), 
	`¡¬t
(
Env
::
	$now
())

33 
pos
 = 
®l_tim”s
.
	`size
();

34 
®l_tim”s
.
	`push_back
(
	`Di¡Tim”
(
Çme
, 
¡¬t
));

35 
	}
}

37 
	$¡İ
()

39 
–­£d
 = 
Env
::
	`now
(è- 
¡¬t
;

40 
®l_tim”s
[
pos
].
–­£d
 =ƒlapsed;

41 
	}
}

43 
	$»pÜt
(
boŞ
 
´št
 = 
Œue
)

45 
¡d
::
veùÜ
<> 
	`®l_–­£d
(
Env
::
Äªks
);

46 
	`MPI_G©h”
(&
–­£d
, 1, 
MPI_DOUBLE
, 
®l_–­£d
.
	`d©a
(), 1, MPI_DOUBLE, 0, 
Env
::
MPI_WORLD
);

48 
¡d
::
veùÜ
<>::
™”©Ü
 
mš
 = std::
	`mš_–em’t
(
®l_–­£d
.
	`begš
(),‡Î_–­£d.
	`’d
());

49 
¡d
::
veùÜ
<>::
™”©Ü
 
max
 = std::
	`max_–em’t
(
®l_–­£d
.
	`begš
(),‡Î_–­£d.
	`’d
());

50 
avg
 = 
¡d
::
	`accumuÏ‹
(
®l_–­£d
.
	`begš
(),‡Î_–­£d.
	`’d
(), 0.0è/ 
Env
::
Äªks
;

51 
v¬
 = 
¡d
::
	`accumuÏ‹
(
®l_–­£d
.
	`begš
(),‡Î_–­£d.
	`’d
(), 0.0,

52 [&](
r
, cÚ¡ & 
t
)

53 {  
r
 + (
t
 - 
avg
) * (t -‡vg); })

54 / (
Env
::
Äªks
 - 1);

56 ià(
´št
)

57 
LOG
.
	`šfo
("Timer <%s> stats: %lf secs on‡verage (stdev %lf) (%lf [on %u] -> %lf [on %u]) \n",

58 
Çme
.
	`c_¡r
(), 
avg
, 
	`sq¹
(
v¬
),

59 *
mš
, 
¡d
::
	`di¡ªû
(
®l_–­£d
.
	`begš
(), min),

60 *
max
, 
¡d
::
	`di¡ªû
(
®l_–­£d
.
	`begš
(), max));

61  
avg
;

62 
	}
}

64 
	g´iv©e
:

65 
	$Di¡Tim”
(
¡d
::
¡ršg
 
Çme
, 
¡¬t
)

66 : 
	`Çme
(
Çme
), 
	$¡¬t
(
¡¬t
è{
	}
}

68 
	g´iv©e
:

69 
¡d
::
¡ršg
 
Çme
;

71 
	g¡¬t
;

73 
	g–­£d
;

75 
ušt64_t
 
	gpos
;

	@src/utils/enum.h

1 #iâdeà
ENUM_H


2 
	#ENUM_H


	)

4 
	~<c¡ršg
>

7 şas 
	cEnum


10 
	m´Ùeùed
:

11 
v®ue
 = 0;

13 
	mpublic
:

14 
	$Enum
() {}

16 
	$Enum
(
v
è: 
	$v®ue
(
v
è{
	}
}

18 
İ”©Ü
=(
v
è{ 
v®ue
 = v; }

20 
İ”©Ü
 (ècÚ¡ {  
v®ue
; 
	}
}

22 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
v
ècÚ¡ {  
v®ue
 == v; }

26 
	$Çme_to_v®ue
(cÚ¡ * 
Çme
, cÚ¡ * cÚ¡ 
NAMES
[], 
couÁ
)

28 
i
 = 0; i < 
couÁ
; i++)

29 ià(
	`¡rcmp
(
Çme
, 
NAMES
[
i
]) == 0)

30  
i
;

32 
	}
}

	@src/utils/env.cpp

1 
	~<sys/time.h
>

2 
	~<veùÜ
>

3 
	~<num”ic
>

4 
	~<®gÜ™hm
>

5 
	~<ÿs£¹
>

6 
	~"uts/’v.h
"

9 
	gEnv
::
¿nk
 ;

11 
	gEnv
::
Äªks
;

13 
boŞ
 
	gEnv
::
is_ma¡”
;

15 
MPI_Comm
 
	gEnv
::
MPI_WORLD
;

18 
	gEnv
::
	$š™
(
RªkOrd”
 
Üd”
)

20 
mpi_th»adšg
;

21 
	`MPI_In™_th»ad
(0, 
nuÎ±r
, 
MPI_THREAD_MULTIPLE
, &
mpi_th»adšg
);

24 
	`MPI_Comm_size
(
MPI_COMM_WORLD
, &
Äªks
);

25 
	`MPI_Comm_¿nk
(
MPI_COMM_WORLD
, &
¿nk
);

26 
is_ma¡”
 = 
¿nk
 == 0;

28 
MPI_WORLD
 = 
MPI_COMM_WORLD
;

29 ià(
Üd”
 !ğ
RªkOrd”
::
KEEP_ORIGINAL
)

30 
	`shufæe_¿nks
(
Üd”
);

31 
	}
}

33 
	gEnv
::
	$fš®ize
()

34 { 
	`MPI_Fš®ize
(); 
	}
}

36 
	gEnv
::
	$ex™
(
code
)

38 
	`fš®ize
();

39 
¡d
::
	`ex™
(
code
);

40 
	}
}

42 
	gEnv
::
	$b¬r›r
()

43 { 
	`MPI_B¬r›r
(
MPI_WORLD
); 
	}
}

46 
	gEnv
::
	$shufæe_¿nks
(
RªkOrd”
 
Üd”
)

48 
¡d
::
veùÜ
<> 
	`¿nks
(
Äªks
);

50 ià(
is_ma¡”
)

52 
£ed
 = 
Üd”
 =ğ
RªkOrd”
::
FIXED_SHUFFLE
 ? 0 : 
	`now
();

53 
	`¤ªd
(
£ed
);

54 
¡d
::
	`iÙa
(
¿nks
.
	`begš
(),„ªks.
	`’d
(), 0);

55 
¡d
::
	`¿ndom_shufæe
(
¿nks
.
	`begš
(),„ªks.
	`’d
());

58 
¡d
::
	`sw­
(*
¿nks
.
	`begš
(), *¡d::
	`fšd
Ôªks.begš(),„ªks.
	`’d
(), 0));

59 
	`as£¹
(
¿nks
[0] == 0);

62 
	`MPI_Bÿ¡
(
¿nks
.
	`d©a
(), 
Äªks
, 
MPI_INT
, 0, 
MPI_COMM_WORLD
);

64 
MPI_Group
 
wÜld_group
, 
»Üd”ed_group
;

65 
	`MPI_Comm_group
(
MPI_COMM_WORLD
, &
wÜld_group
);

66 
	`MPI_Group_šş
(
wÜld_group
, 
Äªks
, 
¿nks
.
	`d©a
(), &
»Üd”ed_group
);

67 
	`MPI_Comm_ü—‹
(
MPI_COMM_WORLD
, 
»Üd”ed_group
, &
MPI_WORLD
);

69 
	`MPI_Comm_¿nk
(
MPI_WORLD
, &
¿nk
);

70 
	}
}

73 
	gEnv
::
	$now
()

75 
timev®
 
tv
;

76 autØ
»tv®
 = 
	`g‘timeofday
(&
tv
, 
nuÎ±r
);

77 
	`as£¹
(
»tv®
 == 0);

78  (è
tv
.
tv_£c
 + (ètv.
tv_u£c
 / 1e6;

79 
	}
}

	@src/utils/env.h

1 #iâdeà
ENV_H


2 
	#ENV_H


	)

4 
	~<mpi.h
>

5 
	~"uts/’um.h
"

8 şas 
	cRªkOrd”
 : 
public
 
Enum
 {

9 
public
:

10 
usšg
 
Enum
::Enum;

11 
cÚ¡ex´
 
	mKEEP_ORIGINAL
 = 0;

12 
cÚ¡ex´
 
	mFIXED_SHUFFLE
 = 1;

13 
cÚ¡ex´
 
	mRANDOM_SHUFFLE
 = 2;

17 şas 
	cEnv


19 
	mpublic
:

21 
Env
();

23 
	m¿nk
;

25 
	mÄªks
;

27 
boŞ
 
	mis_ma¡”
;

29 
MPI_Comm
 
	mMPI_WORLD
;

31 
š™
(
RªkOrd”
 
Üd”
 = RªkOrd”::
FIXED_SHUFFLE
);

33 
fš®ize
();

35 
ex™
(
code
);

37 
b¬r›r
();

39 
now
();

41 
	m´iv©e
:

42 
shufæe_¿nks
(
RªkOrd”
 
Üd”
);

	@src/utils/locator.h

12 #iâdeà
LOCATOR_H


13 
	#LOCATOR_H


	)

15 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

18 
	sLoÿtÜ


20 
	m´iv©e
:

21 
usšg
 
BV
 = 
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>;

23 
ušt32_t
* 
	mbufãr
;

25 
cÚ¡ex´
 
ušt32_t
 
	mm‘asize
 = 4;

27 
	mpublic
:

29 
LoÿtÜ
(
ušt32_t
 
¿nge
)

31 
bufãr
 = 
Ãw
 
ušt32_t
[
¿nge
 + 
m‘asize
];

32 
	mbufãr
[3] = 0;

35 ~
LoÿtÜ
()

37 
	md–‘e
[] 
	mbufãr
;

40 
ušt32_t
* 
¬¿y
(è{  
	mbufãr
 + 
	mm‘asize
; }

42 cÚ¡ 
ušt32_t
* 
¬¿y
(ècÚ¡ {  
	mbufãr
 + 
	mm‘asize
; }

44 cÚ¡ 
	mušt32_t
& 
	mİ”©Ü
[](
ušt32_t
 
	midx
) const

46  
¬¿y
()[
idx
];

49 
ušt32_t
 
ÄeguÏr
(ècÚ¡ {  
	mbufãr
[0]; }

51 
	mušt32_t
& 
ÄeguÏr
(è{  
	mbufãr
[0]; }

53 
ušt32_t
 
n£cÚd¬y
(ècÚ¡ {  
	mbufãr
[1]; }

55 
	mušt32_t
& 
n£cÚd¬y
(è{  
	mbufãr
[1]; }

57 
ušt32_t
 
Á”tŸry
(ècÚ¡ {  
	mbufãr
[2]; }

59 
	mušt32_t
& 
Á”tŸry
(è{  
	mbufãr
[2]; }

61 
ušt32_t
 
nsšk
(ècÚ¡ {  
	mbufãr
[1]; }

63 
	mušt32_t
& 
nsšk
(è{  
	mbufãr
[1]; }

65 
ušt32_t
 
nsourû
(ècÚ¡ {  
	mbufãr
[2]; }

67 
	mušt32_t
& 
nsourû
(è{  
	mbufãr
[2]; }

70 
	eV”‹xTy³


72 
	mReguÏr
 = 0, 
	mSecÚd¬y
, 
	mT”tŸry
, 
	mIsŞ©ed


75 
	m¡d
::
·œ
<
V”‹xTy³
, 
	mušt32_t
> 
m­
(
ušt32_t
 
idx
) const

79 
	midx
 = 
¬¿y
()[
idx
];

80 
ušt32_t
 
	mbeyÚd_»guÏr
 = 
idx
 >ğ
ÄeguÏr
();

81 
ušt32_t
 
	mbeyÚd_sšk
 = 
idx
 >ğ
ÄeguÏr
(è+ 
nsšk
();

82 
ušt32_t
 
	mbeyÚd_sourû
 = 
idx
 >ğ
ÄeguÏr
(è+ 
nsšk
(è+ 
nsourû
();

84 
V”‹xTy³
 
	mt
 = (V”‹xTy³è(
beyÚd_»guÏr
 + 
beyÚd_sšk
 + 
beyÚd_sourû
);

85 
ušt32_t
 
	midx_
 = 
idx
 - (
beyÚd_»guÏr
 ? 
ÄeguÏr
(è: 0è- (
beyÚd_sšk
 ? 
nsšk
() : 0)

86 - (
beyÚd_sourû
 ? 
nsourû
() : 0);

88  { 
	mt
, 
	midx_
 };

91 
	mpublic
:

93 
fÜ_dashbßrd
(
BV
& 
»guÏr
, BV& 
sšk
, BV& 
sourû
)

95 
as£¹
(
bufãr
[3] == 0);

96 
	mbufãr
[3] = 2;

98 
BV
 
»¡
(
»guÏr
.
size
());

99 
	m»¡
.
fl
();

100 
	m»¡
.
difã»nû_w™h
(
»guÏr
);

101 
	m»¡
.
difã»nû_w™h
(
sšk
);

102 
	m»¡
.
difã»nû_w™h
(
sourû
);

104 
ÄeguÏr
(èğ
»guÏr
.
couÁ
();

105 
nsšk
(èğ
sšk
.
couÁ
();

106 
nsourû
(èğ
sourû
.
couÁ
();

108 
ušt32_t
 
	midx
, 
	mpos
 = 0;

110 
	m»guÏr
.
»wšd
();

111 
	msšk
.
»wšd
();

112 
	msourû
.
»wšd
();

116 
	m»guÏr
.
Ãxt
(
idx
))

117 
¬¿y
()[
idx
] = 
pos
++;

118 
	msšk
.
Ãxt
(
idx
))

119 
¬¿y
()[
idx
] = 
pos
++;

120 
	msourû
.
Ãxt
(
idx
))

121 
¬¿y
()[
idx
] = 
pos
++;

122 
	m»¡
.
Ãxt
(
idx
))

123 
¬¿y
()[
idx
] = 
pos
++;

125 
as£¹
(
pos
 =ğ
»guÏr
.
size
());

127 
	m»guÏr
.
»wšd
();

128 
	msšk
.
»wšd
();

129 
	msourû
.
»wšd
();

132 
äom_b™veùÜs
(
BV
& 
loÿl
, BV& 
»guÏr
, BV& 
£cÚd¬y
)

134 
as£¹
(
bufãr
[3] == 0);

135 
	mbufãr
[3] = 1;

137 
as£¹
(
loÿl
.
size
(è=ğ
»guÏr
.size(è&&„eguÏr.size(è=ğ
£cÚd¬y
.size());

138 
as£¹
(
loÿl
.
couÁ
(è=ğ
»guÏr
.couÁ(è+ 
£cÚd¬y
.count());

140 
ÄeguÏr
(èğ
»guÏr
.
couÁ
();

141 
n£cÚd¬y
(èğ
£cÚd¬y
.
couÁ
();

142 
Á”tŸry
() = 0;

144 
ušt32_t
 
	midx
, 
	mpos
 = 0;

146 
	m»guÏr
.
»wšd
();

147 
	m£cÚd¬y
.
»wšd
();

149 
	m»guÏr
.
Ãxt
(
idx
))

150 
¬¿y
()[
idx
] = 
pos
++;

151 
	m£cÚd¬y
.
Ãxt
(
idx
))

152 
¬¿y
()[
idx
] = 
pos
++;

154 
	m»guÏr
.
»wšd
();

155 
	m£cÚd¬y
.
»wšd
();

157 
BV
 
»¡
(
»guÏr
.
size
());

158 
	m»¡
.
fl
();

159 
	m»¡
.
difã»nû_w™h
(
loÿl
);

161 
	m»¡
.
Ãxt
(
idx
))

162 
¬¿y
()[
idx
] = 
pos
++;

164 
as£¹
(
pos
 =ğ
loÿl
.
size
());

	@src/utils/log.cpp

1 
	~"uts/log.h
"

4 cÚ¡ * cÚ¡ 
	gLogLev–
::
NAMES
[]

8 
	gLog
::
	$Log
(è{
	}
}

11 
Log
& Log::
	$š¡ªû
()

13 
Log
 
š¡ªû
;

14  
š¡ªû
;

15 
	}
}

18 
LogLev–
 
	gLog
::
	$g‘_log_Ëv–
()

19 {  
Ëv–_
; 
	}
}

21 
	gLog
::
	$£t_log_Ëv–
(
LogLev–
 
Ëv–
)

22 { 
Ëv–_
 = 
Ëv–
; 
	}
}

24 
	gLog
::
	$£t_©_ma¡”_Úly
(
boŞ
 
©_ma¡”_Úly
)

25 { 
©_ma¡”_Úly_
 = 
©_ma¡”_Úly
; 
	}
}

27 
boŞ
 
	gLog
::
	$is_Œaû_’abËd
() const

28 {  
Ëv–_
 =ğ
LogLev–
::
TRACE
; 
	}
}

	@src/utils/log.h

1 #iâdeà
LOG_H


2 
	#LOG_H


	)

4 
	~<¡ršg
>

5 
	~<exû±iÚ
>

6 
	~"uts/’um.h
"

10 
	#LOG
 
Log
::
	`š¡ªû
()

	)

13 şas 
	cLogLev–
 : 
public
 
Enum


15 
public
:

16 
usšg
 
Enum
::Enum;

17 cÚ¡ 
	mTRACE
 = 0;

18 cÚ¡ 
	mDEBUG
 = 1;

19 cÚ¡ 
	mINFO
 = 2;

20 cÚ¡ 
	mWARN
 = 3;

21 cÚ¡ 
	mERROR
 = 4;

22 cÚ¡ 
	mFATAL
 = 5;

24 
	$LogLev–
(cÚ¡ * 
Çme
è: 
	`Enum
(
	$Çme_to_v®ue
(
Çme
, 
NAMES
, 6)) {}

26 cÚ¡ * 
	$Çme
(ècÚ¡ {  
NAMES
[
v®ue
]; 
	}
}

28 
	g´iv©e
:

29 cÚ¡ * cÚ¡ 
NAMES
[];

33 şas 
	cLog


35 
cÚ¡ex´
 
	mLOG_LINE_BUFFER_SIZE
 = 4 * 1024;

37 
	m´Ùeùed
:

39 
LogLev–
 
Ëv–_
 = LogLev–::
INFO
;

41 
boŞ
 
	m©_ma¡”_Úly_
 = 
Œue
;

43 
	m‹m¶©e
 <
	mËv–
, 
boŞ
 
	m©_ma¡”_Úly
, boŞ 
	mtime¡amp
>

44 
	$´št
(cÚ¡ * 
fmt
, 
va_li¡
 
¬gp
) const;

46 
public
:

48 
	`Log
();

50 
Log
& 
	`š¡ªû
();

52 
LogLev–
 
	`g‘_log_Ëv–
();

54 
	`£t_log_Ëv–
(
LogLev–
 
Ëv–
);

56 
	`£t_©_ma¡”_Úly
(
boŞ
 
©_ma¡”_Úly
);

58 
boŞ
 
	$is_Œaû_’abËd
() const;

61 
‹m¶©e
 <
boŞ
 
©_ma¡”_Úly
 = 
Œue
, boŞ 
time¡amp
 =rue>

62 
	$Œaû
(cÚ¡ * 
fmt
, ...) const;

64 
‹m¶©e
 <
boŞ
 
©_ma¡”_Úly
 = 
Œue
, boŞ 
time¡amp
 =rue>

65 
	$debug
(cÚ¡ * 
fmt
, ...) const;

67 
‹m¶©e
 <
boŞ
 
©_ma¡”_Úly
 = 
Œue
, boŞ 
time¡amp
 =rue>

68 
	$šfo
(cÚ¡ * 
fmt
, ...) const;

70 
‹m¶©e
 <
boŞ
 
©_ma¡”_Úly
 = 
Œue
, boŞ 
time¡amp
 =rue>

71 
	$w¬n
(cÚ¡ * 
fmt
, ...) const;

73 
‹m¶©e
 <
boŞ
 
©_ma¡”_Úly
 = 
Œue
, boŞ 
time¡amp
 =rue>

74 
	$”rÜ
(cÚ¡ * 
fmt
, ...) const;

77 
	$çl
(cÚ¡ * 
fmt
, ...) const;

81 şas 
	cExû±iÚ
 : 
public
 
¡d
::
exû±iÚ


83 
¡d
::
¡ršg
 
msg
;

85 
šlše
 
vœtu®
 cÚ¡ * 
	$wh©
(ècÚ¡ 
	$throw
()

86 {  
msg
.
	`c_¡r
(); }

88 
public
:

89 
	$Exû±iÚ
(cÚ¡ * 
msg
è: 
	$msg
(
msg
è{
	}
}

90 
	$Exû±iÚ
(
¡d
::
¡ršg
 
msg
è: 
	$msg
(
msg
è{
	}
}

94 
	~"uts/log.hµ
"

	@src/utils/log.hpp

1 #iâdeà
LOG_HPP


2 
	#LOG_HPP


	)

4 
	~<s¡»am
>

5 
	~<iomª
>

6 
	~<c¡d¬g
>

7 
	~"uts/log.h
"

8 
	~"uts/’v.h
"

11 
	g‹m¶©e
 <
	gËv–
, 
boŞ
 
	g©_ma¡”_Úly
, boŞ 
	gtime¡amp
>

12 
	gLog
::
	$´št
(cÚ¡ * 
fmt
, 
va_li¡
 
¬gs
) const

14 ià(
Ëv–
 >ğ
Ëv–_
)

16 ià(
Env
::
is_ma¡”
 || !
©_ma¡”_Úly_
 || !
©_ma¡”_Úly
)

18 ià(
time¡amp
)

21 
time_t
 
t
 = 
	`time
(
nuÎ±r
);

22 
tm
 
Ém
 = *
	`loÿÉime
(&
t
);

23 
¡d
::
o¡ršg¡»am
 
oss
;

24 
oss
 << 
¡d
::
	`put_time
(&
Ém
, "%Y-%m-%d %H:%M:%S");

26 
	`´štf
("% %-5 [%i] ", 
oss
.
	`¡r
().
	`c_¡r
(), 
	`LogLev–
(
Ëv–
).
	`Çme
(), 
Env
::
¿nk
);

28 
	`v´štf
(
fmt
, 
¬gs
);

32 
	}
}

35 
	g‹m¶©e
 <
boŞ
 
	g©_ma¡”_Úly
, boŞ 
	gtime¡amp
>

36 
	gLog
::
	$Œaû
(cÚ¡ * 
fmt
, ...) const

38 ià(
	`is_Œaû_’abËd
())

40 
va_li¡
 
¬gs
;

41 
	`va_¡¬t
(
¬gs
, 
fmt
);

42 
´št
<
LogLev–
::
TRACE
, 
©_ma¡”_Úly
, 
time¡amp
>(
fmt
, 
¬gs
);

43 
	`va_’d
(
¬gs
);

45 
	}
}

47 
	g‹m¶©e
 <
boŞ
 
	g©_ma¡”_Úly
, boŞ 
	gtime¡amp
>

48 
	gLog
::
	$debug
(cÚ¡ * 
fmt
, ...) const

50 
va_li¡
 
¬gs
;

51 
	`va_¡¬t
(
¬gs
, 
fmt
);

52 
´št
<
LogLev–
::
DEBUG
, 
©_ma¡”_Úly
, 
time¡amp
>(
fmt
, 
¬gs
);

53 
	`va_’d
(
¬gs
);

54 
	}
}

56 
	g‹m¶©e
 <
boŞ
 
	g©_ma¡”_Úly
, boŞ 
	gtime¡amp
>

57 
	gLog
::
	$šfo
(cÚ¡ * 
fmt
, ...) const

59 
va_li¡
 
¬gs
;

60 
	`va_¡¬t
(
¬gs
, 
fmt
);

61 
´št
<
LogLev–
::
INFO
, 
©_ma¡”_Úly
, 
time¡amp
>(
fmt
, 
¬gs
);

62 
	`va_’d
(
¬gs
);

63 
	}
}

65 
	g‹m¶©e
 <
boŞ
 
	g©_ma¡”_Úly
, boŞ 
	gtime¡amp
>

66 
	gLog
::
	$w¬n
(cÚ¡ * 
fmt
, ...) const

68 
va_li¡
 
¬gs
;

69 
	`va_¡¬t
(
¬gs
, 
fmt
);

70 
´št
<
LogLev–
::
WARN
, 
©_ma¡”_Úly
, 
time¡amp
>(
fmt
, 
¬gs
);

71 
	`va_’d
(
¬gs
);

72 
	}
}

74 
	g‹m¶©e
 <
boŞ
 
	g©_ma¡”_Úly
, boŞ 
	gtime¡amp
>

75 
	gLog
::
	$”rÜ
(cÚ¡ * 
fmt
, ...) const

77 
va_li¡
 
¬gs
;

78 
	`va_¡¬t
(
¬gs
, 
fmt
);

79 
´št
<
LogLev–
::
ERROR
, 
©_ma¡”_Úly
, 
time¡amp
>(
fmt
, 
¬gs
);

80 
	`va_’d
(
¬gs
);

81 
	}
}

83 
šlše
 
	gLog
::
	$çl
(cÚ¡ * 
fmt
, ...) const

85 
va_li¡
 
¬gs
;

86 
	`va_¡¬t
(
¬gs
, 
fmt
);

87 
´št
<
LogLev–
::
FATAL
, 
çl£
, 
Œue
>(
fmt
, 
¬gs
);

88 
¡r
[
LOG_LINE_BUFFER_SIZE
]; str[0] = '\0';

89 
	`v¥rštf
(
¡r
, 
fmt
, 
¬gs
);

90 
throw
 
	`Exû±iÚ
(
¡r
);

91 
	`va_’d
(
¬gs
);

92 
	}
}

	@src/utils/rowgrp.h

5 #iâdeà
ROWGRP_H


6 
	#ROWGRP_H


	)

8 
	~"uts/loÿtÜ.h
"

9 
	~"¡ruùu»s/£rŸlizabË_b™veùÜ.h
"

12 
	g‹m¶©e
 <
şass
 
	gTe
>

13 
	sAÂÙ©edRowG½


15 
	m¡d
::
veùÜ
<
Te
*> 
loÿl_tes
;

17 
ušt32_t
 
	mrg
, 
	m™h
;

18 
ušt32_t
 
	moff£t
, 
	m’dpos
;

19 
št32_t
 
	mËad”
;

20 
ušt32_t
 
	mkth
;

22 
ušt32_t
 
¿nge
()

24  
	m’dpos
 - 
	moff£t
;

29 
	g‹m¶©e
 <
şass
 
	gTe
>

30 
	gProûs£dRowG½
 : 
AÂÙ©edRowG½
<
Te
>

32 
usšg
 
BV
 = 
CommuniÿbË
<
S”ŸlizabËB™VeùÜ
>;

35 
LoÿtÜ
* 
	gloÿtÜ
;

36 
LoÿtÜ
* 
	gglob®_loÿtÜ
;

38 
BV
* 
	gloÿl
;

39 
BV
* 
	g»guÏr
;

40 
BV
* 
	gsšk
;

42 
BV
* 
	gglob®ly_»guÏr
;

43 
BV
* 
	gglob®ly_sšk
;

46 
	g‹m¶©e
 <
şass
 
	gTe
>

47 
	gCSCRowG½
 : 
Proûs£dRowG½
<
Te
>

	@src/utils/tile.h

5 #iâdeà
TILE_H


6 
	#TILE_H


	)

8 
	~"uts/csc.h
"

11 
	g‹m¶©e
 <
şass
 
	gWeight
>

12 
	sTe2D


14 
	m¡d
::
veùÜ
<
TrË
<
Weight
>>* 
ŒËs
;

16 
Te2D
(è{ 
®loÿ‹_ŒËs
(); }

18 ~
Te2D
(è{ 
ä“_ŒËs
(); }

20 
®loÿ‹_ŒËs
()

22 ià(!
	mŒËs
)

23 
	mŒËs
 = 
Ãw
 
¡d
::
veùÜ
<
TrË
<
Weight
>>;

26 
ä“_ŒËs
()

28 
d–‘e
 
	mŒËs
;

29 
	mŒËs
 = 
nuÎ±r
;

34 
	g‹m¶©e
 <
şass
 
	gWeight
>

35 
	gDi¡Te2D
 : 
Te2D
<
Weight
>

37 
ušt32_t
 
rg
, 
	gcg
;

38 
ušt32_t
 
	g™h
, 
	gjth
, 
	gÁh
;

39 
št32_t
 
	g¿nk
;

42 
	g‹m¶©e
 <
şass
 
	gWeight
>

43 
	gAÂÙ©edTe2D
 : 
Di¡Te2D
<
Weight
>

47 
	g‹m¶©e
 <
şass
 
	gWeight
>

48 
	gProûs£dTe2D
 : 
AÂÙ©edTe2D
<
Weight
>

52 
	g‹m¶©e
 <
şass
 
	gWeight
>

53 
	gCSCTe2D
 : 
Proûs£dTe2D
<
Weight
>

55 
CSC
<
Weight
>* 
csc
, * 
	gsšk_csc
;

	@src/vector/accum_final_segment.h

1 #iâdeà
ACCUM_FINAL_SEGMENT_H


2 
	#ACCUM_FINAL_SEGMENT_H


	)

4 
	~"¡ruùu»s/b™veùÜ.h
"

11 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
, cÏs 
	gP¬tŸlA¼ay
 = 
A¼ay
>

12 şas 
	cAccumFš®Segm’t
 : 
public
 
A¼ay


14 
public
:

15 
usšg
 
V®ue
 = 
ty³Çme
 
A¼ay
::
Ty³
;

16 
usšg
 
	mDashbßrd
 = 
ty³Çme
 
M©rix
::
Dashbßrd
;

17 
usšg
 
	mRªksM‘a
 = 
ty³Çme
 
Dashbßrd
::
RªksM‘a
;

19 
ušt32_t
 
	mkth
;

21 
ušt32_t
 
	mrg
;

23 
ušt32_t
 
	mnum_out¡ªdšg
;

25 
ušt32_t
 
	msšk_off£t
;

27 
	mFixedVeùÜ
<
	mP¬tŸlA¼ay
>* 
	m·¹Ÿls
;

29 
	mFixedVeùÜ
<
	mRªksM‘a
>* 
	m¿nks_m‘a
;

31 
	m¡d
::
veùÜ
<*> 
blobs
;

33 
	m´iv©e
:

34 
¡d
::
veùÜ
<
št32_t
> 
»que¡s
;

36 
	m¡d
::
veùÜ
<
št32_t
> 
šdiûs
;

38 
ušt32_t
 
	mg
;

40 
ušt32_t
 
	$d‘”mše_size
(
Dashbßrd
* 
db
, 
boŞ
 
sšk
)

42 ià(
sšk
)

43  
db
->
sšk
->
	`couÁ
();

45  
db
->
»guÏr
->
	`couÁ
();

48 
public
:

50 
	$AccumFš®Segm’t
(è{
	}
}

56 
	$AccumFš®Segm’t
(
Dashbßrd
* 
db
, 
boŞ
 
sšk
)

57 : 
	`A¼ay
(
	`d‘”mše_size
(
db
, 
sšk
)), 
	`¿nks_m‘a
(&db->
rowg½_¿nks_m‘a
)

59 
rg
 = 
db
->rg;

60 
kth
 = 
db
->kth;

61 
g
 = 
Dashbßrd
::
	`rowg½_g
(
rg
, 
sšk
);

62 
sšk_off£t
 = 
db
->
»guÏr
->
	`couÁ
();

64 
·¹Ÿls
 = 
Ãw
 
FixedVeùÜ
<
P¬tŸlA¼ay
>;

65 
·¹Ÿls
->
	`»£rve
(
¿nks_m‘a
->
	`size
());

66 
ušt32_t
 
i
 = 0; i < 
¿nks_m‘a
->
	`size
(); i++)

67 
·¹Ÿls
->
	`em¶aû_back
(
A¼ay
::
	`size
());

68 
	}
}

70 ~
	$AccumFš®Segm’t
()

72 
d–‘e
 
·¹Ÿls
;

73 
	}
}

75 
	$g©h”
()

77 
num_out¡ªdšg
 = 
¿nks_m‘a
->
	`size
();

78 
blobs
.
	`ş—r
();

79 
»que¡s
.
	`ş—r
();

81 
ušt32_t
 
i
 = 0; i < 
¿nks_m‘a
->
	`size
(); i++)

83 
MPI_Reque¡
 
»que¡
 = 
MPI_REQUEST_NULL
;

85 
blobs
.
	`push_back
((*
·¹Ÿls
)[
i
].
	`œecv
((*
¿nks_m‘a
)[i].
¿nk
, 
g
, 
Env
::
MPI_WORLD
, &
»que¡
));

87 
»que¡s
.
	`push_back
(
»que¡
);

89 
	}
}

91 cÚ¡ 
	g¡d
::
veùÜ
<
št32_t
>& 
	$wa™_fÜ_some
()

93 
št32_t
 
num_»ady
;

95 
šdiûs
.
	`»size
(
»que¡s
.
	`size
());

97 
	`as£¹
(
num_out¡ªdšg
 > 0);

98 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
ty³Çme
 
A¼ay
::
Ty³
>::
v®ue
)

99 
CommuniÿbË
<
A¼ay
>::
	`œecv_dyÇmic_some
(
blobs
, 
»que¡s
);

101 
	`MPI_Wa™some
(
»que¡s
.
	`size
(),„eque¡s.
	`d©a
(), &
num_»ady
, 
šdiûs
.d©a(), 
MPI_STATUSES_IGNORE
);

103 
	`as£¹
(
num_»ady
 !ğ
MPI_UNDEFINED
);

105 
šdiûs
.
	`»size
(
num_»ady
);

106 
num_out¡ªdšg
 -ğ
num_»ady
;

108  
šdiûs
;

109 
	}
}

111 
boŞ
 
	$no_mÜe_£gs
(è{  
num_out¡ªdšg
 =ğ0; 
	}
}

113 
	$œecv_po¡´oûss
(
ušt32_t
 
jth
)

115 (*
·¹Ÿls
)[
jth
].
	`œecv_po¡´oûss
(
blobs
[jth]);

116 
blobs
[
jth
] = 
nuÎ±r
;

117 
»que¡s
[
jth
] = 
MPI_REQUEST_NULL
;

118 
	}
}

	@src/vector/accum_partial_segment.h

1 #iâdeà
ACCUM_PARTIAL_SEGMENT_H


2 
	#ACCUM_PARTIAL_SEGMENT_H


	)

9 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
>

10 şas 
	cAccumP¬tŸlSegm’t
 : 
public
 
A¼ay


12 
public
:

13 
usšg
 
V®ue
 = 
ty³Çme
 
A¼ay
::
Ty³
;

14 
usšg
 
	mRowG½
 = 
ty³Çme
 
M©rix
::
RowG½
;

15 
usšg
 
	mDashbßrd
 = 
ty³Çme
 
M©rix
::
Dashbßrd
;

17 
ušt32_t
 
	mrg
;

19 
ušt32_t
 
	m™h
;

21 
ušt32_t
 
	mÁes
;

23 
ušt32_t
 
	mncombšed
;

25 
	m´iv©e
:

26 
št32_t
 
owÃr
;

28 
ušt32_t
 
	mg
;

30 * 
	mblob
;

32 
MPI_Reque¡
 
	m´og»ss
;

34 
ušt32_t
 
	$d‘”mše_size
(cÚ¡ 
RowG½
* 
rowg½
, 
boŞ
 
sšk
)

36 ià(
sšk
)

37  
rowg½
->
glob®ly_sšk
->
	`couÁ
();

39  
rowg½
->
glob®ly_»guÏr
->
	`couÁ
();

42 
public
:

44 
	$AccumP¬tŸlSegm’t
(è{
	}
}

46 
	$AccumP¬tŸlSegm’t
(cÚ¡ 
RowG½
* 
rowg½
, 
boŞ
 
sšk
)

47 : 
	`A¼ay
(
	$d‘”mše_size
(
rowg½
, 
sšk
))

49 
rg
 = 
rowg½
->rg;

50 
™h
 = 
rowg½
->ith;

51 
owÃr
 = 
rowg½
->
Ëad”
;

52 
g
 = 
Dashbßrd
::
	`rowg½_g
(
rg
, 
sšk
);

54 
Áes
 = 
rowg½
->
loÿl_tes
.
	`size
();

55 
ncombšed
 = 0;

57 
´og»ss
 = 
MPI_REQUEST_NULL
;

58 
blob
 = 
nuÎ±r
;

59 
	}
}

65 
	$po¡´oûss
()

67 
	`MPI_Wa™
(&
´og»ss
, 
MPI_STATUS_IGNORE
);

69 ià(
blob
)

71 
A¼ay
::
	`i£nd_po¡´oûss
(
blob
);

72 
blob
 = 
nuÎ±r
;

74 
ncombšed
 = 0;

75 
	}
}

77 
	$£nd
()

79 
	`po¡´oûss
();

80 
blob
 = 
A¼ay
::
‹m¶©e
 
i£nd
<
Œue
>(
owÃr
, 
g
, 
Env
::
MPI_WORLD
, &
´og»ss
);

81 
	}
}

83 
boŞ
 
	$»ady
(è{  
ncombšed
 =ğ
Áes
; 
	}
}

	@src/vector/accum_vector.h

1 #iâdeà
ACCUM_VECTOR_H


2 
	#ACCUM_VECTOR_H


	)

4 
	~"¡ruùu»s/fixed_veùÜ.h
"

5 
	~"veùÜ/accum_·¹Ÿl_£gm’t.h
"

6 
	~"veùÜ/accum_fš®_£gm’t.h
"

9 
	#REORDER_LOCAL_SEGS
 
çl£


	)

15 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gP¬tŸlA¼ay
, cÏs 
	gFš®A¼ay
 = 
P¬tŸlA¼ay
>

16 şas 
	cAccumVeùÜ


18 
public
:

19 
usšg
 
Accum
 = 
ty³Çme
 
P¬tŸlA¼ay
::
Ty³
;

21 
usšg
 
	mP¬tŸlSegm’t
 = 
AccumP¬tŸlSegm’t
<
M©rix
, 
	mP¬tŸlA¼ay
>;

22 
usšg
 
	mFš®Segm’t
 = 
AccumFš®Segm’t
<
M©rix
, 
	mFš®A¼ay
>;

25 
	mFixedVeùÜ
<
	mP¬tŸlSegm’t
> 
	mloÿl_£gs
;

27 
	mFixedVeùÜ
<
	mFš®Segm’t
> 
	mown_£gs
;

30 
	mFixedVeùÜ
<
	mP¬tŸlSegm’t
> 
	mloÿl_£gs_sšk
;

32 
	mFixedVeùÜ
<
	mFš®Segm’t
> 
	mown_£gs_sšk
;

34 
	$AccumVeùÜ
(cÚ¡ 
M©rix
* 
A
)

37 
loÿl_£gs
.
	`»£rve
(
A
->
loÿl_rowg½s
.
	`size
());

38 
loÿl_£gs_sšk
.
	`»£rve
(
A
->
loÿl_rowg½s
.
	`size
());

40 #ià
REORDER_LOCAL_SEGS


41 autØ&
rowg½
 : 
A
->
loÿl_rowg½s
)

43 if(
rowg½
.
Ëad”
 !ğ
Env
::
¿nk
)

45 
loÿl_£gs
.
	`em¶aû_back
(&
rowg½
, 
çl£
);

46 
loÿl_£gs_sšk
.
	`em¶aû_back
(&
rowg½
, 
Œue
);

50 autØ&
rowg½
 : 
A
->
loÿl_rowg½s
)

52 if(
rowg½
.
Ëad”
 =ğ
Env
::
¿nk
)

54 
loÿl_£gs
.
	`em¶aû_back
(&
rowg½
, 
çl£
);

55 
loÿl_£gs_sšk
.
	`em¶aû_back
(&
rowg½
, 
Œue
);

59 auto& 
rowg½
 : 
A
->
loÿl_rowg½s
)

61 
loÿl_£gs
.
	`em¶aû_back
(&
rowg½
, 
çl£
);

62 
loÿl_£gs_sšk
.
	`em¶aû_back
(&
rowg½
, 
Œue
);

67 
own_£gs
.
	`»£rve
(
A
->
dashbßrds
.
	`size
());

68 
own_£gs_sšk
.
	`»£rve
(
A
->
dashbßrds
.
	`size
());

70 auto& 
db
 : 
A
->
dashbßrds
)

72 
own_£gs
.
	`em¶aû_back
(&
db
, 
çl£
);

73 
own_£gs_sšk
.
	`em¶aû_back
(&
db
, 
Œue
);

76 
	}
};

	@src/vector/msg_input_segment.h

1 #iâdeà
MSG_INPUT_SEGMENT_H


2 
	#MSG_INPUT_SEGMENT_H


	)

9 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
>

10 şas 
	cMsgIncomšgSegm’t
 : 
public
 
A¼ay


12 
public
:

13 
usšg
 
V®ue
 = 
ty³Çme
 
A¼ay
::
Ty³
;

14 
usšg
 
	mCŞG½
 = 
ty³Çme
 
M©rix
::
CŞG½
;

15 
usšg
 
	mDashbßrd
 = 
ty³Çme
 
M©rix
::
Dashbßrd
;

17 
ušt32_t
 
	mjth
;

19 
ušt32_t
 
	mcg
;

21 
št32_t
 
	mowÃr
;

23 
boŞ
 
	msourû
;

25 
	m´iv©e
:

26 
¡d
::
veùÜ
<
MPI_Reque¡
>* 
»cv_»que¡s
;

28 
	m¡d
::
veùÜ
<*>* 
»cv_blobs
;

30 
ušt32_t
* 
	mnum_out¡ªdšg
;

32 
	mpublic
:

34 
	$MsgIncomšgSegm’t
() {}

39 
	`MsgIncomšgSegm’t
(cÚ¡ 
CŞG½
* 
cŞg½
, 
¡d
::
veùÜ
<
MPI_Reque¡
>& 
»cv_»que¡s
,

40 
¡d
::
veùÜ
<*>& 
»cv_blobs
, 
ušt32_t
& 
num_out¡ªdšg
, 
boŞ
 
sourû
)

41 : 
	`A¼ay
(
sourû
 ? 
cŞg½
->sourû->
	$couÁ
(è: 
cŞg½
->
»guÏr
->
	`couÁ
()),

42 
	`»cv_»que¡s
(&
»cv_»que¡s
), 
	`»cv_blobs
(&
»cv_blobs
), 
	`num_out¡ªdšg
(&
num_out¡ªdšg
),

43 
	$sourû
(
sourû
)

45 
jth
 = 
cŞg½
->jth;

46 
cg
 = 
cŞg½
->cg;

47 
owÃr
 = 
cŞg½
->
Ëad”
;

48 
	}
}

50 
	$»cv
()

52 
MPI_Reque¡
 
´og»ss
 = 
MPI_REQUEST_NULL
;

53 
»cv_blobs
->
	`push_back
(

54 
A¼ay
::
	`œecv
(
owÃr
, 
Dashbßrd
::
	`cŞg½_g
(
cg
, 
sourû
), 
Env
::
MPI_WORLD
, &
´og»ss
));

55 
»cv_»que¡s
->
	`push_back
(
´og»ss
);

56 (*
num_out¡ªdšg
)++;

57 
	}
}

	@src/vector/msg_output_segment.h

1 #iâdeà
MSG_OUTPUT_SEGMENT_H


2 
	#MSG_OUTPUT_SEGMENT_H


	)

17 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
, cÏs 
	gS’dA¼ay
 = 
A¼ay
>

18 şas 
	cMsgOutgošgSegm’t
 : 
public
 
A¼ay


20 
public
:

21 
usšg
 
V®ue
 = 
ty³Çme
 
A¼ay
::
Ty³
;

22 
usšg
 
	mDashbßrd
 = 
ty³Çme
 
M©rix
::
Dashbßrd
;

23 
usšg
 
	mRªksM‘a
 = 
ty³Çme
 
Dashbßrd
::
RªksM‘a
;

25 
ušt32_t
 
	mkth
, 
	mcg
;

27 
	m´iv©e
:

28 
FixedVeùÜ
<
RªksM‘a
>* 
¿nks_m‘a
;

30 
	m¡d
::
veùÜ
<
MPI_Reque¡
> 
»que¡s
;

32 
	m¡d
::
veùÜ
<*> 
blobs
;

34 
S’dA¼ay
* 
	mout
;

36 
boŞ
 
	msourû
;

38 
	mpublic
:

40 
	$MsgOutgošgSegm’t
() {}

42 
	$MsgOutgošgSegm’t
(
Dashbßrd
* 
db
, 
boŞ
 
sourû
)

43 : 
	`A¼ay
(
sourû
 ? 
db
->sourû->
	$couÁ
(è: 
db
->
»guÏr
->
	`couÁ
()),

44 
	`¿nks_m‘a
(&
db
->
cŞg½_¿nks_m‘a
),

45 
	`out
(
Ãw
 
	`S’dA¼ay
(
sourû
 ? 
db
->sourû->
	$couÁ
(è: 
db
->
»guÏr
->
	`couÁ
())), 
	$sourû
(
sourû
)

47 
kth
 = 
db
->kth;

48 
cg
 = 
db
->cg;

50 auto& 
m
 : *
¿nks_m‘a
)

52 
m
.
	`g’”©e_sub_»guÏr
(*
db
->
»guÏr
, *db->
sourû
);

60 
	`as£¹
(
¿nks_m‘a
->
	`size
() > 0);

61 
	`as£¹
(
¿nks_m‘a
->
	`back
().
¿nk
 =ğ
Env
::rank);

62 
	}
}

64 ~
	$MsgOutgošgSegm’t
()

66 
d–‘e
 
out
;

67 
	}
}

70 
	$po¡´oûss
()

72 
	`MPI_Wa™®l
(
»que¡s
.
	`size
(),„eque¡s.
	`d©a
(), 
MPI_STATUSES_IGNORE
);

73 
»que¡s
.
	`ş—r
();

75 autØ
blob
 : 
blobs
)

76 
out
->
	`i£nd_po¡´oûss
(
blob
);

77 
blobs
.
	`ş—r
();

78 
	}
}

80 
	$bÿ¡
()

84 
	`po¡´oûss
();

88 
ušt32_t
 
i
 = 0; i < 
¿nks_m‘a
->
	`size
() - 1; i++)

89 
£nd_to_¿nk_™h
<
çl£
>(
i
);

94 
£nd_to_¿nk_™h
<
Œue
>(
¿nks_m‘a
->
	`size
() - 1);

98 
A¼ay
::
	`ş—r
();

99 
	}
}

101 
	g´iv©e
:

103 
‹m¶©e
 <
boŞ
 
de¡ruùive
>

104 
	$£nd_to_¿nk_™h
(
ušt32_t
 
i
)

106 auto& 
¿nk_»guÏr
 = 
sourû
 ? (*
¿nks_m‘a
)[
i
].
sub_Ùh”
 : (*¿nks_m‘a)[i].
sub_»guÏr
;

107 
out
->
	`‹mpÜ¬y_»size
(
¿nk_»guÏr
.
	`couÁ
());

109 
¿nk_»guÏr
.
	`»wšd
();

110 
A¼ay
::
	`»wšd
();

111 
out
->
	`»wšd
();

113 
ušt32_t
 
¿nk_idx
, 
v®_idx
;

114 
V®ue
 
v®
;

116 
ušt32_t
 
z
 = 0;

117 
boŞ
 
loÿl
 = 
¿nk_»guÏr
.
	`Ãxt
(
¿nk_idx
);

118 
boŞ
 
nÚz”o
 = 
A¼ay
::
‹m¶©e
 
advªû
<
de¡ruùive
>(
v®_idx
, 
v®
);

120 
loÿl
 & 
nÚz”o
)

122 
ušt32_t
 
¿nk_idx_
 = 
¿nk_idx
, 
v®_idx_
 = 
v®_idx
;

124 ià(
¿nk_idx_
 =ğ
v®_idx_
)

129 
out
->
	`push
(
z
, 
v®
);

131 ià(
¿nk_idx_
 <ğ
v®_idx_
)

133 
z
++;

134 
loÿl
 = 
¿nk_»guÏr
.
	`Ãxt
(
¿nk_idx
);

136 ià(
¿nk_idx_
 >ğ
v®_idx_
)

137 
nÚz”o
 = 
A¼ay
::
‹m¶©e
 
advªû
<
de¡ruùive
>(
v®_idx
, 
v®
);

146 
MPI_Reque¡
 
»que¡
;

147 
blobs
.
	`push_back
(
out
->
‹m¶©e
 
i£nd
<
Œue
 >(

148 (*
¿nks_m‘a
)[
i
].
¿nk
, 
Dashbßrd
::
	`cŞg½_g
(
cg
, 
sourû
), 
Env
::
MPI_WORLD
, &
»que¡
));

152 
»que¡s
.
	`push_back
(
»que¡
);

153 
	}
}

	@src/vector/msg_vector.h

1 #iâdeà
MSG_VECTOR_H


2 
	#MSG_VECTOR_H


	)

4 
	~<mpi.h
>

5 
	~<ÿs£¹
>

6 
	~"¡ruùu»s/fixed_veùÜ.h
"

7 
	~"¡ruùu»s/communiÿbË.h
"

8 
	~"uts/commÚ.h
"

9 
	~"veùÜ/msg_šput_£gm’t.h
"

10 
	~"veùÜ/msg_ouut_£gm’t.h
"

16 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
>

17 şas 
	cMsgVeùÜ


19 
	mpublic
:

20 
	sIncomšgSegm’ts


22 
FixedVeùÜ
<
MsgIncomšgSegm’t
<
M©rix
, 
	mA¼ay
>> 
	m»guÏr
;

23 
	mFixedVeùÜ
<
	mMsgIncomšgSegm’t
<
	mM©rix
, 
	mA¼ay
>> 
	msourû
;

26 
IncomšgSegm’ts
 
	gšcomšg
;

28 
	sOutgošgSegm’ts


30 
	gFixedVeùÜ
<
	gMsgOutgošgSegm’t
<
	gM©rix
, 
	gA¼ay
>> 
	g»guÏr
;

31 
	gFixedVeùÜ
<
	gMsgOutgošgSegm’t
<
	gM©rix
, 
	gA¼ay
>> 
	gsourû
;

34 
OutgošgSegm’ts
 
	goutgošg
;

36 
	g¡d
::
veùÜ
<*> 
blobs
;

38 
	g´iv©e
:

39 
ušt32_t
 
num_out¡ªdšg
;

41 
	g¡d
::
veùÜ
<
št32_t
> 
šdiûs
;

43 
	g¡d
::
veùÜ
<
MPI_Reque¡
> 
»que¡s
;

45 
ušt32_t
 
	gsourû_num_out¡ªdšg
;

47 
	g¡d
::
veùÜ
<*> 
sourû_blobs
;

49 
	g¡d
::
veùÜ
<
MPI_Reque¡
> 
sourû_»que¡s
;

51 
	gpublic
:

53 
	$MsgVeùÜ
(cÚ¡ 
M©rix
* 
A
)

55 
num_out¡ªdšg
 = 0;

58 
šcomšg
.
»guÏr
.
	`»£rve
(
A
->
loÿl_cŞg½s
.
	`size
());

59 
šcomšg
.
sourû
.
	`»£rve
(
A
->
loÿl_cŞg½s
.
	`size
());

61 auto& 
cŞg½
 : 
A
->
loÿl_cŞg½s
)

63 
šcomšg
.
»guÏr
.
	`em¶aû_back
(&
cŞg½
, 
»que¡s
, 
blobs
, 
num_out¡ªdšg
, 
çl£
);

64 
šcomšg
.
sourû
.
	`em¶aû_back
(&
cŞg½
, 
sourû_»que¡s
, 
sourû_blobs
, 
sourû_num_out¡ªdšg
, 
Œue
);

68 
outgošg
.
»guÏr
.
	`»£rve
(
A
->
dashbßrds
.
	`size
());

69 
outgošg
.
sourû
.
	`»£rve
(
A
->
dashbßrds
.
	`size
());

71 auto& 
db
 : 
A
->
dashbßrds
)

73 
outgošg
.
»guÏr
.
	`em¶aû_back
(&
db
, 
çl£
);

74 
outgošg
.
sourû
.
	`em¶aû_back
(&
db
, 
Œue
);

76 
	}
}

78 
	$wa™_fÜ_sourûs
()

80 
	`as£¹
(
sourû_»que¡s
.
	`size
(è=ğ
sourû_blobs
.size());

81 
	`as£¹
(
sourû_»que¡s
.
	`size
(è=ğ
šcomšg
.
sourû
.size());

83 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
ty³Çme
 
A¼ay
::
Ty³
>::
v®ue
)

84 
CommuniÿbË
<
A¼ay
>::
	`œecv_dyÇmic_®l
(
sourû_blobs
, 
sourû_»que¡s
);

86 
	`MPI_Wa™®l
(
sourû_»que¡s
.
	`size
(), sourû_»que¡s.
	`d©a
(), 
MPI_STATUSES_IGNORE
);

88 auto& 
x£g
 : 
šcomšg
.
sourû
)

89 
x£g
.
	`œecv_po¡´oûss
(
sourû_blobs
[x£g.
jth
]);

91 
sourû_»que¡s
.
	`ş—r
();

92 
sourû_blobs
.
	`ş—r
();

94 auto& 
x£g
: 
outgošg
.
sourû
)

95 
x£g
.
	`po¡´oûss
();

96 
	}
}

98 
	g¡d
::
veùÜ
<
št32_t
>* 
	$wa™_fÜ_some
()

99 {  
cŞËù
<
Œue
>(); 
	}
}

101 
boŞ
 
	$no_mÜe_£gs_th’_ş—r
()

103 ià(
num_out¡ªdšg
 == 0)

105 
»que¡s
.
	`ş—r
();

106 
blobs
.
	`ş—r
();

107  
Œue
;

109  
çl£
;

110 
	}
}

112 
boŞ
 
	$no_mÜe_£gs
(ècÚ¡ {  (
num_out¡ªdšg
 =ğ0); 
	}
}

115 
	$œecv_po¡´oûss
(
ušt32_t
 
jth
)

117 
šcomšg
.
»guÏr
[
jth
].
	`œecv_po¡´oûss
(
blobs
[jth]);

118 
blobs
[
jth
] = 
nuÎ±r
;

119 
»que¡s
[
jth
] = 
MPI_REQUEST_NULL
;

120 
	}
}

122 
	g´iv©e
:

124 
‹m¶©e
 <
boŞ
 
wa™
>

125 
¡d
::
veùÜ
<
št32_t
>* 
	$cŞËù
()

127 
št32_t
 
num_»ady
;

129 ià(
»que¡s
.
	`size
() == 0)

131 
num_»ady
 = 
šcomšg
.
»guÏr
.
	`size
();

132 
šdiûs
.
	`»size
(
num_»ady
);

133 
¡d
::
	`iÙa
(
šdiûs
.
	`begš
(), indiûs.begš(è+ 
num_»ady
, 0);

134 
num_out¡ªdšg
 = 0;

135  &
šdiûs
;

138 
	`as£¹
(
»que¡s
.
	`size
(è=ğ
šcomšg
.
»guÏr
.size());

139 
	`as£¹
(
blobs
.
	`size
(è=ğ
šcomšg
.
»guÏr
.size());

140 
šdiûs
.
	`»size
(
»que¡s
.
	`size
());

142 
	`as£¹
(
num_out¡ªdšg
 > 0);

143 ià(
¡d
::
is_ba£_of
<
S”ŸlizabË
, 
ty³Çme
 
A¼ay
::
Ty³
>::
v®ue
)

144 
CommuniÿbË
<
A¼ay
>::
	`œecv_dyÇmic_some
(
blobs
, 
»que¡s
);

146 ià(
wa™
)

147 
	`MPI_Wa™some
(
»que¡s
.
	`size
(),„eque¡s.
	`d©a
(), &
num_»ady
, 
šdiûs
.d©a(), 
MPI_STATUSES_IGNORE
);

149 
	`MPI_Te¡some
(
»que¡s
.
	`size
(),„eque¡s.
	`d©a
(), &
num_»ady
, 
šdiûs
.d©a(), 
MPI_STATUSES_IGNORE
);

151 
	`as£¹
(
num_»ady
 !ğ
MPI_UNDEFINED
);

153 
šdiûs
.
	`»size
(
num_»ady
);

155 
	`as£¹
(
num_out¡ªdšg
 >ğ
num_»ady
);

156 
num_out¡ªdšg
 -ğ
num_»ady
;

158  &
šdiûs
;

159 
	}
}

	@src/vector/vertex_master_segment.h

1 #iâdeà
VERTEX_MASTER_SEGMENT_H


2 
	#VERTEX_MASTER_SEGMENT_H


	)

4 
	~"uts/loÿtÜ.h
"

10 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
>

11 şas 
	cV”‹xMa¡”Segm’t
 : 
public
 
A¼ay


13 
public
:

14 
usšg
 
V®ue
 = 
ty³Çme
 
A¼ay
::
Ty³
;

15 
usšg
 
	mRowG½
 = 
ty³Çme
 
M©rix
::
RowG½
;

16 
usšg
 
	mDashbßrd
 = 
ty³Çme
 
M©rix
::
Dashbßrd
;

17 
usšg
 
	mRªksM‘a
 = 
ty³Çme
 
Dashbßrd
::
RªksM‘a
;

19 
ušt32_t
 
	mkth
;

21 
ušt32_t
 
	mrg
;

23 
ušt32_t
 
	moff£t
;

25 
ušt32_t
 
	mrg_»g_size
;

27 
ušt32_t
 
	mrg_sšk_size
;

29 
LoÿtÜ
* 
	mloÿtÜ
;

31 
ušt32_t
* 
	mÜigš®_äom_š‹º®_m­
;

33 
	m´iv©e
:

34 
FixedVeùÜ
<
RªksM‘a
>* 
¿nks_m‘a
;

36 
	mpublic
:

37 
	sOut


39 
¡d
::
veùÜ
<
MPI_Reque¡
> 
»que¡s
;

41 
	m¡d
::
veùÜ
<*> 
blobs
;

43 
A¼ay
 
	mout
;

45 
Out
(
ušt32_t
 
couÁ
è: 
out
(count) {}

49 
Out
* 
	gout_»g
 = 
nuÎ±r
;

51 
Out
* 
	gout_¢k
 = 
nuÎ±r
;

53 
	gpublic
:

55 
	$V”‹xMa¡”Segm’t
(è{
	}
}

66 
	$V”‹xMa¡”Segm’t
(
Dashbßrd
* 
db
)

67 : 
	`A¼ay
(
db
->
»guÏr
->
	`size
(è ), 
	`loÿtÜ
(db->
loÿtÜ
),

68 
	`¿nks_m‘a
(&
db
->
rowg½_¿nks_m‘a
),

69 
	`rg_»g_size
(
db
->
rowg½
->
glob®ly_»guÏr
->
	`size
()),

70 
	`rg_sšk_size
(
db
->
rowg½
->
glob®ly_sšk
->
	$size
())

72 
kth
 = 
db
->kth;

73 
rg
 = 
db
->rg;

74 
off£t
 = 
db
->
rowg½
->offset;

76 
ušt32_t
 
i
 = 0; i < 
A¼ay
::
	`size
(); i++)

78 
ušt32_t
 
a
 = (*
db
->
rowg½
->
glob®_loÿtÜ
)[
i
];

79 
ušt32_t
 
b
 = (*
db
->
loÿtÜ
)[
i
];

80 
ušt32_t
 
c
 = 
loÿtÜ
->
	`ÄeguÏr
(è+†oÿtÜ->
	`nsšk
();

82 ià((
a
 < 
c
è| (
b
 < c))

83 
	`as£¹
(
a
 =ğ
b
);

86 
	`as£¹
(
db
->
rowg½
->
off£t
 =ğdb->
cŞg½
->offset);

88 
Üigš®_äom_š‹º®_m­
 = 
Ãw
 
ušt32_t
[
A¼ay
::
	`size
()];

90 
ušt32_t
 
i
 = 0; i < 
A¼ay
::
	`size
(); i++)

91 
Üigš®_äom_š‹º®_m­
[(*
loÿtÜ
)[
i
]] = i;

93 auto& 
m
 : *
¿nks_m‘a
)

94 
m
.
	`g’”©e_sub_»guÏr
(*
db
->
»guÏr
, *db->
sšk
);

101 
	`as£¹
(
¿nks_m‘a
->
	`size
() > 0);

102 
	`as£¹
(
¿nks_m‘a
->
	`back
().
¿nk
 =ğ
Env
::rank);

103 
	}
}

105 ~
	$V”‹xMa¡”Segm’t
()

107 
d–‘e
[] 
Üigš®_äom_š‹º®_m­
;

108 
d–‘e
 
out_»g
;

109 
d–‘e
 
out_¢k
;

110 
out_»g
 = 
nuÎ±r
;

111 
out_¢k
 = 
nuÎ±r
;

112 
	}
}

114 
	$®loÿ‹_mœrÜs
()

116 
out_»g
 = 
Ãw
 
	`Out
(
rg_»g_size
);

117 
out_¢k
 = 
Ãw
 
	`Out
(
rg_sšk_size
);

118 
	}
}

120 
ušt32_t
 
	$š‹º®_äom_Üigš®
(
ušt32_t
 
idx
)

122 
	`as£¹
(
idx
 >ğ
off£t
);

123 
	`as£¹
(
idx
 - 
off£t
 < 
A¼ay
::
	`size
());

124  (*
loÿtÜ
)[
idx
 - 
off£t
];

125 
	}
}

127 
ušt32_t
 
	$loÿ‹
(
ušt32_t
 
idx
)

129 
	`as£¹
(
idx
 >ğ
off£t
);

130 
	`as£¹
(
idx
 - 
off£t
 < 
A¼ay
::
	`size
());

131 
	`as£¹
((*
loÿtÜ
)[
Üigš®_äom_š‹º®_m­
[
idx
 - 
off£t
]] == idx - offset);

132  
Üigš®_äom_š‹º®_m­
[
idx
 - 
off£t
];

133 
	}
}

136 
	g‹m¶©e
 <
boŞ
 
	gsšk
 = 
çl£
>

137 
	$po¡´oûss
()

139 
Out
* 
out
 = 
sšk
 ? 
out_¢k
 : 
out_»g
;

141 
	`MPI_Wa™®l
(
out
->
»que¡s
.
	`size
(), out->»que¡s.
	`d©a
(), 
MPI_STATUSES_IGNORE
);

142 
out
->
»que¡s
.
	`ş—r
();

144 autØ
blob
 : 
out
->
blobs
)

145 
out
->out.
	`i£nd_po¡´oûss
(
blob
);

146 
out
->
blobs
.
	`ş—r
();

147 
	}
}

149 
	g‹m¶©e
 <
boŞ
 
	gsšk
 = 
çl£
>

150 
	$bÿ¡
()

152 
po¡´oûss
<
sšk
>();

154 
ušt32_t
 
j
 = 0; j < 
¿nks_m‘a
->
	`size
(); j++)

155 
£nd_to_¿nk_jth
<
sšk
>(
j
);

156 
	}
}

158 
	g´iv©e
:

160 
‹m¶©e
 <
boŞ
 
sšk
 = 
çl£
>

161 
	$£nd_to_¿nk_jth
(
ušt32_t
 
j
)

163 
Out
* 
out
 = 
sšk
 ? 
out_¢k
 : 
out_»g
;

165 auto& 
¿nk_m‘a
 = 
sšk
 ? (*
¿nks_m‘a
)[
j
].
sub_Ùh”
 : (*¿nks_m‘a)[j].
sub_»guÏr
;

167 
¿nk_m‘a
.
	`»wšd
();

168 
A¼ay
::
	`»wšd
();

169 
out
->out.
	`»wšd
();

171 
ušt32_t
 
¿nk_idx
, 
v®_idx
;

172 
V®ue
 
v®
;

174 
boŞ
 
loÿl
 = 
¿nk_m‘a
.
	`Ãxt
(
¿nk_idx
);

175 
boŞ
 
nÚz”o
 = 
A¼ay
::
‹m¶©e
 
advªû
<
çl£
>(
v®_idx
, 
v®
);

177 
loÿl
 & 
nÚz”o
)

179 
ušt32_t
 
¿nk_idx_
 = 
¿nk_idx
;

180 
ušt32_t
 
v®_idx_
 = 
v®_idx
;

182 ià(
¿nk_idx_
 =ğ
v®_idx_
)

183 
out
->out.
	`push
(
v®_idx
, 
v®
);

184 ià(
¿nk_idx_
 <ğ
v®_idx_
)

185 
loÿl
 = 
¿nk_m‘a
.
	`Ãxt
(
¿nk_idx
);

186 ià(
¿nk_idx_
 >ğ
v®_idx_
)

187 
nÚz”o
 = 
A¼ay
::
‹m¶©e
 
advªû
<
çl£
>(
v®_idx
, 
v®
);

190 
MPI_Reque¡
 
»que¡
;

191 
out
->
blobs
.
	`push_back
(out->out.
‹m¶©e
 
i£nd
<
Œue
>(

192 (*
¿nks_m‘a
è[
j
].
¿nk
, 
Dashbßrd
::
	`rowg½_g
(
rg
, 
sšk
è+ 2, 
Env
::
MPI_WORLD
, &
»que¡
));

194 
out
->
»que¡s
.
	`push_back
(
»que¡
);

195 
	}
}

	@src/vector/vertex_mirror_segment.h

1 #iâdeà
VERTEX_MIRROR_SEGMENT_H


2 
	#VERTEX_MIRROR_SEGMENT_H


	)

8 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
>

9 şas 
	cV”‹xMœrÜSegm’t
 : 
public
 
A¼ay


11 
public
:

13 
usšg
 
V®ue
 = 
ty³Çme
 
A¼ay
::
Ty³
;

14 
usšg
 
	mRowG½
 = 
ty³Çme
 
M©rix
::
RowG½
;

15 
usšg
 
	mDashbßrd
 = 
ty³Çme
 
M©rix
::
Dashbßrd
;

17 
ušt32_t
 
	m™h
;

19 
ušt32_t
 
	mrg
;

21 
št32_t
 
	mowÃr
;

23 
št32_t
 
	mg
;

25 
boŞ
 
	msšk
;

27 
	m´iv©e
:

28 
¡d
::
veùÜ
<
MPI_Reque¡
>* 
»cv_»que¡s
;

30 
	m¡d
::
veùÜ
<*>* 
»cv_blobs
;

32 
ušt32_t
* 
	mnum_out¡ªdšg
;

34 
	mpublic
:

36 
	$V”‹xMœrÜSegm’t
() {}

38 
	`V”‹xMœrÜSegm’t
(cÚ¡ 
RowG½
* 
rowg½
, 
¡d
::
veùÜ
<
MPI_Reque¡
>& 
»cv_»que¡s
,

39 
¡d
::
veùÜ
<*>& 
»cv_blobs
, 
ušt32_t
& 
num_out¡ªdšg
, 
boŞ
 
sšk
)

40 : 
	`A¼ay
(
sšk
 ? 
rowg½
->
glob®ly_sšk
->
	$size
(è: 
rowg½
->
glob®ly_»guÏr
->
	`size
()),

41 
	`»cv_»que¡s
(&
»cv_»que¡s
), 
	`»cv_blobs
(&
»cv_blobs
), 
	`num_out¡ªdšg
(&
num_out¡ªdšg
),

42 
	$sšk
(
sšk
)

44 
™h
 = 
rowg½
->ith;

45 
rg
 = 
rowg½
->rg;

46 
owÃr
 = 
rowg½
->
Ëad”
;

47 
g
 = 
Dashbßrd
::
	`rowg½_g
(
rg
, 
sšk
) + 2;

48 
	}
}

50 
	$»cv
()

52 
MPI_Reque¡
 
´og»ss
 = 
MPI_REQUEST_NULL
;

53 
»cv_blobs
->
	`push_back
(

54 
A¼ay
::
	`œecv
(
owÃr
, 
g
, 
Env
::
MPI_WORLD
, &
´og»ss
));

55 
»cv_»que¡s
->
	`push_back
(
´og»ss
);

56 (*
num_out¡ªdšg
)++;

57 
	}
}

	@src/vector/vertex_vector.h

1 #iâdeà
VERTEX_VECTOR_H


2 
	#VERTEX_VECTOR_H


	)

4 
	~"¡ruùu»s/fixed_veùÜ.h
"

5 
	~"veùÜ/v”‹x_ma¡”_£gm’t.h
"

6 
	~"veùÜ/v”‹x_mœrÜ_£gm’t.h
"

19 
	g‹m¶©e
 <
şass
 
	gM©rix
, cÏs 
	gA¼ay
>

20 şas 
	cV”‹xVeùÜ


22 
	mpublic
:

24 cÚ¡ 
M©rix
* 
A
;

26 
boŞ
 
	mmœrÜed
 = 
çl£
;

38 
	mFixedVeùÜ
<
	mV”‹xMa¡”Segm’t
<
	mM©rix
, 
	mA¼ay
>> 
	mown_£gs
;

40 
	sMœrÜSegm’ts


42 
	mFixedVeùÜ
<
	mV”‹xMœrÜSegm’t
<
	mM©rix
, 
	mA¼ay
>> 
	m£gs
;

49 
	m¡d
::
veùÜ
<*> 
blobs
;

52 
ušt32_t
 
	mnum_out¡ªdšg
;

53 
	m¡d
::
veùÜ
<
MPI_Reque¡
> 
»que¡s
;

54 
	m¡d
::
veùÜ
<
št32_t
> 
šdiûs
;

57 
MœrÜSegm’ts
* 
	gmœ_£gs_»g
 = 
nuÎ±r
;

59 
MœrÜSegm’ts
* 
	gmœ_£gs_¢k
 = 
nuÎ±r
;

61 
	gpublic
:

63 
	$V”‹xVeùÜ
(cÚ¡ 
M©rix
* 
A
è: 
	$A
(
A
)

66 
own_£gs
.
	`»£rve
(
A
->
dashbßrds
.
	`size
());

68 auto& 
db
 : 
A
->
dashbßrds
)

69 
own_£gs
.
	`em¶aû_back
(&
db
);

70 
	}
}

72 ~
	$V”‹xVeùÜ
()

74 
d–‘e
 
mœ_£gs_»g
;

75 
d–‘e
 
mœ_£gs_¢k
;

76 
mœ_£gs_»g
 = 
nuÎ±r
;

77 
mœ_£gs_¢k
 = 
nuÎ±r
;

78 
	}
}

80 
	$®loÿ‹_mœrÜs
()

84 auto& 
v£g
 : 
own_£gs
)

85 
v£g
.
	`®loÿ‹_mœrÜs
();

87 
mœ_£gs_»g
 = 
Ãw
 
MœrÜSegm’ts
;

88 
mœ_£gs_¢k
 = 
Ãw
 
MœrÜSegm’ts
;

91 
mœ_£gs_»g
->
£gs
.
	`»£rve
(
A
->
loÿl_rowg½s
.
	`size
());

92 
mœ_£gs_¢k
->
£gs
.
	`»£rve
(
A
->
loÿl_rowg½s
.
	`size
());

94 
mœ_£gs_»g
->
num_out¡ªdšg
 = 0;

95 
mœ_£gs_¢k
->
num_out¡ªdšg
 = 0;

97 auto& 
rowg½
 : 
A
->
loÿl_rowg½s
)

99 
mœ_£gs_»g
->
£gs
.
	`em¶aû_back
(&
rowg½
, mœ_£gs_»g->
»que¡s
, mœ_£gs_»g->
blobs
,

100 
mœ_£gs_»g
->
num_out¡ªdšg
, 
çl£
);

101 
mœ_£gs_¢k
->
£gs
.
	`em¶aû_back
(&
rowg½
, mœ_£gs_¢k->
»que¡s
, mœ_£gs_¢k->
blobs
,

102 
mœ_£gs_¢k
->
num_out¡ªdšg
, 
Œue
);

104 
	}
}

106 
	g‹m¶©e
 <
boŞ
 
	gsšk
 = 
çl£
>

107 
	$wa™_fÜ_™h
(
ušt32_t
 
™h
)

109 
MœrÜSegm’ts
* 
mœ_£gs
 = 
sšk
 ? 
mœ_£gs_¢k
 : 
mœ_£gs_»g
;

111 
	`as£¹
(
mœ_£gs
->
»que¡s
.
	`size
(è=ğmœ_£gs->
£gs
.size());

112 
	`as£¹
(
mœ_£gs
->
blobs
.
	`size
(è=ğmœ_£gs->
£gs
.size());

114 
	`as£¹
(
mœ_£gs
->
£gs
[
™h
].ith == ith);

116 ià(
mœ_£gs
->
blobs
[
™h
])

118 *& 
blob
 = 
mœ_£gs
->
blobs
[
™h
];

119 
MPI_Reque¡
* 
»que¡
 = &
mœ_£gs
->
»que¡s
[
™h
];

120 
CommuniÿbË
<
A¼ay
>::
	`œecv_dyÇmic_Úe
(
blob
, 
»que¡
);

121 
	`MPI_Wa™
(&
mœ_£gs
->
»que¡s
[
™h
], 
MPI_STATUSES_IGNORE
);

122 
mœ_£gs
->
£gs
[
™h
].
	`œecv_po¡´oûss
(mœ_£gs->
blobs
[ith]);

123 
mœ_£gs
->
blobs
[
™h
] = 
nuÎ±r
;

124 
mœ_£gs
->
»que¡s
[
™h
] = 
MPI_REQUEST_NULL
;

126 
	}
}

	@src/vprogram/types.h

1 #iâdeà
TYPES_H


2 
	#TYPES_H


	)

4 
	~<c¡dšt
>

5 
	~"uts/commÚ.h
"

8 
	sObjeù


10 
Objeù
() {}

13 
	m‹m¶©e
 <
şass
 
	mArchive
>

14 
£rŸlize
(
Archive
& 
¬chive
, cÚ¡ 
ušt32_t
 
v”siÚ
)

15 { 
	mLOG
.
šfo
("State::serialize: Not implemented! \n"); }

17 
	m¡d
::
¡ršg
 
to_¡ršg
() const

18 { 
LOG
.
šfo
("Object::to_string: Not implemented! \n");  "Not implemented"; }

22 
	gMsg
 : 
public
 
Objeù
 { 
usšg
 Object::Object; };

24 
	gAccum
 : 
Objeù
 { 
usšg
 Object::Object; };

26 
	gS‹
 : 
Objeù
 { 
usšg
 Object::Object; };

	@src/vprogram/vertex_program.h

1 #iâdeà
VERTEX_PROGRAM_H


2 
	#VERTEX_PROGRAM_H


	)

4 
	~<şim™s
>

5 
	~<ty³_Œa™s
>

6 
	~"uts/’v.h
"

7 
	~"m©rix/g¿ph.h
"

8 
	~"¡ruùu»s/¡»amšg_¬¿y.h
"

9 
	~"¡ruùu»s/¿ndom_acûss_¬¿y.h
"

10 
	~"veùÜ/msg_veùÜ.h
"

11 
	~"veùÜ/accum_veùÜ.h
"

12 
	~"veùÜ/v”‹x_veùÜ.h
"

13 
	~"v´og¿m/ty³s.h
"

16 
	g‹m¶©e
 <
şass
 
	gWeight
>

17 
	sEdge


19 cÚ¡ 
ušt32_t
 
	m¤c
, 
	md¡
;

21 cÚ¡ 
	mWeight
& 
	mweight
;

23 
Edge
(è: 
¤c
(0), 
d¡
(0), 
weight
(
Weight
()) {}

25 
Edge
(cÚ¡ 
ušt32_t
 
¤c
, cÚ¡ ušt32_ˆ
d¡
, cÚ¡ 
Weight
* 
weight
)

26 : 
¤c
(¤c), 
d¡
(d¡), 
weight
(*weight) {}

34 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

35 şas 
	cV”‹xProg¿m


38 
	mpublic
:

48 
V”‹xProg¿m
(cÚ¡ 
G¿ph
<
W
>* 
G
, 
boŞ
 
¡©iÚ¬y
 = 
çl£
);

54 
	m‹m¶©e
 <
şass
 
	mM2
, cÏs 
	mA2
>

55 
V”‹xProg¿m
(cÚ¡ V”‹xProg¿m<
W
, 
M2
, 
A2
, 
S
>& 
Ùh”
, 
boŞ
 
¡©iÚ¬y
 = 
çl£
);

57 
	mvœtu®
 ~
V”‹xProg¿m
();

70 
vœtu®
 
boŞ
 
	$š™
(
ušt32_t
 
vid
, 
S
& 
¡©e
)

73  
¡©iÚ¬y
;

81 
vœtu®
 
boŞ
 
	$š™
(
ušt32_t
 
vid
, cÚ¡ 
S‹
& 
Ùh”
, 
S
& 
¡©e
)

84  
¡©iÚ¬y
;

85 
	}
}

92 
vœtu®
 
M
 
	$sÿ‰”
(cÚ¡ 
S
& 
¡©e
)

95  
	`M
();

96 
	}
}

102 
vœtu®
 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
)

105  
A
();

114 
vœtu®
 
A
 
g©h”
(cÚ¡ 
Edge
<
W
>& 
edge
, cÚ¡ 
M
& 
msg
, cÚ¡ 
S
& 
¡©e
)

117 
	gg©h”_d•’ds_Ú_¡©e
 = 
çl£
;

118  
A
();

125 
vœtu®
 
	$combše
(cÚ¡ 
A
& 
y1
, A& 
y2
)

128 
	}
}

134 
vœtu®
 
boŞ
 
	$­¶y
(cÚ¡ 
A
& 
y
, 
S
& 
¡©e
)

137  
çl£
;

138 
	}
}

146 
vœtu®
 
boŞ
 
	$­¶y
(cÚ¡ 
A
& 
y
, 
S
& 
¡©e
, 
ušt32_t
 
™”
)

149 
­¶y_d•’ds_Ú_™”
 = 
çl£
;

150  
çl£
;

151 
	}
}

158 
boŞ
 
	g¡©iÚ¬y
 = 
çl£
;

168 
boŞ
 
	gİtimizabË
 = 
Œue
;

173 
cÚ¡ex´
 
ušt32_t
 
	gUNTIL_CONVERGENCE
 = 0;

178 
execu‹
(
ušt32_t
 
max_™”s_
 = 
UNTIL_CONVERGENCE
);

184 
»£t
();

190 
š™Ÿlize
();

193 
ä“
();

199 
	g‹m¶©e
 <
şass
 
	gW2
, cÏs 
	gM2
, cÏs 
	gA2
, cÏs 
	gS2
>

200 
š™Ÿlize
(cÚ¡ 
V”‹xProg¿m
<
W2
, 
M2
, 
A2
, 
S2
>& 
Ùh”
);

202 
di¥Ïy
(
ušt32_t
 
nv”tiûs
 = 30);

204 
»£t_aùiv™y
();

207 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gM­³r
, cÏs 
	gReduûr
>

208 
V®ue
 
»duû
(
M­³r
 
m­
, 
Reduûr
„eduû, 
boŞ
 
aùive_Úly
 = 
çl£
);

211 
	g‹m¶©e
 <
şass
 
	gI
, cÏs 
	gV
, cÏs 
	gM­³r
, cÏs 
	gCom·¿tÜ
>

212 
tİk
(
ušt32_t
 
k
, 
¡d
::
veùÜ
<¡d::
·œ
<
I
, 
V
>>&İk, 
M­³r
 
m­
, 
Com·¿tÜ
 
cmp
,

213 
boŞ
 
aùive_Úly
 = 
çl£
);

217 
	g‹m¶©e
 <
ušt32_t
 
	gBATCH_SIZE
, 
şass
 
	gI
, cÏs 
	gV
, cÏs 
	gM­³r
, cÏs 
	gCom·¿tÜ
>

218 
btİk
(
ušt32_t
 
k
, 
¡d
::
veùÜ
<¡d::
·œ
<
I
, 
V
>>* 
tİk
,

219 
M­³r
 
m­
, 
Com·¿tÜ
 
cmp
, 
boŞ
 
aùive_Úly
 = 
çl£
);

222 
	g´iv©e
:

226 
usšg
 
M©rix
 = 
ty³Çme
 
G¿ph
<
W
>::Matrix;

228 
usšg
 
	gV”‹xA¼ay
 = 
CommuniÿbË
<
RªdomAcûssA¼ay
<
S
>>;

229 
usšg
 
	gMsgA¼ay
 = 
CommuniÿbË
<
SŒ—mšgA¼ay
<
M
>>;

230 
usšg
 
	gAccumA¼ay
 = 
CommuniÿbË
<
RªdomAcûssA¼ay
<
A
>>;

232 
usšg
 
	gVeùÜV
 = 
V”‹xVeùÜ
<
M©rix
, 
	gV”‹xA¼ay
>;

233 
usšg
 
	gVeùÜX
 = 
MsgVeùÜ
<
M©rix
, 
	gMsgA¼ay
>;

234 
usšg
 
	gVeùÜY
 = 
AccumVeùÜ
<
M©rix
, 
	gAccumA¼ay
>;

239 cÚ¡ 
	gG¿ph
<
	gW
>* 
	gG
;

242 cÚ¡ 
boŞ
 
	gowns_v”tiûs
 = 
Œue
;

244 
VeùÜV
* 
	gv
 = 
nuÎ±r
;

246 
VeùÜX
* 
	gx
 = 
nuÎ±r
;

248 
VeùÜY
* 
	gy
 = 
nuÎ±r
;

259 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

260 
execu‹_2d
(
ušt32_t
 
max_™”s
);

266 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

267 
execu‹_1d_cŞ
(
ušt32_t
 
max_™”s
);

272 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

273 
execu‹_2d_nÚ_İt
(
ušt32_t
 
max_™”s
);

279 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

280 
execu‹_1d_cŞ_nÚ_İt
(
ušt32_t
 
max_™”s
);

285 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

286 
execu‹_sšgË_2d
();

292 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

293 
execu‹_sšgË_1d_cŞ
();

303 
boŞ
 
	gg©h”_d•’ds_Ú_¡©e
 = 
çl£
;

310 
boŞ
 
	g­¶y_d•’ds_Ú_™”
 = 
çl£
;

317 
boŞ
 
	gš™Ÿlized
 = 
çl£
;

319 
š™Ÿlize_æags
();

324 
sÿ‰”_sourû_mes§ges
();

326 
	g‹m¶©e
 <
boŞ
 
	gsourû
, 
P¬t™iÚšg
 
	g·¹™iÚšg
>

327 
	gSŒ—mšgA¼ay
<
	gM
>& 
»ûive_jth_x£g
(
ušt32_t
 
jth
);

329 
	g‹m¶©e
 <
boŞ
 
	gsšk
, 
P¬t™iÚšg
 
	g·¹™iÚšg
, boŞ 
	gmœrÜšg
>

330 
´oûss_mes§ges
(
ušt32_t
 
™”
 = 0);

332 
	g‹m¶©e
 <
boŞ
 
	gsšk
, 
P¬t™iÚšg
 
	g·¹™iÚšg
, boŞ 
	gmœrÜšg
>

333 
boŞ
 
´oûss_»ady_mes§ges
(cÚ¡ 
¡d
::
veùÜ
<
št32_t
>& 
»ady
, 
ušt32_t
 
™”
);

335 
	g‹m¶©e
 <
boŞ
 
	gg©h”_w™h_¡©e
>

336 
SpMV
(cÚ¡ 
CSC
<
W
>& 
csc
,

337 
SŒ—mšgA¼ay
<
M
>& 
x£g
,

338 
RªdomAcûssA¼ay
<
A
>& 
y£g
,

339 
RªdomAcûssA¼ay
<
S
>* 
v£g
,

340 
ušt32_t
 
sšk_off£t
 );

347 
	g‹m¶©e
 <
boŞ
 
	gsšk
, boŞ 
	gsšgË_™”
>

348 
boŞ
 
´oduû_mes§ges
(
ušt32_t
 
™”
 = 0);

350 
combše_accumuÏtÜs
(
AccumA¼ay
&, 
AccumFš®Segm’t
<
M©rix
, AccumArray>&);

353 
	g‹m¶©e
 <
boŞ
 
	gsšk
, boŞ 
	g­¶y_w™h_™”
, boŞ 
	gsšgË_™”
>

354 
boŞ
 
­¶y_ªd_sÿ‰”_mes§ges
(
AccumFš®Segm’t
<
M©rix
, 
AccumA¼ay
>&, 
ušt32_t
 
™”
 = 0);

357 
boŞ
 
has_cÚv”ged_glob®ly
(boŞ 
has_cÚv”ged_loÿÎy
, 
MPI_Reque¡
&);

360 
	gpublic
:

364 cÚ¡ 
G¿ph
<
W
>* 
	$g‘_g¿ph
(ècÚ¡ {  
G
; 
	}
}

366 
VeùÜV
* 
	$g‘_veùÜ_v
(ècÚ¡ {  
v
; 
	}
}

371 
	g‹m¶©e
 <>

372 
	gEdge
<
	gEm±y
>

374 cÚ¡ 
ušt32_t
 
	g¤c
, 
	gd¡
;

376 cÚ¡ 
	gEm±y
& 
	gweight
;

378 
Edge
(è: 
¤c
(0), 
d¡
(0), 
weight
(
Em±y
::
EMPTY
) {}

380 
Edge
(cÚ¡ 
ušt32_t
 
¤c
, cÚ¡ ušt32_ˆ
d¡
, cÚ¡ 
Em±y
* 
weight
)

381 : 
¤c
(¤c), 
d¡
(d¡), 
weight
(
Em±y
::
EMPTY
) {}

386 
	~"v´og¿m/v”‹x_´og¿m.hµ
"

387 
	~"v´og¿m/v”‹x_´og¿m_execu‹.hµ
"

	@src/vprogram/vertex_program.hpp

5 #iâdeà
VERTEX_PROGRAM_HPP


6 
	#VERTEX_PROGRAM_HPP


	)

8 
	~"v´og¿m/v”‹x_´og¿m.h
"

11 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

12 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
(cÚ¡ 
G¿ph
<
W
>* 
G
, 
boŞ
 
¡©iÚ¬y
)

13 : 
G
(G), 
owns_v”tiûs
(
Œue
), 
	$¡©iÚ¬y
(
¡©iÚ¬y
)

15 
v
 = 
Ãw
 
	`VeùÜV
(
G
->
	`g‘_m©rix
());

16 
x
 = 
Ãw
 
	`VeùÜX
(
G
->
	`g‘_m©rix
());

17 
y
 = 
Ãw
 
	`VeùÜY
(
G
->
	`g‘_m©rix
());

18 
	}
}

21 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

22 
	g‹m¶©e
 <
şass
 
	gM2
, cÏs 
	gA2
>

23 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
V”‹xProg¿m
(cÚ¡ V”‹xProg¿m<
W
, 
M2
, 
A2
, 
S
>& 
Ùh”
, 
boŞ
 
¡©iÚ¬y
)

24 : 
owns_v”tiûs
(
çl£
), 
	$¡©iÚ¬y
(
¡©iÚ¬y
)

26 
G
 = 
Ùh”
.
	`g‘_g¿ph
();

27 
v
 = 
Ùh”
.
	`g‘_veùÜ_v
();

28 
x
 = 
Ãw
 
	`VeùÜX
(
G
->
	`g‘_m©rix
());

29 
y
 = 
Ãw
 
	`VeùÜY
(
G
->
	`g‘_m©rix
());

30 
	}
}

33 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

34 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::~
	$V”‹xProg¿m
()

35 { 
	`ä“
(); 
	}
}

38 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

39 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$ä“
()

41 ià(
owns_v”tiûs
)

42 
d–‘e
 
v
;

43 
d–‘e
 
x
;

44 
d–‘e
 
y
;

45 
v
 = 
nuÎ±r
;

46 
x
 = 
nuÎ±r
;

47 
y
 = 
nuÎ±r
;

48 
	}
}

51 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

52 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$»£t
()

54 
š™Ÿlized
 = 
çl£
;

55 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
èx£g.
	`ş—r
();

56 auto& 
x£g
 : 
x
->
šcomšg
.
sourû
èx£g.
	`ş—r
();

57 auto& 
x£g
 : 
x
->
outgošg
.
sourû
èx£g.
	`ş—r
();

58 auto& 
x£g
 : 
x
->
outgošg
.
»guÏr
èx£g.
	`ş—r
();

59 auto& 
y£g
 : 
y
->
loÿl_£gs
èy£g.
	`ş—r
();

60 auto& 
y£g
 : 
y
->
loÿl_£gs_sšk
èy£g.
	`ş—r
();

61 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`ş—r
();

62 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`ş—r
();

63 
	}
}

66 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

67 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$š™Ÿlize_æags
()

69 cÚ¡ 
Edge
<
W
> 
edge
 = Edge<W>();

70 cÚ¡ 
M
 
msg
 = 
	`M
();

71 cÚ¡ 
A
 
accum
 = 
	`A
();

72 cÚ¡ 
S
 
¡©e
 = 
	`S
();

73 
g©h”_d•’ds_Ú_¡©e
 = 
Œue
;

74 
	`g©h”
(
edge
, 
msg
, 
¡©e
);

75 
­¶y_d•’ds_Ú_™”
 = 
Œue
;

76 
	`­¶y
(
accum
, (
S
&è
¡©e
, 0);

77 
İtimizabË
 &ğ
	`nÙ
 (
nÙ
 
G
->
	`is_dœeùed
(è
Ü
 
g©h”_d•’ds_Ú_¡©e
 o¸
­¶y_d•’ds_Ú_™”
);

78 
š™Ÿlized
 = 
Œue
;

79 
LOG
.
	`debug
("optimizable %u, gather_depends_on_state %u,‡pply_depends_on_iter %u \n",

80 
İtimizabË
, 
g©h”_d•’ds_Ú_¡©e
, 
­¶y_d•’ds_Ú_™”
);

81 
	}
}

84 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

85 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$š™Ÿlize
()

87 
	`š™Ÿlize_æags
();

89 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

91 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
èx£g.
	`»cv
();

92 auto& 
x£g
 : 
x
->
šcomšg
.
sourû
èx£g.
	`»cv
();

95 ià(
g©h”_d•’ds_Ú_¡©e
)

97 
v
->
	`®loÿ‹_mœrÜs
();

98 auto& 
v£g
 : 
v
->
mœ_£gs_»g
->
£gs
èv£g.
	`»cv
();

99 auto& 
v£g
 : 
v
->
mœ_£gs_¢k
->
£gs
èv£g.
	`»cv
();

102 auto& 
v£g
 : 
v
->
own_£gs
)

104 auto& 
x£g
 = 
x
->
outgošg
.
»guÏr
[
v£g
.
kth
];

105 auto& 
x£g_
 = 
x
->
outgošg
.
sourû
[
v£g
.
kth
];

109 
	`as£¹
(
x£g
.
	`size
(è=ğ
v£g
.
loÿtÜ
->
	`ÄeguÏr
());

111 autØ
i
 = 0u; i < 
x£g
.
	`size
(); i++)

113 
ušt32_t
 
hidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

114 
ušt32_t
 
idx
 = (ušt32_tè
G
->
	`g‘_hash”
()->
	`unhash
(
hidx
);

115 ià(
	`š™
(
idx
, 
v£g
[
i
]))

117 
v£g
.
aùiv™y
->
	`push
(
i
);

118 
x£g
.
	`push
(
i
, 
	`sÿ‰”
(
v£g
[i]));

122 ià(
g©h”_d•’ds_Ú_¡©e
)

124 
v£g
.
	`bÿ¡
();

125 
v£g
.
aùiv™y
->
	`ş—r
();

128 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

129 
x£g
.
	`bÿ¡
();

133 autØ
i_
 = 0u; i_ < 
v£g
.
loÿtÜ
->
	`nsšk
(); i_++)

135 autØ
i
 = 
v£g
.
loÿtÜ
->
	`ÄeguÏr
(è+ 
i_
;

136 
ušt32_t
 
idx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

137 
idx
 = (
ušt32_t
è
G
->
	`g‘_hash”
()->
	`unhash
(idx);

138 ià(
	`š™
(
idx
, 
v£g
[
i
]))

139 
v£g
.
aùiv™y
->
	`push
(
i
);

142 ià(
g©h”_d•’ds_Ú_¡©e
)

144 
v£g
.
‹m¶©e
 
bÿ¡
<
Œue
>();

145 
v£g
.
aùiv™y
->
	`ş—r
();

150 
	`as£¹
(
x£g_
.
	`size
(è=ğ
v£g
.
loÿtÜ
->
	`nsourû
());

152 autØ
i_
 = 0u; i_ < 
x£g_
.
	`size
(); i_++)

154 autØ
i
 = 
v£g
.
loÿtÜ
->
	`ÄeguÏr
(è+ v£g.loÿtÜ->
	`nsšk
(è+ 
i_
;

155 
ušt32_t
 
idx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

156 
idx
 = (
ušt32_t
è
G
->
	`g‘_hash”
()->
	`unhash
(idx);

157 ià(
	`š™
(
idx
, 
v£g
[
i
]))

158 
x£g_
.
	`push
(
i_
, 
	`sÿ‰”
(
v£g
[
i
]));

162 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

163 
x£g_
.
	`bÿ¡
();

167 
ušt32_t
 
isŞ©ed_off£t


168 ğ
v£g
.
loÿtÜ
->
	`ÄeguÏr
(è+ v£g.loÿtÜ->
	`nsšk
(è+ v£g.loÿtÜ->
	`nsourû
();

170 
ušt32_t
 
nisŞ©ed
 = 
v£g
.
	`size
(è- 
isŞ©ed_off£t
;

172 autØ
i_
 = 0u; i_ < 
nisŞ©ed
; i_++)

174 autØ
i
 = 
isŞ©ed_off£t
 + 
i_
;

175 
ušt32_t
 
hidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

176 
ušt32_t
 
idx
 = (ušt32_tè
G
->
	`g‘_hash”
()->
	`unhash
(
hidx
);

177 
	`š™
(
idx
, 
v£g
[
i
]);

180 
	}
}

185 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

186 
	g‹m¶©e
 <
şass
 
	gW2
, cÏs 
	gM2
, cÏs 
	gA2
, cÏs 
	gS2
>

187 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
š™Ÿlize
(cÚ¡ 
V”‹xProg¿m
<
W2
, 
M2
, 
A2
, 
S2
>& 
Ùh”
)

189 
š™Ÿlize_æags
();

191 ià(
	gG
->
g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

193 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
èx£g.
»cv
();

194 auto& 
	gx£g
 : 
x
->
šcomšg
.
sourû
è
x£g
.
»cv
();

197 ià(
	gg©h”_d•’ds_Ú_¡©e
)

199 
	gv
->
®loÿ‹_mœrÜs
();

200 auto& 
	gv£g
 : 
v
->
mœ_£gs_»g
->
£gs
è
v£g
.
»cv
();

201 auto& 
	gv£g
 : 
v
->
mœ_£gs_¢k
->
£gs
è
v£g
.
»cv
();

204 auto& 
	gv£g
 : 
v
->
own_£gs
)

206 auto& 
x£g
 = 
x
->
outgošg
.
»guÏr
[
v£g
.
kth
];

207 auto& 
	gx£g_
 = 
x
->
outgošg
.
sourû
[
v£g
.
kth
];

209 autØ
	gi
 = 0u; i < 
	gx£g
.
size
(); i++)

211 
ušt32_t
 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

212 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

213 ià(
š™
(
idx
, (
Ùh”
.
g‘_veùÜ_v
()->
own_£gs
[
v£g
.
kth
][
i
]), vseg[i]))

215 
	gv£g
.
	gaùiv™y
->
push
(
i
);

216 
	gx£g
.
push
(
i
, 
sÿ‰”
(
v£g
[i]));

220 ià(
	gg©h”_d•’ds_Ú_¡©e
)

222 
	gv£g
.
bÿ¡
();

223 
	gv£g
.
	gaùiv™y
->
ş—r
();

226 ià(
	gG
->
g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

227 
x£g
.
bÿ¡
();

229 autØ
	gi_
 = 0u; i_ < 
	gv£g
.
	gloÿtÜ
->
nsšk
(); i_++)

231 autØ
	gi
 = 
v£g
.
loÿtÜ
->
ÄeguÏr
(è+ 
i_
;

232 autØ
	gj
 = 
v£g
.
loÿtÜ
->
ÄeguÏr
(è+ v£g.loÿtÜ->
nsourû
(è+ 
i_
;

233 
ušt32_t
 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

234 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

235 ià(
š™
(
idx
, (
Ùh”
.
g‘_veùÜ_v
()->
own_£gs
[
v£g
.
kth
][
j
]), v£g[
i
]))

236 
	gv£g
.
	gaùiv™y
->
push
(
i
);

239 ià(
	gg©h”_d•’ds_Ú_¡©e
)

241 
	gv£g
.
‹m¶©e
 
	gbÿ¡
<
	gŒue
>();

242 
	gv£g
.
	gaùiv™y
->
ş—r
();

245 
as£¹
(
x£g_
.
size
(è=ğ
v£g
.
loÿtÜ
->
nsourû
());

247 autØ
	gi_
 = 0u; i_ < 
	gx£g_
.
size
(); i_++)

249 autØ
	gj
 = 
v£g
.
loÿtÜ
->
ÄeguÏr
(è+ 
i_
;

250 autØ
	gi
 = 
v£g
.
loÿtÜ
->
ÄeguÏr
(è+ v£g.loÿtÜ->
nsšk
(è+ 
i_
;

251 
ušt32_t
 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

252 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

253 ià(
š™
(
idx
, (
Ùh”
.
g‘_veùÜ_v
()->
own_£gs
[
v£g
.
kth
][
j
]), v£g[
i
]))

254 
	gx£g_
.
push
(
i_
, 
sÿ‰”
(
v£g
[
i
]));

257 ià(
	gG
->
g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

258 
x£g_
.
bÿ¡
();

260 
ušt32_t
 
	gisŞ©ed_off£t


261 ğ
v£g
.
loÿtÜ
->
ÄeguÏr
(è+ v£g.loÿtÜ->
nsšk
(è+ v£g.loÿtÜ->
nsourû
();

263 
ušt32_t
 
	gnisŞ©ed
 = 
v£g
.
size
(è- 
isŞ©ed_off£t
;

265 autØ
	gi_
 = 0u; i_ < 
	gnisŞ©ed
; i_++)

267 autØ
	gi
 = 
isŞ©ed_off£t
 + 
i_
;

268 
ušt32_t
 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

269 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

270 
š™
(
idx
, (
Ùh”
.
g‘_veùÜ_v
()->
own_£gs
[
v£g
.
kth
][
i
]), vseg[i]);

276 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

277 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$di¥Ïy
(
ušt32_t
 
nv”tiûs
)

279 
nv”tiûs
 = 
¡d
::
	`mš
Òv”tiûs, 
G
->
	`g‘_nv”tiûs
());

281 auto& 
own_v£g
 : 
v
->
own_£gs
)

283 autØ
i
 = 0u; i < 
own_v£g
.
	`size
(); i++)

285 autØ
j
 = 
i
 + 
own_v£g
.
off£t
;

286 autØ
loc
 = 
own_v£g
.
	`š‹º®_äom_Üigš®
(
j
);

287 
j
 = 
	`g‘_g¿ph
()->
	`g‘_hash”
()->
	`unhash
(j);

288 ià(
j
 >ğ0 
ªd
 j <ğ
nv”tiûs
)

289 
LOG
.
šfo
<
çl£
>("%u %s\n", 
j
, 
own_v£g
[
loc
].
	`to_¡ršg
().
	`c_¡r
());

292 
	}
}

295 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

296 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$»£t_aùiv™y
()

297 { auto& 
v£g
 : 
v
->
own_£gs
èv£g.
aùiv™y
->
	`ş—r
(); 
	}
}

301 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

302 
	g‹m¶©e
 <
şass
 
	gV®ue
, cÏs 
	gM­³r
, cÏs 
	gReduûr
>

303 
V®ue
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$»duû
(
M­³r
 
m­
, 
Reduûr
 
»duû
, 
boŞ
 
aùive_Úly
)

305 
V®ue
 
r
 = 
	`V®ue
();

307 auto& 
v£g
 : 
v
->
own_£gs
)

309 ià(
aùive_Úly
)

311 
v£g
.
	`»wšd
();

312 
ušt32_t
 
idx
 = 0;

313 
S
 
v®
 = 
	`S
();

314 
v£g
.
	`Ãxt
(
idx
, 
v®
))

316 
idx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[idx];

317 
idx
 = (
ušt32_t
è
G
->
	`g‘_hash”
()->
	`unhash
(idx);

318 
	`»duû
(
r
, 
	`m­
(
idx
, 
v®
));

323 
ušt32_t
 
i
 = 0; i < 
v£g
.
	`size
(); i++)

325 
ušt32_t
 
idx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

326 
idx
 = (
ušt32_t
è
G
->
	`g‘_hash”
()->
	`unhash
(idx);

327 
	`»duû
(
r
, 
	`m­
(
idx
, 
v£g
[
i
]));

332 
V®ue
 
fš®_v
 = 
	`V®ue
();

333 
¡d
::
veùÜ
<
V®ue
> 
	`cŞËùiÚ
(
Env
::
is_ma¡”
 ? (Env::
Äªks
) : 0);

335 
	`MPI_G©h”
(&
r
, (
V®ue
), 
MPI_BYTE
, 
cŞËùiÚ
.
	`d©a
(), (Value), MPI_BYTE,

336 0, 
Env
::
MPI_WORLD
);

338 ià(
Env
::
is_ma¡”
)

340 auto& 
v
 : 
cŞËùiÚ
)

341 
	`»duû
(
fš®_v
, 
v
);

344 
	`MPI_Bÿ¡
(&
fš®_v
, (
V®ue
), 
MPI_BYTE
, 0, 
Env
::
MPI_WORLD
);

345  
fš®_v
;

346 
	}
}

350 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

351 
	g‹m¶©e
 <
şass
 
	gI
, cÏs 
	gV
, cÏs 
	gM­³r
, cÏs 
	gCom·¿tÜ
>

352 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
tİk
(
ušt32_t
 
k
, 
¡d
::
veùÜ
<¡d::
·œ
<
I
, 
V
>>&opk,

353 
M­³r
 
m­
, 
Com·¿tÜ
 
cmp
, 
boŞ
 
aùive_Úly
)

355 
usšg
 
	giv_t
 = 
¡d
::
·œ
<
I
, 
	gV
>;

356 
	g¡d
::
veùÜ
<
iv_t
> 
ivs
;

358 
	gtİk
.
ş—r
();

361 auto& 
	gv£g
 : 
v
->
own_£gs
)

363 ià(
aùive_Úly
)

365 
v£g
.
»wšd
();

366 
I
 
	gidx
 = 0;

367 
S
 
	gv®
 = S();

368 
	gv£g
.
Ãxt
(
idx
, 
v®
))

370 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
idx
];

371 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

372 
	givs
.
push_back
(
iv_t
(
idx
, 
m­
(idx, 
v®
)));

377 
ušt32_t
 
	gi
 = 0; i < 
	gv£g
.
size
(); i++)

379 
ušt32_t
 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

380 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

381 
	givs
.
push_back
(
iv_t
(
idx
, 
m­
(idx, 
v£g
[
i
])));

387 
	g¡d
::
·¹Ÿl_sÜt
(
ivs
.
begš
(), ivs.begš(è+ 
¡d
::
mš
(
k
, (
ušt32_t
èivs.
size
()), ivs.
’d
(), 
cmp
);

390 ià(
	gEnv
::
is_ma¡”
)

392 
ivs
.
»size
(
k
 * 
Env
::
Äªks
);

393 
MPI_G©h”
(
MPI_IN_PLACE
, 0, 
MPI_DATATYPE_NULL
, 
ivs
.
d©a
(), (
iv_t
è* 
k
, 
MPI_BYTE
,

394 0, 
Env
::
MPI_WORLD
);

398 
	givs
.
»size
(
k
);

399 
MPI_G©h”
(
ivs
.
d©a
(), (
iv_t
è* 
k
, 
MPI_BYTE
, ivs.data(), (iv_t) * k, MPI_BYTE,

400 0, 
Env
::
MPI_WORLD
);

404 
	g¡d
::
·¹Ÿl_sÜt
(
ivs
.
begš
(), ivs.begš(è+ 
¡d
::
mš
(
k
, (
ušt32_t
èivs.
size
()), ivs.
’d
(), 
cmp
);

405 
	givs
.
»size
(
k
);

408 
MPI_Bÿ¡
(
ivs
.
d©a
(), (
iv_t
è* 
k
, 
MPI_BYTE
, 0, 
Env
::
MPI_WORLD
);

410 autØ
	giv
 : 
ivs
)

411 
tİk
.
push_back
(
iv
);

417 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

418 
	g‹m¶©e
 <
ušt32_t
 
	gBATCH_SIZE
, 
şass
 
	gI
, cÏs 
	gV
, cÏs 
	gM­³r
, cÏs 
	gCom·¿tÜ
>

419 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
btİk
(
ušt32_t
 
k
, 
¡d
::
veùÜ
<¡d::
·œ
<
I
, 
V
>>* 
tİk
,

420 
M­³r
 
m­
, 
Com·¿tÜ
 
cmp
, 
boŞ
 
aùive_Úly
)

422 
usšg
 
	giv_t
 = 
¡d
::
·œ
<
I
, 
	gV
>;

424 
	g¡d
::
veùÜ
<
iv_t
> 
ivs
[
BATCH_SIZE
];

426 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

427 
	gtİk
[
b
].
ş—r
();

430 auto& 
	gv£g
 : 
v
->
own_£gs
)

432 ià(
aùive_Úly
)

434 
v£g
.
»wšd
();

435 
I
 
	gidx
 = 0;

436 
S
 
	gv®
 = S();

437 
	gv£g
.
Ãxt
(
idx
, 
v®
))

439 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
idx
];

440 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

441 
V
* 
	gv®s
 = 
m­
(
idx
, 
v®
);

442 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

443 
	givs
[
b
].
push_back
(
iv_t
(
idx
, 
v®s
[b]));

448 
ušt32_t
 
	gi
 = 0; i < 
	gv£g
.
size
(); i++)

450 
ušt32_t
 
	gidx
 = 
v£g
.
off£t
 + v£g.
Üigš®_äom_š‹º®_m­
[
i
];

451 
	gidx
 = (
ušt32_t
è
G
->
g‘_hash”
()->
unhash
(
idx
);

452 
V
* 
	gv®s
 = 
m­
(
idx
, 
v£g
[
i
]);

453 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

454 
	givs
[
b
].
push_back
(
iv_t
(
idx
, 
v®s
[b]));

460 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

461 
	g¡d
::
·¹Ÿl_sÜt
(
ivs
[
b
].
begš
(), ivs[b].begš(è+ 
¡d
::
mš
(
k
, (
ušt32_t
èivs[b].
size
()),

462 
ivs
[
b
].
’d
(), 
cmp
);

466 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

468 ià(
	gEnv
::
is_ma¡”
)

470 
ivs
[
b
].
»size
(
k
 * 
Env
::
Äªks
);

471 
MPI_G©h”
(
MPI_IN_PLACE
, 0, 
MPI_DATATYPE_NULL
, 
ivs
[
b
].
d©a
(), (
iv_t
è* 
k
,

472 
MPI_BYTE
, 0, 
Env
::
MPI_WORLD
);

476 
	givs
[
b
].
»size
(
k
);

477 
MPI_G©h”
(
ivs
[
b
].
d©a
(), (
iv_t
è* 
k
, 
MPI_BYTE
, ivs[b].data(), (iv_t) * k,

478 
MPI_BYTE
, 0, 
Env
::
MPI_WORLD
);

482 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

485 
	g¡d
::
·¹Ÿl_sÜt
(
ivs
[
b
].
begš
(), ivs[b].begš(è+ 
¡d
::
mš
(
k
, (
ušt32_t
èivs[b].
size
()),

486 
ivs
[
b
].
’d
(), 
cmp
);

487 
	givs
[
b
].
»size
(
k
);

492 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

493 
MPI_Bÿ¡
(
ivs
[
b
].
d©a
(), (
iv_t
è* 
k
, 
MPI_BYTE
, 0, 
Env
::
MPI_WORLD
);

495 autØ
	gb
 = 0; b < 
	gBATCH_SIZE
; b++)

497 autØ
	giv
 : 
ivs
[
b
])

498 
tİk
[
b
].
push_back
(
iv
);

	@src/vprogram/vertex_program_execute.hpp

5 #iâdeà
VERTEX_PROGRAM_EXECUTE_HPP


6 
	#VERTEX_PROGRAM_EXECUTE_HPP


	)

8 
	~"v´og¿m/v”‹x_´og¿m.h
"

11 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

12 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹
(
ušt32_t
 
max_™”s
)

14 ià(
nÙ
 
š™Ÿlized
)

15 
	`š™Ÿlize
();

17 ià(
max_™”s
 == 1)

19 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_1D_COL
)

21 ià(
g©h”_d•’ds_Ú_¡©e
è
execu‹_sšgË_1d_cŞ
<
Œue
>();

22 
execu‹_sšgË_1d_cŞ
<
çl£
>();

24 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

26 ià(
g©h”_d•’ds_Ú_¡©e
è
execu‹_sšgË_2d
<
Œue
>();

27 
execu‹_sšgË_2d
<
çl£
>();

30 ià(
nÙ
 
İtimizabË
)

32 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_1D_COL
)

34 ià(
g©h”_d•’ds_Ú_¡©e
è
execu‹_1d_cŞ_nÚ_İt
<
Œue
>(
max_™”s
);

35 
execu‹_1d_cŞ_nÚ_İt
<
çl£
>(
max_™”s
);

37 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

39 ià(
g©h”_d•’ds_Ú_¡©e
è
execu‹_2d_nÚ_İt
<
Œue
>(
max_™”s
);

40 
execu‹_2d_nÚ_İt
<
çl£
>(
max_™”s
);

45 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_1D_COL
)

47 ià(
g©h”_d•’ds_Ú_¡©e
è
execu‹_1d_cŞ
<
Œue
>(
max_™”s
);

48 
execu‹_1d_cŞ
<
çl£
>(
max_™”s
);

50 ià(
G
->
	`g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
)

52 ià(
g©h”_d•’ds_Ú_¡©e
è
execu‹_2d
<
Œue
>(
max_™”s
);

53 
execu‹_2d
<
çl£
>(
max_™”s
);

62 
	}
}

65 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

66 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

67 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹_2d
(
ušt32_t
 
max_™”s
)

70 
	`sÿ‰”_sourû_mes§ges
();

71 
	`»£t_aùiv™y
();

74 
ušt32_t
 
™”
 = 0;

75 
boŞ
 
uÁ_cÚv”g’û
 = 
max_™”s
 =ğ
UNTIL_CONVERGENCE
;

76 
boŞ
 
has_cÚv”ged
 = 
çl£
;

77 
MPI_Reque¡
 
cÚv”g’û_»q
 = 
MPI_REQUEST_NULL
;

79 
uÁ_cÚv”g’û
 ? 
nÙ
 
has_cÚv”ged
 : 
™”
 < 
max_™”s
)

81 
Di¡Tim”
 
	`™_tim”
("I‹¿tiÚ " + 
¡d
::
	`to_¡ršg
(
™”
 + 1));

82 
LOG
.
	`šfo
("Executšg I‹¿tiÚ %u\n", 
™”
 + 1);

85 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`g©h”
();

87 
´oûss_mes§ges
<
çl£
, 
P¬t™iÚšg
::
_2D
, 
mœrÜšg
>(
™”
);

90 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
èx£g.
	`»cv
();

92 
has_cÚv”ged
 = 
nÙ
 
´oduû_mes§ges
<
çl£
, f®£>(
™”
);

94 ià(
uÁ_cÚv”g’û
)

95 
has_cÚv”ged
 = 
	`has_cÚv”ged_glob®ly
(has_cÚv”ged, 
cÚv”g’û_»q
);

97 
™_tim”
.
	`¡İ
();

99 
™”
++;

103 
Di¡Tim”
 
	`fš®_wa™_tim”
("Final Wait");

104 
LOG
.
	`debug
("Final Wait \n");

106 dØ{ 
x
->
	`wa™_fÜ_some
(); }

107 
nÙ
 
x
->
	`no_mÜe_£gs_th’_ş—r
());

109 auto& 
x£g
: 
x
->
outgošg
.
»guÏr
èx£g.
	`po¡´oûss
();

110 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
)

112 
x£g
.
	`ş—r
();

113 
x£g
.
	`œecv_po¡´oûss
(
x
->
blobs
[x£g.
jth
]);

116 ià(
g©h”_d•’ds_Ú_¡©e
)

117 auto& 
v£g
: 
v
->
own_£gs
èv£g.
	`po¡´oûss
();

119 
fš®_wa™_tim”
.
	`¡İ
();

123 ià(
	`g‘_g¿ph
()->
	`is_dœeùed
())

125 
Di¡Tim”
 
	`sšk_tim”
("Sink Processing");

126 
LOG
.
	`debug
("Executing Sink Processing \n");

128 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
èx£g.
	`»cv
();

130 auto& 
v£g
 : 
v
->
own_£gs
)

132 auto& 
x£g
 = 
x
->
outgošg
.
»guÏr
[
v£g
.
kth
];

133 
ušt32_t
 
idx
 = 0; idx < 
x£g
.
	`size
(); idx++)

134 
x£g
.
	`push
(
idx
, 
	`sÿ‰”
(
v£g
[idx]));

135 
x£g
.
	`bÿ¡
();

138 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`g©h”
();

140 
´oûss_mes§ges
<
Œue
, 
P¬t™iÚšg
::
_2D
, 
mœrÜšg
>(
™”
);

141 
´oduû_mes§ges
<
Œue
, 
çl£
>(
™”
);

143 dØ{ 
x
->
	`wa™_fÜ_some
(); }

144 
nÙ
 
x
->
	`no_mÜe_£gs_th’_ş—r
());

146 ià(
g©h”_d•’ds_Ú_¡©e
)

147 auto& 
v£g
: 
v
->
own_£gs
èv£g.
‹m¶©e
 
po¡´oûss
<
Œue
>();

149 
sšk_tim”
.
	`¡İ
();

151 
LOG
.
	`debug
("Done withƒxecute() \n");

154 auto& 
x£g
: 
x
->
outgošg
.
»guÏr
èx£g.
	`po¡´oûss
();

155 auto& 
y£g
: 
y
->
loÿl_£gs
èy£g.
	`po¡´oûss
();

156 auto& 
y£g
: 
y
->
loÿl_£gs_sšk
èy£g.
	`po¡´oûss
();

157 
	}
}

160 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

161 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

162 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹_1d_cŞ
(
ušt32_t
 
max_™”s
)

164 
	`»£t_aùiv™y
();

167 
ušt32_t
 
™”
 = 0;

168 
boŞ
 
uÁ_cÚv”g’û
 = 
max_™”s
 =ğ
UNTIL_CONVERGENCE
;

169 
boŞ
 
has_cÚv”ged
 = 
çl£
;

170 
MPI_Reque¡
 
cÚv”g’û_»q
 = 
MPI_REQUEST_NULL
;

172 
uÁ_cÚv”g’û
 ? 
nÙ
 
has_cÚv”ged
 : 
™”
 < 
max_™”s
)

174 
Di¡Tim”
 
	`™_tim”
("I‹¿tiÚ " + 
¡d
::
	`to_¡ršg
(
™”
 + 1));

178 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`g©h”
();

180 
´oûss_mes§ges
<
çl£
, 
P¬t™iÚšg
::
_1D_COL
, 
mœrÜšg
>(
™”
);

182 
has_cÚv”ged
 = 
nÙ
 
´oduû_mes§ges
<
çl£
, f®£>(
™”
);

184 ià(
uÁ_cÚv”g’û
)

185 
has_cÚv”ged
 = 
	`has_cÚv”ged_glob®ly
(has_cÚv”ged, 
cÚv”g’û_»q
);

187 
™_tim”
.
	`¡İ
();

189 
™”
++;

193 
Di¡Tim”
 
	`fš®_wa™_tim”
("Final Wait");

194 ià(
g©h”_d•’ds_Ú_¡©e
)

195 auto& 
v£g
: 
v
->
own_£gs
èv£g.
	`po¡´oûss
();

196 
fš®_wa™_tim”
.
	`¡İ
();

200 ià(
	`g‘_g¿ph
()->
	`is_dœeùed
())

202 
Di¡Tim”
 
	`sšk_tim”
("Sink Processing");

205 auto& 
v£g
 : 
v
->
own_£gs
)

207 auto& 
x£g
 = 
x
->
outgošg
.
»guÏr
[
v£g
.
kth
];

208 
ušt32_t
 
idx
 = 0; idx < 
x£g
.
	`size
(); idx++)

209 
x£g
.
	`push
(
idx
, 
	`sÿ‰”
(
v£g
[idx]));

210 
x£g
.
	`bÿ¡
();

213 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`g©h”
();

215 
´oûss_mes§ges
<
Œue
, 
P¬t™iÚšg
::
_1D_COL
, 
mœrÜšg
>(
™”
);

216 
´oduû_mes§ges
<
Œue
, 
çl£
>(
™”
);

218 
sšk_tim”
.
	`¡İ
();

223 auto& 
y£g
: 
y
->
loÿl_£gs
èy£g.
	`po¡´oûss
();

224 auto& 
y£g
: 
y
->
loÿl_£gs_sšk
èy£g.
	`po¡´oûss
();

225 
	}
}

228 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

229 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

230 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹_2d_nÚ_İt
(
ušt32_t
 
max_™”s
)

233 
	`sÿ‰”_sourû_mes§ges
();

234 
	`»£t_aùiv™y
();

237 
ušt32_t
 
™”
 = 0;

238 
boŞ
 
uÁ_cÚv”g’û
 = 
max_™”s
 =ğ
UNTIL_CONVERGENCE
;

239 
boŞ
 
has_cÚv”ged
 = 
çl£
;

240 
MPI_Reque¡
 
cÚv”g’û_»q
 = 
MPI_REQUEST_NULL
;

242 
uÁ_cÚv”g’û
 ? 
nÙ
 
has_cÚv”ged
 : 
™”
 < 
max_™”s
)

244 
Di¡Tim”
 
	`™_tim”
("I‹¿tiÚ " + 
¡d
::
	`to_¡ršg
(
™”
 + 1));

245 
LOG
.
	`šfo
("Executšg I‹¿tiÚ %u\n", 
™”
 + 1);

248 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`g©h”
();

249 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`g©h”
();

251 
´oûss_mes§ges
<
çl£
, 
P¬t™iÚšg
::
_2D
, 
mœrÜšg
>(
™”
);

252 
´oûss_mes§ges
<
Œue
, 
P¬t™iÚšg
::
_2D
, 
mœrÜšg
>(
™”
);

255 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
èx£g.
	`»cv
();

257 
has_cÚv”ged
 = 
nÙ
 
´oduû_mes§ges
<
çl£
, f®£>(
™”
);

258 
has_cÚv”ged
 &ğ
nÙ
 
´oduû_mes§ges
<
Œue
, 
çl£
>(
™”
);

260 ià(
uÁ_cÚv”g’û
)

261 
has_cÚv”ged
 = 
	`has_cÚv”ged_glob®ly
(has_cÚv”ged, 
cÚv”g’û_»q
);

263 
™_tim”
.
	`¡İ
();

265 
™”
++;

269 
Di¡Tim”
 
	`fš®_wa™_tim”
("Final Wait");

270 
LOG
.
	`debug
("Final Wait \n");

272 dØ{ 
x
->
	`wa™_fÜ_some
(); }

273 
nÙ
 
x
->
	`no_mÜe_£gs_th’_ş—r
());

275 auto& 
x£g
: 
x
->
outgošg
.
»guÏr
èx£g.
	`po¡´oûss
();

276 auto& 
x£g
 : 
x
->
šcomšg
.
»guÏr
)

278 
x£g
.
	`ş—r
();

279 
x£g
.
	`œecv_po¡´oûss
(
x
->
blobs
[x£g.
jth
]);

282 ià(
g©h”_d•’ds_Ú_¡©e
)

283 auto& 
v£g
: 
v
->
own_£gs
èv£g.
	`po¡´oûss
();

285 
fš®_wa™_tim”
.
	`¡İ
();

287 
LOG
.
	`debug
("Done withƒxecute() \n");

290 auto& 
x£g
: 
x
->
outgošg
.
»guÏr
èx£g.
	`po¡´oûss
();

291 auto& 
y£g
: 
y
->
loÿl_£gs
èy£g.
	`po¡´oûss
();

292 auto& 
y£g
: 
y
->
loÿl_£gs_sšk
èy£g.
	`po¡´oûss
();

293 
	}
}

296 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

297 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

298 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹_1d_cŞ_nÚ_İt
(
ušt32_t
 
max_™”s
)

300 
	`»£t_aùiv™y
();

303 
ušt32_t
 
™”
 = 0;

304 
boŞ
 
uÁ_cÚv”g’û
 = 
max_™”s
 =ğ
UNTIL_CONVERGENCE
;

305 
boŞ
 
has_cÚv”ged
 = 
çl£
;

306 
MPI_Reque¡
 
cÚv”g’û_»q
 = 
MPI_REQUEST_NULL
;

308 
uÁ_cÚv”g’û
 ? 
nÙ
 
has_cÚv”ged
 : 
™”
 < 
max_™”s
)

310 
Di¡Tim”
 
	`™_tim”
("I‹¿tiÚ " + 
¡d
::
	`to_¡ršg
(
™”
 + 1));

314 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`g©h”
();

315 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`g©h”
();

317 
´oûss_mes§ges
<
çl£
, 
P¬t™iÚšg
::
_1D_COL
, 
mœrÜšg
>(
™”
);

318 
´oûss_mes§ges
<
Œue
, 
P¬t™iÚšg
::
_1D_COL
, 
mœrÜšg
>(
™”
);

320 
has_cÚv”ged
 = 
nÙ
 
´oduû_mes§ges
<
çl£
, f®£>(
™”
);

321 
has_cÚv”ged
 &ğ
nÙ
 
´oduû_mes§ges
<
Œue
, 
çl£
>(
™”
);

323 ià(
uÁ_cÚv”g’û
)

324 
has_cÚv”ged
 = 
	`has_cÚv”ged_glob®ly
(has_cÚv”ged, 
cÚv”g’û_»q
);

326 
™_tim”
.
	`¡İ
();

328 
™”
++;

332 
Di¡Tim”
 
	`fš®_wa™_tim”
("Final Wait");

333 ià(
g©h”_d•’ds_Ú_¡©e
)

334 auto& 
v£g
: 
v
->
own_£gs
èv£g.
	`po¡´oûss
();

335 
fš®_wa™_tim”
.
	`¡İ
();

338 auto& 
y£g
: 
y
->
loÿl_£gs
èy£g.
	`po¡´oûss
();

339 auto& 
y£g
: 
y
->
loÿl_£gs_sšk
èy£g.
	`po¡´oûss
();

340 
	}
}

343 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

344 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

345 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹_sšgË_2d
()

348 
	`sÿ‰”_sourû_mes§ges
();

349 
	`»£t_aùiv™y
();

353 
Di¡Tim”
 
	`™_tim”
("Iteration 1");

357 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`g©h”
();

358 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`g©h”
();

360 
´oûss_mes§ges
<
çl£
, 
P¬t™iÚšg
::
_2D
, 
mœrÜšg
>();

361 
´oûss_mes§ges
<
Œue
, 
P¬t™iÚšg
::
_2D
, 
mœrÜšg
>();

363 
´oduû_mes§ges
<
çl£
, 
Œue
>();

364 
´oduû_mes§ges
<
Œue
,rue>();

366 
™_tim”
.
	`¡İ
();

369 
Di¡Tim”
 
	`fš®_wa™_tim”
("Final Wait");

372 dØ{ 
x
->
	`wa™_fÜ_some
(); }

373 
nÙ
 
x
->
	`no_mÜe_£gs_th’_ş—r
());

375 auto& 
x£g
: 
x
->
outgošg
.
»guÏr
èx£g.
	`po¡´oûss
();

377 ià(
g©h”_d•’ds_Ú_¡©e
)

379 auto& 
v£g
: 
v
->
own_£gs
èv£g.
	`po¡´oûss
();

380 auto& 
v£g
: 
v
->
own_£gs
èv£g.
‹m¶©e
 
po¡´oûss
<
Œue
>();

383 
fš®_wa™_tim”
.
	`¡İ
();

387 auto& 
y£g
: 
y
->
loÿl_£gs
èy£g.
	`po¡´oûss
();

388 auto& 
y£g
: 
y
->
loÿl_£gs_sšk
èy£g.
	`po¡´oûss
();

389 
	}
}

392 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

393 
	g‹m¶©e
 <
boŞ
 
	gmœrÜšg
>

394 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$execu‹_sšgË_1d_cŞ
()

396 
	`»£t_aùiv™y
();

399 
Di¡Tim”
 
	`™_tim”
("Iteration 1");

403 auto& 
y£g
 : 
y
->
own_£gs
èy£g.
	`g©h”
();

404 auto& 
y£g
 : 
y
->
own_£gs_sšk
èy£g.
	`g©h”
();

405 
´oûss_mes§ges
<
çl£
, 
P¬t™iÚšg
::
_1D_COL
, 
mœrÜšg
>();

406 
´oûss_mes§ges
<
Œue
, 
P¬t™iÚšg
::
_1D_COL
, 
mœrÜšg
>();

407 
´oduû_mes§ges
<
çl£
, 
Œue
>();

408 
´oduû_mes§ges
<
Œue
,rue>();

410 
™_tim”
.
	`¡İ
();

413 
Di¡Tim”
 
	`fš®_wa™_tim”
("Final Wait");

415 ià(
g©h”_d•’ds_Ú_¡©e
)

417 auto& 
v£g
: 
v
->
own_£gs
èv£g.
	`po¡´oûss
();

418 auto& 
v£g
: 
v
->
own_£gs
èv£g.
‹m¶©e
 
po¡´oûss
<
Œue
>();

420 
fš®_wa™_tim”
.
	`¡İ
();

424 auto& 
y£g
: 
y
->
loÿl_£gs
èy£g.
	`po¡´oûss
();

425 auto& 
y£g
: 
y
->
loÿl_£gs_sšk
èy£g.
	`po¡´oûss
();

426 
	}
}

429 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

430 
boŞ
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$has_cÚv”ged_glob®ly
(

431 
boŞ
 
has_cÚv”ged_loÿÎy
, 
MPI_Reque¡
& 
cÚv”g’û_»q
)

433 
boŞ
 
has_cÚv”ged_glob®ly
 = 
çl£
;

436 ià(
cÚv”g’û_»q
 !ğ
MPI_REQUEST_NULL
)

437 
	`MPI_Wa™
(&
cÚv”g’û_»q
, 
MPI_STATUS_IGNORE
);

440 
	`MPI_I®Ìeduû
(&
has_cÚv”ged_loÿÎy
, &
has_cÚv”ged_glob®ly
, 1, 
MPI_CHAR
,

441 
MPI_LAND
, 
Env
::
MPI_WORLD
, &
cÚv”g’û_»q
);

444 ià(
has_cÚv”ged_loÿÎy
)

445 
	`MPI_Wa™
(&
cÚv”g’û_»q
, 
MPI_STATUS_IGNORE
);

447  
has_cÚv”ged_glob®ly
;

448 
	}
}

451 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

452 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$sÿ‰”_sourû_mes§ges
()

455 
Di¡Tim”
 
	`sÿ‰”_tim”
("Scattering Initial Messages");

457 
x
->
	`wa™_fÜ_sourûs
();

459 
sÿ‰”_tim”
.
	`¡İ
();

460 
	}
}

463 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

464 
	g‹m¶©e
 <
boŞ
 
	gsšk
, 
P¬t™iÚšg
 
	g·¹™iÚšg
, boŞ 
	gmœrÜšg
>

465 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$´oûss_mes§ges
(
ušt32_t
 
™”
)

467 
Di¡Tim”
 
	`´oûss_tim”
("Processing Messages");

473 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_ROW
)

475 
	`as£¹
(
çl£
);

477 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_COL
)

480 
¡d
::
veùÜ
<> 
	`»ady
(1);

481 
´oûss_»ady_mes§ges
<
sšk
, 
·¹™iÚšg
, 
mœrÜšg
>(
»ady
, 
™”
);

483 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_2D
)

485 
¡d
::
veùÜ
<>* 
»ady
;

486 dØ{ 
»ady
 = 
x
->
	`wa™_fÜ_some
(); }

487 
nÙ
 
´oûss_»ady_mes§ges
<
sšk
, 
·¹™iÚšg
, 
mœrÜšg
>(*
»ady
, 
™”
));

490 
´oûss_tim”
.
	`¡İ
();

491 
	}
}

495 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

496 
	g‹m¶©e
 <
boŞ
 
	gsourû
, 
P¬t™iÚšg
 
	g·¹™iÚšg
>

497 
	gSŒ—mšgA¼ay
<
	gM
>& 
	gV”‹xProg¿m
<
	gW
, M, 
	gA
, 
	gS
>::
	$»ûive_jth_x£g
(
ušt32_t
 
jth
)

499 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_ROW
)

501 
	`as£¹
(
çl£
);

503 ià(
·¹™iÚšg
 =ğ
P¬t™iÚšg
::
_1D_COL
)

506 
	`as£¹
(
jth
 == 0);

507  
sourû
 ? 
x
->
outgošg
.sourû[
jth
] : x->outgošg.
»guÏr
[jth];

511 
	`as£¹
(
jth
 < 
x
->
šcomšg
.
»guÏr
.
	`size
());

512 auto& 
x£g
 = 
sourû
 ? 
x
->
šcomšg
.sourû[
jth
] : x->šcomšg.
»guÏr
[jth];

517 ià(
nÙ
 
sourû
 
ªd
‚Ù 
x
->
blobs
.
	`em±y
())

519 
x£g
.
	`ş—r
();

520 
x
->
	`œecv_po¡´oûss
(
jth
);

523  
x£g
;

525 
	}
}

531 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

532 
	g‹m¶©e
 <
boŞ
 
	gsšk
, 
P¬t™iÚšg
 
	g·¹™iÚšg
, boŞ 
	gmœrÜšg
>

533 
boŞ
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
´oûss_»ady_mes§ges
(

534 cÚ¡ 
¡d
::
veùÜ
<
št32_t
>& 
»ady
, 
ušt32_t
 
™”
)

538 auto& 
	gy£gs
 = 
sšk
 ? 
y
->
loÿl_£gs_sšk
 : y->
loÿl_£gs
;

542 autØ
	gjth
 : 
»ady
)

544 
SŒ—mšgA¼ay
<
M
>& 
x£g
 = 
»ûive_jth_x£g
<
çl£
, 
	g·¹™iÚšg
>(
	gjth
);

545 
	gSŒ—mšgA¼ay
<
	gM
>& 
	gx£g_
 = 
»ûive_jth_x£g
<
Œue
, 
	g·¹™iÚšg
>(
	gjth
);

547 auto& 
	gcŞg½
 = 
G
->
g‘_m©rix
()->
loÿl_cŞg½s
[
jth
];

549 #´agm¨
omp
 
·¿Î–
 
scheduË
(
dyÇmic
)

550 autØ
	gi
 = 0; i < 
	gy£gs
.
size
(); i++)

553 
	gSŒ—mšgA¼ay
<
	gM
> 
x£g_ü_
(
x£g_
);

554 
	gSŒ—mšgA¼ay
<
	gM
> 
x£g_ü
(
x£g
);

556 auto& 
	gy£g
 = 
y£gs
[
i
];

558 
	gV”‹xMœrÜSegm’t
<
	gM©rix
, 
	gV”‹xA¼ay
>* 
	gv£g
 = 
nuÎ±r
;

559 ià(
	gmœrÜšg
)

561 
	gv£g
 = 
sšk
 ? &(
v
->
mœ_£gs_¢k
->
£gs
[
y£g
.
™h
]è: &(v->
mœ_£gs_»g
->segs[yseg.ith]);

563 
	gv
->
‹m¶©e
 
	gwa™_fÜ_™h
<
	gsšk
>(
	gy£g
.
	g™h
);

567 ià(
	gsšk
)

570 
	gSpMV
<
	gmœrÜšg
>(*
	gcŞg½
.
	gloÿl_tes
[
y£g
.
™h
]->
	gsšk_csc
, 
	gx£g_ü_
, 
	gy£g
, 
	gv£g
, 
	gx£g
.
size
());

572 
	gSpMV
<
	gmœrÜšg
>(*
	gcŞg½
.
	gloÿl_tes
[
y£g
.
™h
]->
	gsšk_csc
, 
	gx£g_ü
, 
	gy£g
, 
	gv£g
, 0);

580 ià(
¡©iÚ¬y
 
Ü
 
	g™”
 == 0)

581 
SpMV
<
mœrÜšg
>(*
cŞg½
.
loÿl_tes
[
y£g
.
™h
]->
csc
, 
	gx£g_ü_
, 
	gy£g
, 
	gv£g
, 
	gx£g
.
size
());

583 
	gSpMV
<
	gmœrÜšg
>(*
	gcŞg½
.
	gloÿl_tes
[
y£g
.
™h
]->
	gcsc
, 
	gx£g_ü
, 
	gy£g
, 
	gv£g
, 0);

586 
	gy£g
.
	gncombšed
++;

588 ià(
	gx
->
no_mÜe_£gs
(è&& 
	gy£g
.
»ady
()èy£g.
£nd
();

592  
	gx
->
no_mÜe_£gs_th’_ş—r
();

596 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

597 
	g‹m¶©e
 <
boŞ
 
	gg©h”_w™h_¡©e
>

598 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
SpMV
(

599 cÚ¡ 
CSC
<
W
>& 
csc
,

600 
SŒ—mšgA¼ay
<
M
>& 
x£g
,

601 
RªdomAcûssA¼ay
<
A
>& 
y£g
,

602 
RªdomAcûssA¼ay
<
S
>* 
v£g
,

603 
ušt32_t
 
sšk_off£t
 )

605 
ušt32_t
 
	gi
;

606 
M
 
	gmsg
;

608 
	gx£g
.
»wšd
();

610 
	gx£g
.
Ãxt
(
i
, 
msg
))

612 
as£¹
(
i
 < 
x£g
.
size
());

614 
ušt32_t
 
	gj
 = 
csc
.
cŞ±rs
[
sšk_off£t
 + 
i
]; j < 
	gcsc
.
	gcŞ±rs
[sink_offset + i + 1]; j++)

616 
as£¹
(
j
 < 
csc
.
ÃÁr›s
);

618 auto& 
	g’Œy
 = 
csc
.
’Œ›s
[
j
];

620 ià(
	gg©h”_w™h_¡©e
)

621 
combše
(
g©h”
(
Edge
<
W
>(
csc
.
cŞidxs
[
sšk_off£t
 + 
i
], 
’Œy
.
idx
,ƒÁry.
edge_±r
()), 
msg
,

622 (*
v£g
)[
’Œy
.
glob®_idx
]),

623 
y£g
[
’Œy
.
glob®_idx
]);

625 
combše
(
g©h”
(
Edge
<
W
>(
csc
.
cŞidxs
[
sšk_off£t
 + 
i
], 
’Œy
.
idx
,ƒÁry.
edge_±r
()), 
msg
),

626 
y£g
[
’Œy
.
glob®_idx
]);

628 
	gy£g
.
	gaùiv™y
->
touch
(
’Œy
.
glob®_idx
);

638 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

639 
	g‹m¶©e
 <
boŞ
 
	gsšk
, boŞ 
	gsšgË_™”
>

640 
boŞ
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
	$´oduû_mes§ges
(
ušt32_t
 
™”
)

642 
boŞ
 
ªy_aùiv©ed
 = 
çl£
;

644 
Di¡Tim”
 
	`´oduû_tim”
("Producing Messages");

647 
boŞ
 
dÚe
 = 
çl£
;

649 
nÙ
 
dÚe
)

651 
dÚe
 = 
Œue
;

653 auto& 
fš®_y£g
 : 
sšk
 ? 
y
->
own_£gs_sšk
 : y->
own_£gs
)

655 autØ
»ady
 = 
fš®_y£g
.
	`wa™_fÜ_some
();

657 autØ
jth
 : 
»ady
)

659 auto& 
·¹Ÿl
 = (*(
fš®_y£g
.
·¹Ÿls
))[
jth
];

661 
fš®_y£g
.
	`œecv_po¡´oûss
(
jth
);

663 
	`combše_accumuÏtÜs
(
·¹Ÿl
, 
fš®_y£g
);

666 ià(
fš®_y£g
.
	`no_mÜe_£gs
())

668 ià(
­¶y_d•’ds_Ú_™”
)

669 
ªy_aùiv©ed
 = 
­¶y_ªd_sÿ‰”_mes§ges
<
sšk
, 
Œue
, 
sšgË_™”
>(
fš®_y£g
, 
™”
);

671 
ªy_aùiv©ed
 = 
­¶y_ªd_sÿ‰”_mes§ges
<
sšk
, 
çl£
, 
sšgË_™”
>(
fš®_y£g
, 
™”
);

674 
dÚe
 = 
çl£
;

678 
´oduû_tim”
.
	`¡İ
();

680  
ªy_aùiv©ed
;

681 
	}
}

684 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

685 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
combše_accumuÏtÜs
(

686 
AccumA¼ay
& 
·¹Ÿl_y£g
, 
AccumFš®Segm’t
<
M©rix
, AccumA¼ay>& 
fš®_y£g
)

688 
	g·¹Ÿl_y£g
.
»wšd
();

690 
ušt32_t
 
	gidx
;

691 
A
 
	gyv®
;

693 
	g·¹Ÿl_y£g
.
pİ
(
idx
, 
yv®
))

695 
combše
(
yv®
, 
fš®_y£g
[
idx
]);

696 
	gfš®_y£g
.
	gaùiv™y
->
touch
(
idx
);

701 
	g‹m¶©e
 <
şass
 
	gW
, cÏs 
	gM
, cÏs 
	gA
, cÏs 
	gS
>

702 
	g‹m¶©e
 <
boŞ
 
	gsšk
, boŞ 
	g­¶y_w™h_™”
, boŞ 
	gsšgË_™”
>

703 
boŞ
 
	gV”‹xProg¿m
<
	gW
, 
	gM
, 
	gA
, 
	gS
>::
­¶y_ªd_sÿ‰”_mes§ges
(

704 
AccumFš®Segm’t
<
M©rix
, 
AccumA¼ay
>& 
fš®_y£g
, 
ušt32_t
 
™”
)

706 
boŞ
 
	gªy_aùiv©ed
 = 
çl£
;

708 auto& 
	gv£g
 = 
v
->
own_£gs
[
fš®_y£g
.
kth
];

710 auto& 
	gx£g
 = 
x
->
outgošg
.
»guÏr
[
fš®_y£g
.
kth
];

712 
	gx£g
.
ş—r
();

714 
	gfš®_y£g
.
»wšd
();

716 ià(
	gsšk
)

718 
ušt32_t
 
	gsšk_off£t
 = 
fš®_y£g
.
sšk_off£t
;

720 
ušt32_t
 
	gidx
;

721 
A
 
	gyv®
;

723 
	gfš®_y£g
.
pİ
(
idx
, 
yv®
))

725 
boŞ
 
	ggÙ_aùiv©ed
 = 
­¶y_w™h_™”
 ? 
­¶y
(
yv®
, 
v£g
[
sšk_off£t
 + 
idx
], 
™”
)

726 : 
­¶y
(
yv®
, 
v£g
[
sšk_off£t
 + 
idx
]);

727 ià(
	ggÙ_aùiv©ed
)

728 
	gv£g
.
	gaùiv™y
->
push
(
sšk_off£t
 + 
idx
);

734 
ušt32_t
 
	gidx
;

735 
A
 
	gyv®
;

737 
	gfš®_y£g
.
pİ
(
idx
, 
yv®
))

739 
boŞ
 
	ggÙ_aùiv©ed
 = 
­¶y_w™h_™”
 ? 
­¶y
(
yv®
, 
v£g
[
idx
], 
™”
)

740 : 
­¶y
(
yv®
, 
v£g
[
idx
]);

741 
	gªy_aùiv©ed
 |ğ
gÙ_aùiv©ed
;

743 ià(
gÙ_aùiv©ed
 
Ü
 
	g¡©iÚ¬y
)

745 
	gv£g
.
	gaùiv™y
->
push
(
idx
);

746 ià(
nÙ
 
	gsšgË_™”
)

747 
	gx£g
.
push
(
idx
, 
sÿ‰”
(
v£g
[idx]));

751 ià(
	gG
->
g‘_·¹™iÚšg
(è=ğ
P¬t™iÚšg
::
_2D
 
ªd
 
nÙ
 
sšgË_™”
)

752 
x£g
.
bÿ¡
();

755  
	gªy_aùiv©ed
;

	@
1
.
1
/usr/include
75
2189
dev/proc2tile.cpp
src/apps/graph_analytics/bfs.cpp
src/apps/graph_analytics/bfs.h
src/apps/graph_analytics/cc.cpp
src/apps/graph_analytics/cc.h
src/apps/graph_analytics/degree.cpp
src/apps/graph_analytics/degree.h
src/apps/graph_analytics/pr.cpp
src/apps/graph_analytics/pr.h
src/apps/graph_analytics/sssp.cpp
src/apps/graph_analytics/sssp.h
src/apps/graph_analytics/tc.cpp
src/apps/graph_analytics/tc.h
src/apps/graph_simulation/graphsim.cpp
src/apps/graph_simulation/graphsim.h
src/apps/graph_simulation/graphsim_query.h
src/apps/information_retrieval/tfidf.cpp
src/apps/information_retrieval/tfidf.h
src/apps/information_retrieval/tfidf_batch.cpp
src/apps/information_retrieval/tfidf_batch.h
src/matrix/annotated_matrix2d.h
src/matrix/annotated_matrix2d.hpp
src/matrix/csc_matrix2d.h
src/matrix/csc_matrix2d.hpp
src/matrix/dist_matrix2d.h
src/matrix/dist_matrix2d.hpp
src/matrix/graph.h
src/matrix/graph.hpp
src/matrix/hashers.h
src/matrix/matrix2d.h
src/matrix/matrix2d.hpp
src/matrix/processed_matrix2d.h
src/matrix/processed_matrix2d.hpp
src/matrix/processed_matrix2d_details.hpp
src/structures/bitvector.h
src/structures/bitvector.hpp
src/structures/communicable.h
src/structures/fixed_vector.h
src/structures/random_access_array.h
src/structures/random_access_array.hpp
src/structures/serializable_bitvector.h
src/structures/serializable_bitvector.hpp
src/structures/static_bitvector.h
src/structures/streaming_array.h
src/structures/streaming_array.hpp
src/tools/cw2bin.cpp
src/tools/mtx2bin.cpp
src/utils/colgrp.h
src/utils/common.h
src/utils/csc.h
src/utils/dashboard.h
src/utils/dist_timer.cpp
src/utils/dist_timer.h
src/utils/enum.h
src/utils/env.cpp
src/utils/env.h
src/utils/locator.h
src/utils/log.cpp
src/utils/log.h
src/utils/log.hpp
src/utils/rowgrp.h
src/utils/tile.h
src/vector/accum_final_segment.h
src/vector/accum_partial_segment.h
src/vector/accum_vector.h
src/vector/msg_input_segment.h
src/vector/msg_output_segment.h
src/vector/msg_vector.h
src/vector/vertex_master_segment.h
src/vector/vertex_mirror_segment.h
src/vector/vertex_vector.h
src/vprogram/types.h
src/vprogram/vertex_program.h
src/vprogram/vertex_program.hpp
src/vprogram/vertex_program_execute.hpp
